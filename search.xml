<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CSS常用特效</title>
    <url>/CSS/CSS%E5%B8%B8%E7%94%A8%E7%89%B9%E6%95%88/</url>
    <content><![CDATA[<h2 id="卡片效果"><a href="#卡片效果" class="headerlink" title="卡片效果"></a>卡片效果</h2><h3 id="悬浮效果"><a href="#悬浮效果" class="headerlink" title="悬浮效果"></a>悬浮效果</h3><ul>
<li><p>谷歌卡片</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20210119161631244.png" alt="image-20210119161631244"></p>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.block-anchor</span><span class="selector-attr">[_ngcontent-iki-c34]</span><span class="selector-pseudo">:hover</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(60, 64, 67, 0.3), <span class="number">0px</span> <span class="number">2px</span> <span class="number">6px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(60, 64, 67, 0.15);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-1px);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ul>
<li><p>vue3官网</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20210119161200747.png" alt="image-20210119161200747"></p>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.sub</span> <span class="selector-class">.cover</span><span class="selector-attr">[data-v-05f0c8b5]</span><span class="selector-pseudo">:hover</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">18px</span> <span class="number">32px</span> -<span class="number">18px</span> <span class="number">#000</span><span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-3px);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS</tag>
        <tag>sass</tag>
        <tag>scss</tag>
        <tag>less</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS里的pointer-events属性</title>
    <url>/css/CSS%E9%87%8C%E7%9A%84pointer-events%E5%B1%9E%E6%80%A7/</url>
    <content><![CDATA[<h2 id="因为pointer-events出现的问题"><a href="#因为pointer-events出现的问题" class="headerlink" title="因为pointer-events出现的问题"></a>因为pointer-events出现的问题</h2><p>在Vuetify项目中，因为在input中使用了tooltip ，意愿是文字溢出隐藏显示… , </p>
<p>但input在disabled的状态内部文字的tooptip居然不显示了</p>
<p>在控制台发现了这个样式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.v-input--is-disabled</span><span class="selector-pseudo">:not(.v-input--is-readonly)</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">pointer-events</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p> pointer-events: none; 这个很不常用， 下面看下这个属性具体是干什么的   <a href="https://www.webhek.com/post/pointer-events.html" target="_blank" rel="noopener">原文</a></p>
<h2 id="pointer-events"><a href="#pointer-events" class="headerlink" title="pointer-events"></a>pointer-events</h2><p>现代浏览器里CSS的职责范围和JavaScript的越来越模糊分不清。比如CSS里<code>-webkit-touch-callout</code>属性在iOS里能禁止当用户点击时弹出气泡框。而本文要说的<code>pointer-events</code>的风格更像JavaScript，它能够：</p>
<ul>
<li>阻止用户的点击动作产生任何效果</li>
<li>阻止缺省鼠标指针的显示</li>
<li>阻止CSS里的<code>hover</code>和<code>active</code>状态的变化触发事件</li>
<li>阻止JavaScript点击动作触发的事件</li>
</ul>
<p>一个CSS属性能做所有的这么多事情！</p>
<h3 id="The-CSS"><a href="#The-CSS" class="headerlink" title="The CSS"></a>The CSS</h3><p>这个<code>pointer-events</code>属性有很多可以使用的属性值，但大部分都是针对SVG的：<code>auto</code>, <code>none</code>, <code>visiblePainted*</code>, <code>visibleFill*</code>, <code>visibleStroke*</code>, <code>visible*</code>, <code>painted*</code>, <code>fill*</code>, <code>stroke*</code>, <code>all*</code>, 以及 <code>inherit</code>。其中<code>none</code>值能阻止点击、状态变化和鼠标指针变化：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.disabled</span> &#123; <span class="attribute">pointer-events</span>: none; &#125;</span></pre></td></tr></table></figure>

<p>一些需要注意的关于<code>pointer-events</code>的事项：</p>
<ul>
<li>子元素可以声明<code>pointer-events</code>来解禁父元素的阻止鼠标事件限制。</li>
<li>如果你对一个元素设置了click事件监听器，然后你移除了<code>pointer-events</code>样式声明，或把它的值改变为<code>auto</code>，监听器会重新生效。基本上，监听器会遵守<code>pointer-events</code>的设定。</li>
</ul>
<h2 id="处理问题"><a href="#处理问题" class="headerlink" title="处理问题"></a>处理问题</h2><p>为了只让tooltip显示，而input的本身的禁用还在，可以直接在tooltip中的显示文字上添加 pointer-events: auto; 即可    </p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 内容部分</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.tooltip-default-text</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">pointer-events</span>: auto;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>Vuetify</tag>
      </tags>
  </entry>
  <entry>
    <title>Data URI详细介绍</title>
    <url>/HTML/Data-URI%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D/</url>
    <content><![CDATA[<p>最近学习webpack遇到了Data URI 这种格式，觉得很有趣稍微学习一下，转载一篇别人写的比较好的文章；</p>
<p>原文地址：<a href="https://blog.csdn.net/qq_38128179/article/details/100663085" target="_blank" rel="noopener">https://blog.csdn.net/qq_38128179/article/details/100663085</a></p>
<h2 id="一、URI介绍"><a href="#一、URI介绍" class="headerlink" title="一、URI介绍"></a>一、URI介绍</h2><p>URI（统一资源标识符） 是 uniform resource identifier的缩写，它定义了接受内容的协议以及附带的相关内容，如果附带的相关内容是一个地址，那么此时的 URI 也是一个 URL （uniform resource locator<code></code>)。</p>
<h2 id="二、什么是-data-URI-scheme？"><a href="#二、什么是-data-URI-scheme？" class="headerlink" title="二、什么是 data URI scheme？"></a>二、什么是 data URI scheme？</h2><p>Data URI scheme 简称 Data URI，经常会被<strong>错误</strong>地写成 data URLs。即前缀为data：协议的的URL，其允许内容创建者向文档中嵌入小文件。</p>
<blockquote>
<p>假设我们有一个图片需要显示在网页上</p>
<p>1、通常我们会使用http链接，这种取得资料的方法称为 <strong>http URI scheme</strong>：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">// 从外部请求一张图片</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://pic1.win4000.com/wallpaper/c/53cdd1f7c1f21.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span></pre></td></tr></table></figure>

<p> 2、使用 <strong>data URI scheme</strong> 获取资料可以写成：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">// 在HTML中嵌入一个小红点的图片</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span></pre></td></tr></table></figure>

<p>通过data RUI scheme，我们把图像内容内置在HTML 中，节省了一个 HTTP 请求。</p>
</blockquote>
<h2 id="三、Data-URI-scheme-的语法"><a href="#三、Data-URI-scheme-的语法" class="headerlink" title="三、Data URI scheme 的语法"></a>三、<strong>Data URI scheme 的语法</strong></h2><blockquote>
<p> <strong>data:①[<mime type>]②[;charset=<charset>]③[;<encoding>]④,<encoded data>⑤</encoded></encoding></charset></mime></strong></p>
</blockquote>
<p><strong>【1】第①部分data：</strong> 协议头，它标识这个内容为一个 data URI 资源。</p>
<p><strong>【2】第②部分MIME 类型（可选项）：</strong>浏览器通常使用MIME类型（而不是文件扩展名）来确定如何处理文档；因此服务器设置正确以将正确的MIME类型附加到响应对象的头部是非常重要的。MIME类型对大小写不敏感，但是传统写法都是小写。</p>
<table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>描述</strong></th>
<th><strong>示例（语法：type/subtype 类型/子类型**</strong>）**</th>
</tr>
</thead>
<tbody><tr>
<td>text</td>
<td>表明文件是普通文件，理论上是人类可读的</td>
<td><strong>text/plain，text/html，text/css，text/javascript</strong></td>
</tr>
<tr>
<td>image</td>
<td>表明文件某种是图像文件，gif动态图也属于image类型</td>
<td><strong>image/gif，image/png，image/jpeg，image/bmp，image/webp，image/x-icon，image/vnd.microsoft.icon</strong></td>
</tr>
<tr>
<td>audio</td>
<td>表明文件是某种音频文件</td>
<td><strong>audio/midi，audio/mpeg，audio/webm，audio/ogg，audio/wav</strong></td>
</tr>
<tr>
<td>video</td>
<td>表明文件是某种视频文件</td>
<td><strong>video/webm，video/ogg</strong></td>
</tr>
<tr>
<td>application</td>
<td>表明文件是某种二进制数据</td>
<td><strong>application/octet-stream，application/pkcs12，application/vnd.mspowerpoint，application/xhtml+xml，application/xml，application/pdf</strong></td>
</tr>
</tbody></table>
<p><strong>【3】第③部分 <a href="可选项">;charset=<charset></charset></a>：</strong> 源文本的字符集编码方式，默认编码是 charset=US-ASCII, 即数据部分的每个字符都会自动编码为 %xx</p>
<p><strong>【4】第④部分 [;<encoding>] ：</encoding></strong> 数据编码方式（默认US-ASCII，BASE64两种）</p>
<p><strong>【5】第⑤部分 ,<encoded data></encoded></strong> <strong>：</strong> 编码后的数据</p>
<blockquote>
<p>关于base64 可以参考阮一峰写的文章：<a href="http://www.ruanyifeng.com/blog/2008/06/base64.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2008/06/base64.html</a></p>
</blockquote>
<h2 id="四、Data-URI-scheme-的利弊"><a href="#四、Data-URI-scheme-的利弊" class="headerlink" title="四、Data URI scheme 的利弊"></a>四、<strong>Data URI scheme 的利弊</strong></h2><blockquote>
<p><strong>利：</strong></p>
<ul>
<li>减少 HTTP 请求</li>
<li>当访问外部资源很麻烦或受限时（比如服务器 ip 被墙）</li>
<li>当图片是在服务器端用程序动态生成，每个访问用户显示的都不同时</li>
<li>当图片的体积太小，占用一个 HTTP 会话不值得时</li>
<li>没有图片更新要重新上传，还要清理缓存的问题</li>
</ul>
<p><strong>弊：</strong></p>
<ul>
<li>Base64 编码的数据体积通常是原数据的体积 4/3，也就是 Data URL 形式的图片会比二进制格式的图片体积大 1/3</li>
<li>Data URL 形式的图片不会被浏览器缓存，这意味着每次访问页面时都被下载一次。</li>
<li>增加了 CSS 文件的尺寸</li>
<li>IE678兼容性</li>
<li>不适合 lazy loading</li>
<li>不利于维护</li>
<li>移动端不宜使用 Data URI 技术（解码耗 CPU）</li>
</ul>
</blockquote>
<h2 id="五、Data-URI-scheme-的应用实例"><a href="#五、Data-URI-scheme-的应用实例" class="headerlink" title="五、Data URI scheme 的应用实例"></a>五、<strong>Data URI scheme 的应用实例</strong></h2><p><strong>【1】在Html的Img对象中使用</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAF..."</span> /&gt;</span></span></pre></td></tr></table></figure>

<p><strong>【2】在Css的background-image属性中使用</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.image</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">width</span>:<span class="number">100px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">height</span>:<span class="number">100px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">	<span class="attribute">background-image</span>:<span class="built_in">url</span>(data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAF...);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><strong>【3】在Html的css链接处使用</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"data:text/css;base64,LyogKioqKiogVGVtcGxhdGUgKioq..."</span> /&gt;</span></span></pre></td></tr></table></figure>

<p><strong>【4】在Html的javaScript链接处使用</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"data:text/javascript;base64,LyogKioqKiogVGVtcGxhdGUgKioq..."</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr></table></figure>

<p><strong>【5】data RUI scheme也可以直接在浏览器的地址栏中输入进行访问</strong> </p>
<p> <strong>①</strong>在浏览器中输入以下的Url，会得到一个加粗的”Hello, world!”。也就是说，data:后面的数据直接用做网页的内容，而不是网页的地址。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">data:text/html,&lt;html&gt;<span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span></pre></td></tr></table></figure>

<p> <strong>②</strong>下面的例子会显示出 “你好，中文！”。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">data:text/plain;charset=UTF<span class="number">-8</span>;base64,<span class="number">5</span>L2g5aW977yM5Lit5paH77yB</span></pre></td></tr></table></figure>

<h2 id="六、兼容IE678-MHTML"><a href="#六、兼容IE678-MHTML" class="headerlink" title="六、兼容IE678 - MHTML"></a>六、兼容IE678 - MHTML</h2><p> MHTML 即 MIME HTML（Multipurpose Internet Mail Extensions HyperText Markup Language），就是将Data URI以附件的形式附加到页面页面上，具体示例如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** FilePath: http://example.com/test.css */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/*!@ignore</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">Content-Type: multipart/related; boundary="_ANY_SEPARATOR"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">--_ANY_SEPARATOR</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">Content-Location:myidBackground</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">Content-Transfer-Encoding:base64</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">--_ANY_SEPARATOR--</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">*/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.myid</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background-image</span>: 		      <span class="built_in">url</span>(<span class="string">"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  *background-image: url(mhtml:http://example.com/test.css!myidBackground); </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p> 上面注释的部分就是一个附件， 这个附件的内容是一个名为myidBackground的Base64编码图片，然后在class为myid的css中使用。</p>
<p>  注意：1、boundary字段值可自定义；</p>
<p>​       2、附件的末行必须为boundary字段值；</p>
<p>​       3、附件内容不能被压缩工具擦写掉；</p>
<p>​       4、由于高版本的IE在使用IE8兼容模式时能认识*这个css hack符号，但却不支持mhtml，所以会导致背景图片失效。应该采用IE的条件注释更为稳妥。</p>
<h2 id="七、base64转换工具"><a href="#七、base64转换工具" class="headerlink" title="七、base64转换工具"></a>七、base64转换工具</h2><p><a href="http://www.pjhome.net/web/html5/encodeDataUrl.htm" target="_blank" rel="noopener">Encode Data URL </a></p>
<p><a href="http://www.atool9.com/img2base64.php" target="_blank" rel="noopener">aTool在线工具</a></p>
<p><a href="https://duri.me/" target="_blank" rel="noopener">Duri.me</a></p>
<p><a href="https://dataurl.sveinbjorn.org/#dataurlmaker" target="_blank" rel="noopener">DATAURL</a></p>
]]></content>
      <categories>
        <category>HTML</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>css</tag>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux系统安装Nodejs和卸载Nodejs</title>
    <url>/Nodejs/Linux%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85Nodejs/</url>
    <content><![CDATA[<blockquote>
<p>不推荐安装最新的node版本 好多包都没有对应的最新node版本的编译好的包</p>
</blockquote>
<h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><ul>
<li>本机系统：CentOS Linux release 7.5</li>
<li>Node.js：v12.18.1</li>
</ul>
<h2 id="获取Node-js-安装包"><a href="#获取Node-js-安装包" class="headerlink" title="获取Node.js 安装包"></a>获取Node.js 安装包</h2><ul>
<li>Node.js 安装包及源码下载地址为：<a href="https://nodejs.org/en/download/，你可以根据不同平台系统选择你需要的" target="_blank" rel="noopener">https://nodejs.org/en/download/，你可以根据不同平台系统选择你需要的</a> Node.js 安装包，这里选择的是 [LTS] Linux Binaries (x64)。</li>
<li>官方下载地址  <a href="https://nodejs.org/dist/latest-v12.x/" target="_blank" rel="noopener">https://nodejs.org/dist/latest-v12.x/</a></li>
</ul>
<h2 id="Linux-上安装-Node-js"><a href="#Linux-上安装-Node-js" class="headerlink" title="Linux 上安装 Node.js"></a>Linux 上安装 Node.js</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://nodejs.org/dist/v12.18.1/node-v12.18.1-linux-x64.tar.xz    // 下载</span></pre></td></tr><tr><td class="code"><pre><span class="line">tar xf node-v12.18.1-linux-x64.tar.xz                                   // 解压</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> node-v12.18.1-linux-x64                                              // 进入解压目录</span></pre></td></tr></table></figure>

<p>解压文件的 bin 目录底下包含了 node、npm 等命令（npm 全局安装的包），我们可以修改linux系统的环境变量（profile）来设置直接运行命令：</p>
<p><strong>老规矩先备份，养成修改重要文件之前先备份的好习惯。</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp /etc/profile /etc/profile.bak</span></pre></td></tr></table></figure>

<blockquote>
<p>/etc/profile 文件介绍： <a href="https://www.cnblogs.com/xiaoshuxiaoshu/p/4689447.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaoshuxiaoshu/p/4689447.html</a></p>
</blockquote>
<p>然后 vim /etc/profile，在最下面添加 export PATH=$PATH: 后面跟上 node 下 bin 目录的路径</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">export NODE_HOME=/root/node-v12.18.1-linux-x64</span></pre></td></tr><tr><td class="code"><pre><span class="line">export PATH=NODE_HOME/bin:$PATH</span></pre></td></tr></table></figure>

<p>如果profile不可修改 添加可写权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo chmod  a=rw  /etc/profile</span></pre></td></tr></table></figure>

<p>立即生效</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span></pre></td></tr></table></figure>

<p>检查是否生效</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">env</span></pre></td></tr></table></figure>

<p>建立软连接 （报已经存在错误： 先删除目标目录下的文件在操作）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ln -s /root/node-v12.18.1-linux-x64/bin/node /usr/<span class="built_in">local</span>/bin/node</span></pre></td></tr><tr><td class="code"><pre><span class="line">ln -s /root/node-v12.18.1-linux-x64/bin/npm /usr/<span class="built_in">local</span>/bin/npm</span></pre></td></tr></table></figure>

<p>添加sudo  （报已经存在错误： 先删除目标目录下的文件在操作）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ln -s /root/node-v12.18.1-linux-x64/bin/node  /usr/bin/node</span></pre></td></tr><tr><td class="code"><pre><span class="line">sudo ln -s /root/node-v12.18.1-linux-x64/lib/node  /usr/lib/node</span></pre></td></tr><tr><td class="code"><pre><span class="line">sudo ln -s /root/node-v12.18.1-linux-x64/bin/npm  /usr/bin/npm</span></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># node -v</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">v12.18.1</span></pre></td></tr></table></figure>

<p>OK！安装成功！</p>
<h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><p>用上面步骤安装后可以直接删除  node-v12.18.1-linux-x64 文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /root/node-v12.18.1-linux-x64</span></pre></td></tr></table></figure>

<p> 进入 /usr/local/lib 删除所有 node 和 node_modules文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /usr/lib/node  /usr/lib/node_modules</span></pre></td></tr></table></figure>

<p> 进入 /usr/local/include 删除所有 node 和 node_modules 文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /usr/<span class="built_in">local</span>/include/node  /usr/<span class="built_in">local</span>/include/node_modules</span></pre></td></tr></table></figure>

<p> 进入 /usr/local/bin 删除 node 的可执行文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /usr/<span class="built_in">local</span>/bin/node</span></pre></td></tr></table></figure>

<p>接着找到上面建立的软连接 依次删除即可 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf /usr/bin/npm</span></pre></td></tr></table></figure>

<p>卸载完成！</p>
<p>现在如果需要其他版本的node ，就可以按上面的步骤从新安装一个其他版本的node了</p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>RegExp对象和string.replac方法</title>
    <url>/js/RegExp%E5%AF%B9%E8%B1%A1%E5%92%8Cstring-replac%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h2 id="RegExp-对象"><a href="#RegExp-对象" class="headerlink" title="RegExp 对象"></a>RegExp 对象</h2><p>RegExp 对象表示正则表达式，它是对字符串执行模式匹配的强大工具。</p>
<h3 id="创建-RegExp-对象的语法"><a href="#创建-RegExp-对象的语法" class="headerlink" title="创建 RegExp 对象的语法"></a>创建 RegExp 对象的语法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern, attributes);</span></pre></td></tr></table></figure>

<h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>参数 <em>pattern</em> 是一个字符串，指定了正则表达式的模式或其他正则表达式。</p>
<p>参数 <em>attributes</em> 是一个可选的字符串，包含属性 “g”、”i” 和 “m”，分别用于指定全局匹配、区分大小写的匹配和多行匹配。ECMAScript 标准化之前，不支持 m 属性。如果 <em>pattern</em> 是正则表达式，而不是字符串，则必须省略该参数。</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"hello"</span>, <span class="string">"ig"</span>); <span class="comment">//全局匹配不区分大小写的hello字符串</span></span></pre></td></tr></table></figure>

<h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h3><p>一个新的 RegExp 对象，具有指定的模式和标志。如果参数 <em>pattern</em> 是正则表达式而不是字符串，那么 RegExp() 构造函数将用与指定的 RegExp 相同的模式和标志创建一个新的 RegExp 对象。</p>
<p>如果不用 new 运算符，而将 RegExp() 作为函数调用，那么它的行为与用 new 运算符调用时一样，只是当 <em>pattern</em> 是正则表达式时，它只返回 _pattern_，而不再创建一个新的 RegExp 对象。</p>
<h3 id="抛出"><a href="#抛出" class="headerlink" title="抛出"></a>抛出</h3><p>SyntaxError - 如果 <em>pattern</em> 不是合法的正则表达式，或 <em>attributes</em> 含有 “g”、”i” 和 “m” 之外的字符，抛出该异常。</p>
<p>TypeError - 如果 <em>pattern</em> 是 RegExp 对象，但没有省略 <em>attributes</em> 参数，抛出该异常。</p>
<h3 id="支持正则表达式的-String-对象的方法"><a href="#支持正则表达式的-String-对象的方法" class="headerlink" title="支持正则表达式的 String 对象的方法"></a>支持正则表达式的 String 对象的方法</h3><table>
<thead>
<tr>
<th align="center"><a href="https://www.w3school.com.cn/jsref/jsref_search.asp" target="_blank" rel="noopener">search</a></th>
<th align="center">检索与正则表达式相匹配的值。</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://www.w3school.com.cn/jsref/jsref_match.asp" target="_blank" rel="noopener">match</a></td>
<td align="center">找到一个或多个正则表达式的匹配。</td>
</tr>
<tr>
<td align="center"><a href="https://www.w3school.com.cn/jsref/jsref_replace.asp" target="_blank" rel="noopener">replace</a></td>
<td align="center">替换与正则表达式匹配的子串。</td>
</tr>
<tr>
<td align="center"><a href="https://www.w3school.com.cn/jsref/jsref_split.asp" target="_blank" rel="noopener">split</a></td>
<td align="center">把字符串分割为字符串数组。</td>
</tr>
</tbody></table>
<h2 id="String-replace-方法"><a href="#String-replace-方法" class="headerlink" title="String.replace() 方法"></a>String.replace() 方法</h2><h3 id="定义和用法"><a href="#定义和用法" class="headerlink" title="定义和用法"></a>定义和用法</h3><p>replace() 方法用于在字符串中用一些字符替换另一些字符，或替换一个与正则表达式匹配的子串。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">stringObject.replace(regexp / substr, replacement);</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">regexp/substr</td>
<td align="left">必需。规定子字符串或要替换的模式的 RegExp 对象。请注意，如果该值是一个字符串，则将它作为要检索的直接量文本模式，而不是首先被转换为 RegExp 对象。</td>
</tr>
<tr>
<td align="left">replacement</td>
<td align="left">必需。一个字符串值。规定了替换文本或生成替换文本的函数。</td>
</tr>
</tbody></table>
<h3 id="返回值-1"><a href="#返回值-1" class="headerlink" title="返回值"></a>返回值</h3><p>一个新的字符串，是用 <em>replacement</em> 替换了 regexp 的第一次匹配或所有匹配之后得到的。</p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>字符串 stringObject 的 replace() 方法执行的是查找并替换的操作。它将在 stringObject 中查找与 regexp 相匹配的子字符串，然后用 <em>replacement</em> 来替换这些子串。如果 regexp 具有全局标志 g，那么 replace() 方法将替换所有匹配的子串。否则，它只替换第一个匹配子串。</p>
<p><em>replacement</em> 可以是字符串，也可以是函数。如果它是字符串，那么每个匹配都将由字符串替换。但是 replacement 中的 $ 字符具有特定的含义。如下表所示，它说明从模式匹配得到的字符串将用于替换。</p>
<p><strong>注意：</strong>ECMAScript v3 规定，replace() 方法的参数 replacement 可以是函数而不是字符串。在这种情况下，每个匹配都调用该函数，它返回的字符串将作为替换文本使用。该函数的第一个参数是匹配模式的字符串。接下来的参数是与模式中的子表达式匹配的字符串，可以有 0 个或多个这样的参数。接下来的参数是一个整数，声明了匹配在 stringObject 中出现的位置。最后一个参数是 stringObject 本身。</p>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">替换文本</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>$1</code>、 <code>$2</code>、…、$99</td>
<td align="left">与 regexp 中的第 1 到第 99 个子表达式相匹配的文本。</td>
</tr>
<tr>
<td align="left">$&amp;</td>
<td align="left">与 regexp 相匹配的子串。</td>
</tr>
<tr>
<td align="left">$`</td>
<td align="left">位于匹配子串左侧的文本。</td>
</tr>
<tr>
<td align="left">$‘</td>
<td align="left">位于匹配子串右侧的文本。</td>
</tr>
<tr>
<td align="left">$$</td>
<td align="left">直接量符号。</td>
</tr>
</tbody></table>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子 1"></a>例子 1</h4><p>在本例中，我们将使用 “W3School” 替换字符串中的 “Microsoft”：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">var</span> str=<span class="string">"Visit Microsoft!"</span> <span class="built_in">document</span>.write(str.replace(<span class="regexp">/Microsoft/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="string">"W3School"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;<span class="regexp">/script&gt;</span></span></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Visit W3School!</span></pre></td></tr></table></figure>

<h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子 2"></a>例子 2</h4><p>在本例中，我们将执行一次全局替换，每当 “Microsoft” 被找到，它就被替换为 “W3School”：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">var</span> str=<span class="string">"Welcome to Microsoft! "</span> str=str + <span class="string">"We are proud to announce that</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> Microsoft has "</span> str=str + <span class="string">"one of the largest Web Developers sites in the</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"> world."</span> <span class="built_in">document</span>.write(str.replace(<span class="regexp">/Microsoft/g</span>, <span class="string">"W3School"</span>))</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;<span class="regexp">/script&gt;</span></span></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Welcome to W3School! We are proud to announce that W3School</span></pre></td></tr><tr><td class="code"><pre><span class="line">has one <span class="keyword">of</span> the largest Web Developers sites <span class="keyword">in</span> the world.</span></pre></td></tr></table></figure>

<h4 id="例子-3"><a href="#例子-3" class="headerlink" title="例子 3"></a>例子 3</h4><p>您可以使用本例提供的代码来确保匹配字符串大写字符的正确：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">text = <span class="string">"javascript Tutorial"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">text.replace(<span class="regexp">/javascript/i</span>, <span class="string">"JavaScript"</span>);</span></pre></td></tr></table></figure>

<h4 id="例子-4"><a href="#例子-4" class="headerlink" title="例子 4"></a>例子 4</h4><p>在本例中，我们将把 “Doe, John” 转换为 “John Doe” 的形式：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">name = <span class="string">"Doe, John"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">name.replace(<span class="regexp">/(\w+)\s*, \s*(\w+)/</span>, <span class="string">"$2 $1"</span>);</span></pre></td></tr></table></figure>

<h4 id="例子-5"><a href="#例子-5" class="headerlink" title="例子 5"></a>例子 5</h4><p>在本例中，我们将把所有的花引号替换为直引号：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">name = <span class="string">'"a", "b"'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">name.replace(<span class="regexp">/"([^"]*)"/g</span>, <span class="string">"'$1'"</span>);</span></pre></td></tr></table></figure>

<h4 id="例子-6"><a href="#例子-6" class="headerlink" title="例子 6"></a>例子 6</h4><p>在本例中，我们将把字符串中所有单词的首字母都转换为大写：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">name = <span class="string">"aaa bbb ccc"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">uw = name.replace(<span class="regexp">/\b\w+\b/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">word</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> word.substring(<span class="number">0</span>, <span class="number">1</span>).toUpperCase() + word.substring(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu 下几种软件安装的方法</title>
    <url>/Linux/Ubuntu-%E4%B8%8B%E5%87%A0%E7%A7%8D%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h2 id="1、tar-gz软件包的安装"><a href="#1、tar-gz软件包的安装" class="headerlink" title="1、tar.gz软件包的安装"></a><strong>1、tar.gz软件包的安装</strong></h2><p><strong>1）解压tar.gz包</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">tar -zxvf nginx<span class="number">-1.8</span><span class="number">.1</span>.tar.gz -C /home/Desktop  # 将软件包名.tar.gz解压到指定的目录下</span></pre></td></tr></table></figure>

<p><strong>2）进入解压后的文件目录下</strong></p>
<p>   <strong>执行“./configure”命令为编译做好准备；</strong></p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> nginx</span></pre></td></tr><tr><td class="code"><pre><span class="line">sudo <span class="string">./configure</span> <span class="params">--prefix=/opt/nginx</span>  <span class="comment"># 表示安装到/opt目录下</span></span></pre></td></tr></table></figure>

<p><strong>3）执行“make”命令进行软件编译；</strong></p>
<p><strong>4）执行“make install”完成安装；</strong></p>
<p><strong>5）执行“make clean”删除安装时产生的临时文件。</strong></p>
<h2 id="2、-apt-get-安装方法"><a href="#2、-apt-get-安装方法" class="headerlink" title="2、 apt-get 安装方法"></a>2、 apt-get 安装方法</h2><p>ubuntu 默认的软件管理系统是apt。apt有很多国内软件源，推荐使用淘宝。</p>
<p>apt-get 的基本软件安装命令是:</p>
<p><strong>sudo apt-get install 软件名</strong></p>
<h2 id="3、-deb-包的安装方式"><a href="#3、-deb-包的安装方式" class="headerlink" title="3、 deb 包的安装方式"></a><strong>3、 deb 包的安装方式</strong></h2><p>deb 是 debian 系 Linux 的包管理方式，ubuntu 是属于 debian 系的 Linux 发行版，所以默认支持这种软件安装方式。<br>当下载到一个 deb 格式的软件后,在终端输入这个命令就能安装：</p>
<p><strong>sudo dpkg -i \</strong>软件名*<em>.deb*</em></p>
<h2 id="4、二进制编译或者脚本安装方式"><a href="#4、二进制编译或者脚本安装方式" class="headerlink" title="4、二进制编译或者脚本安装方式"></a><strong>4、二进制编译或者脚本安装方式</strong></h2><p>github上一般都会提供二进制源码或者脚本安装方式。<br>这类软件,你会在软件安装目录下发现类似后缀名的文件，如： .sh .py .run 等等,有的甚至连后缀名都没有,直接只有一个 INSTALL 文件。或者是一个其他什么的可执行文件。<br>对于这种软件,可尝试以下几种方式安装：</p>
<p><em>在软件目录下输入: ./软件名*</em> **<br>或者 : sh 软件名.sh<br>或者: python 软件名.py**</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu 解压文件后名称乱码问题</title>
    <url>/Linux/Ubuntu-%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6%E5%90%8E%E5%90%8D%E7%A7%B0%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>由于中文的Windows使用的是GBK编码，而Linux默认使用UTF-8编码的，如果在Windows打包带中文文件的zip包，则这个zip包在Linux下面使用默认的归档管理器打开这个zip包的时候，中文文件名会显示乱码。</p>
<h2 id="解决方法1："><a href="#解决方法1：" class="headerlink" title="解决方法1："></a>解决方法1：</h2><p>使用GBK格式解压</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">unzip -O GBK *.zip</span></pre></td></tr></table></figure>

<h2 id="解决方法2"><a href="#解决方法2" class="headerlink" title="解决方法2:"></a>解决方法2:</h2><p>安装p7zip-rar</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install p7zip-rar</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> LANG=zh_CN.GBK  		<span class="comment"># 临时在控制台修改环境为zh_CN.GBK，然后解压缩即可</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">7za  x  需要解压的文件.zip</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> LANG=zh_CN.utf-8 	<span class="comment"># 用完别忘了改回来</span></span></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue的使用注意事项</title>
    <url>/vue/Vue%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
    <content><![CDATA[<blockquote>
<p>这篇文章是我在工作中使用vue遇到的问题做的简单汇总，希望能对看到这篇文章的你有所帮助</p>
</blockquote>
<h2 id="vue中给数组中的对象-添加使vue监听的属性"><a href="#vue中给数组中的对象-添加使vue监听的属性" class="headerlink" title="vue中给数组中的对象,添加使vue监听的属性"></a>vue中给数组中的对象,添加使vue监听的属性</h2><p>不能使用直接遍历设置的方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.arr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  item.showEditBtn = <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>

<p>要使用$set的方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.arr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.$<span class="keyword">set</span>(item, 'showEditBtn', true)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>

<p>或者使用  splice+  <strong><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noopener">Object.assign()</a></strong> 方法  </p>
<blockquote>
<p>注意点：目标对象要使用一个新的空对象 ，将目标和原对象一起混入到新的对象中，这样新 property才会触发更新</p>
<p>同时：数组要触发状态更新，不使用set的情况下要使用splice方法触发数组的更新</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.arr.forEach(<span class="function">(<span class="params">item , index</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> splice(index, <span class="number">1</span>, <span class="built_in">Object</span>.assign(&#123;&#125;, data, keyValue));</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//或者</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    tableData.splice(index, <span class="number">1</span>, &#123; ...data, ...keyValue &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//注意</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//直接使用data= Object.assign(&#123;&#125;, data, keyValue)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//会使数据在栈中引用的地址发生改变</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//但是使数组中的引用地址还是原来的地址</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//会导致数组不会发生任何改变 只是data这个变量的地址引用发生了改变</span></span></pre></td></tr></table></figure>

<p>参考文档：<a href="https://cn.vuejs.org/v2/guide/reactivity.html#对于对象" target="_blank" rel="noopener">对于对象</a> <a href="https://cn.vuejs.org/v2/guide/reactivity.html#对于数组" target="_blank" rel="noopener">对于数组</a></p>
<h2 id="v-if-使用时注意-vue会将一样的元素复用-需要加key解决"><a href="#v-if-使用时注意-vue会将一样的元素复用-需要加key解决" class="headerlink" title="v-if 使用时注意 vue会将一样的元素复用 需要加key解决"></a>v-if 使用时注意 vue会将一样的元素复用 需要加key解决</h2><blockquote>
<p>在下面的案例中 即使渲染出返回按钮 因为下面的每个else元素都一样 但是返回依然不现实 因为复用了下面的元素样式display: none;   需要在不需要复用的元素上加key 解决</p>
</blockquote>
<p><a href="[https://cn.vuejs.org/v2/guide/conditional.html#%E7%94%A8-key-%E7%AE%A1%E7%90%86%E5%8F%AF%E5%A4%8D%E7%94%A8%E7%9A%84%E5%85%83%E7%B4%A0](https://cn.vuejs.org/v2/guide/conditional.html#用-key-管理可复用的元素)">vue原文链接</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top-button"</span> <span class="attr">v-if</span>=<span class="string">"isView"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">"isView = false"</span> <span class="attr">icon</span>=<span class="string">"iconfont iconfont-hcm-back"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top-button"</span> <span class="attr">v-else-if</span>=<span class="string">"isEdit === false"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">"onNewPayment"</span> <span class="attr">icon</span>=<span class="string">"iconfont iconfont-hcm-add"</span> <span class="attr">v-btn:edit</span>=<span class="string">"$route.query"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   &gt;</span>新建<span class="tag">&lt;/<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">  &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">type</span>=<span class="string">"primary"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">icon</span>=<span class="string">"iconfont iconfont-xinchou-fabu"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">plain</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   @<span class="attr">click</span>=<span class="string">"onPublish(true)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">v-btn:edit</span>=<span class="string">"$route.query"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   &gt;</span>发布<span class="tag">&lt;/<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">  &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">type</span>=<span class="string">"primary"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">icon</span>=<span class="string">"iconfont iconfont-xinchou-quxiaofabu"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">plain</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   @<span class="attr">click</span>=<span class="string">"onPublish(false)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">v-btn:edit</span>=<span class="string">"$route.query"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   &gt;</span>取消发布<span class="tag">&lt;/<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">  &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">"onClickCancelPublish"</span> <span class="attr">v-btn:edit</span>=<span class="string">"$route.query"</span>&gt;</span>设置启动时间<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">type</span>=<span class="string">"primary"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">plain</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   @<span class="attr">click</span>=<span class="string">"$refs.changeLogDialog.open(currentNode.data.id, false)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">v-btn:view</span>=<span class="string">"$route.query"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   &gt;</span>查看变更记录<span class="tag">&lt;/<span class="name">el-button</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">  &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"top-button"</span> <span class="attr">v-else-if</span>=<span class="string">"isEdit"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">"onEditSave"</span> <span class="attr">icon</span>=<span class="string">"iconfont iconfont-hcm-save"</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">plain</span> @<span class="attr">click</span>=<span class="string">"onEditCancel"</span> <span class="attr">icon</span>=<span class="string">"iconfont iconfont-hcm-delete"</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">el-header</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="vue样式：scoped-使用"><a href="#vue样式：scoped-使用" class="headerlink" title="vue样式：scoped 使用"></a>vue样式：scoped 使用</h2><h4 id="深度作用选择器"><a href="#深度作用选择器" class="headerlink" title="深度作用选择器"></a>深度作用选择器</h4><p>如果你希望 <code>scoped</code> 样式中的一个选择器能够作用得“更深”，例如影响子组件，你可以使用 <code>&gt;&gt;&gt;</code> 操作符：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"><span class="selector-class">.a</span> &gt;&gt;&gt; <span class="selector-class">.b</span> &#123; <span class="comment">/* ... */</span> &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr></table></figure>

<p>上述代码将会编译成：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.a</span><span class="selector-attr">[data-v-f3f3eg9]</span> <span class="selector-class">.b</span> &#123; <span class="comment">/* ... */</span> &#125;</span></pre></td></tr></table></figure>

<p>有些像 Sass 之类的预处理器无法正确解析 <code>&gt;&gt;&gt;</code>。这种情况下你可以使用 <code>/deep/</code> 或 <code>::v-deep</code> 操作符取而代之——两者都是 <code>&gt;&gt;&gt;</code> 的别名，同样可以正常工作。</p>
<p>参考： <a href="[https://vue-loader.vuejs.org/zh/guide/scoped-css.html#%E6%B7%B1%E5%BA%A6%E4%BD%9C%E7%94%A8%E9%80%89%E6%8B%A9%E5%99%A8](https://vue-loader.vuejs.org/zh/guide/scoped-css.html#深度作用选择器)">vue-loader官方文档-深度作用选择器</a></p>
<h2 id="Vue-中的v-bind-使用问题"><a href="#Vue-中的v-bind-使用问题" class="headerlink" title="Vue 中的v-bind 使用问题"></a>Vue 中的v-bind 使用问题</h2><blockquote>
<p>在vue中使用v-bind 绑定对象时 需要注意 ：v-bind绑定值不会覆盖之前的属性</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"test"</span> <span class="attr">:disabled</span>=<span class="string">"false"</span> <span class="attr">v-bind</span>=<span class="string">"&#123; disabled: true, class: 'test3' &#125;"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 上面的代码disabled显示的还是false 但是class可以进行合并 显示：class="test test3" --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">type</span>=<span class="string">"text"</span> </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">class</span>=<span class="string">"test"</span> </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">:class</span>=<span class="string">"'test2'"</span> </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">:disabled</span>=<span class="string">"false"</span> </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   <span class="attr">v-bind</span>=<span class="string">"&#123; disabled: true, class: 'test3' &#125;"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">   /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注意： class 只能合并一次  最后显示 class="test test2"--&gt;</span></span></pre></td></tr></table></figure>

<h2 id="vue-property-decorator-注意事项（ts项目中）"><a href="#vue-property-decorator-注意事项（ts项目中）" class="headerlink" title="vue-property-decorator  注意事项（ts项目中）"></a>vue-property-decorator  注意事项（ts项目中）</h2><p>介绍链接[<a href="https://segmentfault.com/a/1190000019906321]" target="_blank" rel="noopener">https://segmentfault.com/a/1190000019906321]</a></p>
<h3 id="1-新建组件必须加-Component-否则组件会怎样都不现实"><a href="#1-新建组件必须加-Component-否则组件会怎样都不现实" class="headerlink" title="1.新建组件必须加@Component 否则组件会怎样都不现实"></a>1.新建组件必须加@Component 否则组件会怎样都不现实</h3><h2 id="router-传参-注意事项"><a href="#router-传参-注意事项" class="headerlink" title="router 传参 注意事项"></a>router 传参 注意事项</h2><blockquote>
<p>路由传参query 和 params 显示到地址栏形式的 注意 不要超长 ，否则浏览器会报413错误 ， 传参需要按需传送</p>
</blockquote>
<h2 id="prop-中默认值返回空对象"><a href="#prop-中默认值返回空对象" class="headerlink" title="prop 中默认值返回空对象"></a>prop 中默认值返回空对象</h2><p>prop 中 default 默认值 返回对象或数组需要使用工厂函数 ，一般我们都会用箭头函数简写 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  defaultText: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    type: <span class="built_in">Array</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span> []	   <span class="comment">// 工厂函数返回空数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 错误写法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  defaultAttrs: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    type: <span class="built_in">Object</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span> &#123;&#125;    <span class="comment">// 但是返回空对象就不能直接=&gt;&#123;&#125; 这样就代表函数的块级作用域了 会报错</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 正确写法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   defaultAttrs: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    type: <span class="built_in">Object</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span> (&#123;&#125;)    <span class="comment">// 在&#123;&#125;外面包一层()即可</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,    </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>XLSX.js的使用</title>
    <url>/excel/XLSX-js%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p>merges 的使用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">........</span></pre></td></tr><tr><td class="code"><pre><span class="line">data[<span class="string">"!merges"</span>] = [&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    s: &#123;<span class="comment">//s为开始</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        c: <span class="number">1</span>,<span class="comment">//开始列</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        r: <span class="number">0</span><span class="comment">//可以看成开始行,实际是取值范围</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    e: &#123;<span class="comment">//e结束</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        c: <span class="number">4</span>,<span class="comment">//结束列</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        r: <span class="number">0</span><span class="comment">//结束行</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;];</span></pre></td></tr><tr><td class="code"><pre><span class="line">........</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>excel</category>
      </categories>
      <tags>
        <tag>excel</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue列表渲染中对象和数组变更检测注意事项</title>
    <url>/vue/Vue%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93%E4%B8%AD%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84%E5%8F%98%E6%9B%B4%E6%A3%80%E6%B5%8B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
    <content><![CDATA[<h2 id="对象变更检测注意事项"><a href="#对象变更检测注意事项" class="headerlink" title="对象变更检测注意事项"></a>对象变更检测注意事项</h2><p><a href="https://cn.vuejs.org/v2/guide/list.html#对象变更检测注意事项" target="_blank" rel="noopener">对象变更检测注意事项</a></p>
<p>还是由于 JavaScript 的限制，<strong>Vue 不能检测对象属性的添加或删除</strong>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> data: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  a: <span class="number">1</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// `vm.a` 现在是响应式的</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">vm.b = <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// `vm.b` 不是响应式的</span></span></pre></td></tr></table></figure>

<p>对于已经创建的实例，Vue 不允许动态添加根级别的响应式属性。但是，可以使用 <code>Vue.set(object, propertyName, value)</code> 方法向嵌套对象添加响应式属性。例如，对于：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> data: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  userProfile: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   name: <span class="string">"Anika"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>你可以添加一个新的 <code>age</code> 属性到嵌套的 <code>userProfile</code> 对象：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Vue.set(vm.userProfile, <span class="string">"age"</span>, <span class="number">27</span>);</span></pre></td></tr></table></figure>

<p>你还可以使用 <code>vm.$set</code> 实例方法，它只是全局 <code>Vue.set</code> 的别名：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">vm.$<span class="keyword">set</span>(vm.userProfile, "age", 27);</span></pre></td></tr></table></figure>

<p>如果你想给一个 data 中的对象新加属性又不想使用到以上方法</p>
<p>建议使用一个变量接收添加完新属性的对象，然后在从新赋值给原 data 中的数据</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> userProfile = vm.userProfile;</span></pre></td></tr><tr><td class="code"><pre><span class="line">userProfile.age = <span class="number">27</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">vm.userProfile = userProfile;</span></pre></td></tr></table></figure>

<p>有时你可能需要为已有对象赋值多个新属性，比如使用 <code>Object.assign()</code> 或 <code>jQuery.extend()</code>。在这种情况下，你应该用两个对象的属性创建一个新的对象。所以，如果你想添加新的响应式属性，不要像这样：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.assign(vm.userProfile, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//不要仅仅直接添加属性的方式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> age: <span class="number">27</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> favoriteColor: <span class="string">"Vue Green"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>你应该这样做：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">vm.userProfile = <span class="built_in">Object</span>.assign(&#123;&#125;, vm.userProfile, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//建议新建一个对象合并和后在重新赋值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> age: <span class="number">27</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> favoriteColor: <span class="string">"Vue Green"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<h2 id="Object-assign-方法"><a href="#Object-assign-方法" class="headerlink" title="Object.assign() 方法"></a>Object.assign() 方法</h2><p><code>Object.assign</code>方法用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象（target）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.assign(target, source1, source2);</span></pre></td></tr><tr><td class="code"><pre><span class="line">target; <span class="comment">// &#123;a:1, b:2, c:3&#125;</span></span></pre></td></tr></table></figure>

<h2 id="数组更新检测"><a href="#数组更新检测" class="headerlink" title="数组更新检测"></a>数组更新检测</h2><p><a href="https://cn.vuejs.org/v2/guide/list.html#数组更新检测" target="_blank" rel="noopener">数组更新检测</a></p>
<h3 id="变异方法-mutation-method"><a href="#变异方法-mutation-method" class="headerlink" title="变异方法 (mutation method)"></a>变异方法 (mutation method)</h3><p>Vue 将被侦听的数组的变异方法进行了包裹，所以它们也将会触发视图更新。这些被包裹过的方法包括：</p>
<ul>
<li><code>push()</code></li>
<li><code>pop()</code></li>
<li><code>shift()</code></li>
<li><code>unshift()</code></li>
<li><code>splice()</code></li>
<li><code>sort()</code></li>
<li><code>reverse()</code></li>
</ul>
<p>你可以打开控制台，然后对前面例子的 <code>items</code> 数组尝试调用变异方法。比如 <code>example1.items.push({ message: &#39;Baz&#39; })</code>。</p>
<h3 id="替换数组"><a href="#替换数组" class="headerlink" title="替换数组"></a>替换数组</h3><p>变异方法，顾名思义，会改变调用了这些方法的原始数组。相比之下，也有非变异 (non-mutating method) 方法，例如 <code>filter()</code>、<code>concat()</code> 和 <code>slice()</code> 。它们不会改变原始数组，而<strong>总是返回一个新数组</strong>。当使用非变异方法时，可以用新数组替换旧数组：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">example1.items = example1.items.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> item.message.match(<span class="regexp">/Foo/</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>你可能认为这将导致 Vue 丢弃现有 DOM 并重新渲染整个列表。幸运的是，事实并非如此。Vue 为了使得 DOM 元素得到最大范围的重用而实现了一些智能的启发式方法，所以用一个含有相同元素的数组去替换原来的数组是非常高效的操作。</p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>由于 JavaScript 的限制，Vue <strong>不能</strong>检测以下数组的变动：</p>
<ol>
<li>当你利用索引直接设置一个数组项时，例如：<code>vm.items[indexOfItem] = newValue</code></li>
<li>当你修改数组的长度时，例如：<code>vm.items.length = newLength</code></li>
</ol>
<p>举个例子：</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">var <span class="keyword">vm</span> = <span class="keyword">new</span> Vue(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  dat<span class="variable">a:</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    item<span class="variable">s:</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">vm</span>.<span class="built_in">items</span>[<span class="number">1</span>] = <span class="string">'x'</span> // 不是响应性的</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">vm</span>.<span class="built_in">items</span>.length = <span class="number">2</span> // 不是响应性的</span></pre></td></tr></table></figure>

<p>为了解决第一类问题，以下两种方式都可以实现和 <code>vm.items[indexOfItem] = newValue</code> 相同的效果，同时也将在响应式系统内触发状态更新：</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue.set</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">Vue.<span class="keyword">set</span>(vm.items, indexOfItem, <span class="keyword">new</span><span class="type">Value</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Array.prototype.splice</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">vm.items.splice(indexOfItem, <span class="number">1</span>, <span class="keyword">new</span><span class="type">Value</span>)</span></pre></td></tr></table></figure>

<p>你也可以使用 <a href="https://cn.vuejs.org/v2/api/#vm-set" target="_blank" rel="noopener"><code>vm.$set</code></a> 实例方法，该方法是全局方法 <code>Vue.set</code> 的一个别名：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">vm.<span class="constructor">$set(<span class="params">vm</span>.<span class="params">items</span>, <span class="params">indexOfItem</span>, <span class="params">newValue</span>)</span></span></pre></td></tr></table></figure>

<p>为了解决第二类问题，你可以使用 <code>splice</code>：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">vm</span><span class="selector-class">.items</span><span class="selector-class">.splice</span>(<span class="selector-tag">newLength</span>)</span></pre></td></tr></table></figure>

<h4 id="建议如果需要替换数组中某一项统一使用-splice-方法"><a href="#建议如果需要替换数组中某一项统一使用-splice-方法" class="headerlink" title="建议如果需要替换数组中某一项统一使用 splice 方法"></a><strong>建议如果需要替换数组中某一项统一使用 splice 方法</strong></h4>]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>element+sortablejs实现表格托拽</title>
    <url>/vue/element-sortablejs%E5%AE%9E%E7%8E%B0%E8%A1%A8%E6%A0%BC%E6%89%98%E6%8B%BD/</url>
    <content><![CDATA[<p>最终实现效果：</p>
<a id="more"></a>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E5%8D%95%E8%A1%A8%E6%A0%BC%E6%89%98%E6%8B%BD.gif" alt="单表格托拽"></p>
<p>js 部分实现</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Sortable <span class="keyword">from</span> <span class="string">'sortablejs'</span>;<span class="comment">//引入sortablejs</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//1.请求数据后使用托拽方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.setSort();</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//2. 托拽方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 初始化拖拽</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> setSort() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.rightTable);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> el = <span class="keyword">this</span>.$refs.rightTable.$el.querySelectorAll(<span class="string">'.el-table__body-wrapper &gt; table &gt; tbody'</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.sortable = Sortable.create(el, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   animation: <span class="number">150</span>,  <span class="comment">// ms, number 单位：ms，定义排序动画的时间</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//  指定父元素下可被拖拽的子元素</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   draggable: <span class="string">'.el-table__row'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onEnd(&#123; newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'TabsTreeTable -&gt; onEnd -&gt; newIndex, oldIndex'</span>, newIndex, oldIndex);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> rightTableData = cloneDeep(_this.rightTableData);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> currRow = rightTableData.splice(oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rightTableData.splice(newIndex, <span class="number">0</span>, currRow);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.rightTableData = rightTableData;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.rightOriginData = cloneDeep(rightTableData);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ghostClass: <span class="string">'sortable-ghost'</span>, <span class="comment">// Class name for the drop placeholder,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   setData: <span class="function"><span class="keyword">function</span>(<span class="params">dataTransfer</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// to avoid Firefox bug</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// Detail see : https://github.com/RubaXa/Sortable/issues/1012</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dataTransfer.setData(<span class="string">'Text'</span>, <span class="string">''</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr></table></figure>

<p>css 部分</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//针对固定列的table需要处理hover的样式</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">tr</span><span class="selector-class">.hover-row</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &amp;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &amp;<span class="selector-class">.el-table__row--striped</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &amp;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &amp;<span class="selector-class">.current-row</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &gt; td &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="selector-tag">background-color</span>: <span class="selector-tag">transparent</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">//托拽时的样式</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-class">.sortable-ghost</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="attribute">opacity</span>: <span class="number">0.8</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="attribute">color</span>: <span class="number">#fff</span> <span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="attribute">background</span>: <span class="number">#42b983</span> <span class="meta">!important</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>注意事项：el-table 需要指定 row-key 否则会发生不生效的现象，托拽时的样式不生效时，需要将 el-table 的 hover 样式去掉</p>
</blockquote>
<h2 id="两个-table-的相互托拽"><a href="#两个-table-的相互托拽" class="headerlink" title="两个 table 的相互托拽"></a>两个 table 的相互托拽</h2><p>最终实现效果：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E5%8F%8C%E8%A1%A8%E6%A0%BC%E8%A1%A8%E6%A0%BC%E6%89%98%E6%8B%BD.gif" alt="双表格表格托拽"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 初始化拖拽</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> setSort() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.rightTable);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> el = <span class="keyword">this</span>.$refs.rightTable.$el.querySelectorAll(<span class="string">'.el-table__body-wrapper &gt; table &gt; tbody'</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> el2 = <span class="keyword">this</span>.$refs.leftTable.$el.querySelectorAll(<span class="string">'.el-table__body-wrapper &gt; table &gt; tbody'</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.sortable = Sortable.create(el, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   group: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">'shared'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    pull: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="built_in">console</span>.log(<span class="string">'right: data'</span>, data);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   animation: <span class="number">150</span>, <span class="comment">//动画效果</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">//  指定父元素下可被拖拽的子元素</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   draggable: <span class="string">'.el-table__row'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onUpdate(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> currRow = _this.rightTableData.splice(oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.rightTableData.splice(newIndex, <span class="number">0</span>, currRow);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onUpdate: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'onUpdate-&gt; onEnd -&gt; newIndex, oldIndex'</span>, newIndex, oldIndex);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'列表单元在列表容器中的排序发生变化后的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onRemove(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> currRow = _this.rightTableData.splice(oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.leftTableData.splice(newIndex, <span class="number">0</span>, currRow);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onRemoveleft: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'onRemove -&gt; onEnd -&gt; newIndex, oldIndex'</span>, newIndex, oldIndex);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'列表元素移到另一个列表容器的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ghostClass: <span class="string">'sortable-ghost'</span>, <span class="comment">// Class name for the drop placeholder,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   setData: <span class="function"><span class="keyword">function</span>(<span class="params">dataTransfer</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// to avoid Firefox bug</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// Detail see : https://github.com/RubaXa/Sortable/issues/1012</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dataTransfer.setData(<span class="string">'Text'</span>, <span class="string">''</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.sortable = Sortable.create(el2, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   group: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">'shared'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    pull: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="built_in">console</span>.log(<span class="string">'left: data'</span>, data);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   animation: <span class="number">150</span>, <span class="comment">//动画效果</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">//  指定父元素下可被拖拽的子元素</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   draggable: <span class="string">'.el-table__row'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onRemove(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> currRow = _this.leftTableData.splice(oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.rightTableData.splice(newIndex, <span class="number">0</span>, currRow);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onRemoveleft: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onRemove -&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'列表元素移到另一个列表容器的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onChoose(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onChoose: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onChoose-&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'function 列表单元被选中的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onStart(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onStart: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onStart -&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'function 列表单元拖动开始的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">   onAdd(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onAdd: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onAddve -&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'列表单元添加到本列表容器的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onUpdate(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> currRow = _this.leftTableData.splice(oldIndex, <span class="number">1</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">    _this.leftTableData.splice(newIndex, <span class="number">0</span>, currRow);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onUpdate: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onUpdate-&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">'列表单元在列表容器中的排序发生变化后的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onFilter(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onFilter: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onFilter-&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">' 试图选中一个被filter过滤的列表单元的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onMove(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onMove: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onMovee -&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">' 当移动列表单元在一个列表容器中或者多个列表容器中的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   onClone(&#123; to, <span class="keyword">from</span>, newIndex, oldIndex &#125;) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onClone: onEnd -&gt; to, from,', to, from);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// console.log('onClone -&gt; onEnd -&gt; newIndex, oldIndex', newIndex, oldIndex);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">' 当创建一个列表单元副本的时候的回调函数'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ghostClass: <span class="string">'sortable-ghost'</span>, <span class="comment">// Class name for the drop placeholder,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   setData: <span class="function"><span class="keyword">function</span>(<span class="params">dataTransfer</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// to avoid Firefox bug</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// Detail see : https://github.com/RubaXa/Sortable/issues/1012</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dataTransfer.setData(<span class="string">'Text'</span>, <span class="string">''</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>elementUI</tag>
        <tag>sortablejs</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo采坑日记</title>
    <url>/hexo/hexo%E9%87%87%E5%9D%91%E6%97%A5%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="hexo-上传-github-后图片不显示问题"><a href="#hexo-上传-github-后图片不显示问题" class="headerlink" title="hexo 上传 github 后图片不显示问题"></a>hexo 上传 github 后图片不显示问题</h2><a id="more"></a>
<ul>
<li><p>在文件夹下找到_config.yml 文件 将<code>post_asset_folder:</code>修改为 true</p>
</li>
<li><p>将上面的参数修改后 直接<code>hexo new 文件名</code> 会自动创建出一个跟文件同名的文件夹 ，将图片等资料都放到文件夹中</p>
</li>
<li><p>下载依赖~<code>npm install hexo-asset-image https://github.com/CodeFalling/hexo-asset-image</code></p>
<blockquote>
<p>注意下载 依赖一定要后面的网址 这接<code>hexo-asset-image</code> 会下载最新版 还会导致图片不显示</p>
<p>注意（）内部直接加文件名/图片名即可, 例如：<code>![1574935033235](hexo采坑日记/1574935033235.png)</code>  </p>
<p>加相对路径例如<code>![1574935033235](./hexo采坑日记/1574935033235.png)</code> 也会导致图片不显示</p>
<p>注意：路径需要encodeURI 才行  像这样<code>hexo%E9%87%87%E5%9D%91%E6%97%A5%E8%AE%B0/image-20200725174552781.png</code></p>
</blockquote>
</li>
<li><p>使用 typroa 修改图片路径 下面这种方法 typroa 会自动保存到命名文件夹下，并自动encode</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201215135603281.png" alt="image-20201215135603281"></p>
</li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p><strong>编辑好 md 文档先在<code>hexo server</code> 运行一下在提交 github</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Markdown 使用时（） &#123; &#125; 都需要转义 否者会报错</span></pre></td></tr></table></figure>

<p><strong>每次提交 github 自动构建前，要重启一下 hexo server 然后看看没有报错 ，再进行提交</strong></p>
<h2 id="next主题注意事项"><a href="#next主题注意事项" class="headerlink" title="next主题注意事项"></a>next主题注意事项</h2><p>canvas_ribbon 和 tree 需要配合在CDN中添加 git默认不上传lib下的文件</p>
<h2 id="关于报错"><a href="#关于报错" class="headerlink" title="关于报错"></a>关于报错</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200725160508488.png" alt="image-20200725160508488"></p>
<p> 没有任何提示 哪个文件，挨个改动回退试试，原来是因为<code>_config.yml</code>这里直接写中文是不行的，中文需要引号包裹</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># 微博: http://weibo.com/your-user-name  这里不能使用中文  确使用方式如下  地址后是图标</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"微博"</span><span class="string">:</span> <span class="string">http://weibo.com/your-user-name</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-weibo</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"知乎"</span><span class="string">:</span> <span class="string">http://www.zhihu.com/people/your-user-name</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-zhihu</span></span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>HTML第一天</title>
    <url>/html/html1/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E4%B8%8B%E8%BD%BD.jpg" alt="下载"></p>
<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><ul>
<li>chrome</li>
<li>sublime</li>
<li>photoshop</li>
</ul>
<h2 id="主要浏览器"><a href="#主要浏览器" class="headerlink" title="主要浏览器"></a>主要浏览器</h2><ul>
<li>IE</li>
<li>火狐（Firefox）</li>
<li>谷歌（chrome）</li>
<li>safari</li>
<li>opera</li>
</ul>
<h2 id="浏览器内核"><a href="#浏览器内核" class="headerlink" title="浏览器内核"></a>浏览器内核</h2><ul>
<li>Trident(IE 内核)</li>
<li>Gecko(firefox)</li>
<li>webkit(Safari)</li>
<li>Chromium/Blink(chrome)</li>
<li>Presto(Opera)</li>
</ul>
<h2 id="HTML-骨架格式"><a href="#HTML-骨架格式" class="headerlink" title="HTML 骨架格式"></a>HTML 骨架格式</h2><ul>
<li><p>1 HTML 标签：</p>
<p>作用所有 HTML 中标签的一个根节点。 最大的标签 根标签</p>
</li>
<li><p>2 head 标签： 文档的头部</p>
<p>文档的头部描述了文档的各种属性和信息，包括文档的标题、在 Web 中的位置以及和其他文档的关系等。绝大多数文档头部包含的数据都不会真正作为内容显示给读者。注意在 head 标签中我们必须要设置的标签是 title</p>
</li>
<li><p>3.title 标签： 文档的标题</p>
<p>作用：让页面拥有一个属于自己的标题。</p>
</li>
<li><p>4.body 标签：文档的主体 以后我们的页面内容 基本都是放到 body 里面的</p>
<p>body 元素包含文档的所有内容（比如文本、超链接、图像、表格和列表等等。）</p>
</li>
</ul>
<h2 id="HTML-标签分类"><a href="#HTML-标签分类" class="headerlink" title="HTML 标签分类"></a>HTML 标签分类</h2><ul>
<li>1.双标签 &lt;标签名&gt; 内容 &lt;/标签名&gt; 比如 <code>&lt;body&gt;</code>我是文字 <code>&lt;/body&gt;</code></li>
<li>1.嵌套(包含)关系 <code>&lt;head&gt; &lt;title&gt; &lt;/title&gt; &lt;/head&gt;</code></li>
</ul>
<h2 id="HTML-标签关系"><a href="#HTML-标签关系" class="headerlink" title="HTML 标签关系"></a>HTML 标签关系</h2><ul>
<li>1.嵌套(包含)关系 <code>&lt;head&gt; &lt;title&gt; &lt;/title&gt; &lt;/head&gt;</code></li>
<li>2.并列关系 <code>&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;</code></li>
</ul>
<h2 id="sublime-一些常用快捷键"><a href="#sublime-一些常用快捷键" class="headerlink" title="sublime 一些常用快捷键"></a>sublime 一些常用快捷键</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574421790594.png" alt="1574421790594"></p>
<h2 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h2><ul>
<li>utf-8 是目前最常用的字符集编码方式，常用的字符集编码方式还有 gbk 和 gb2312。</li>
<li>gb2312 简单中文 包括 6763 个汉字</li>
<li>BIG5 繁体中文 港澳台等用</li>
<li>GBK 包含全部中文字符 是 GB2312 的扩展，加入对繁体字的支持，兼容 GB2312</li>
<li>UTF-8 则包含全世界所有国家需要用到的字符</li>
<li>记住一点，以后我们统统使用 UTF-8 字符集, 这样就避免出现字符集不统一而引起乱码的情况了。</li>
</ul>
<h2 id="HTML-常用标签"><a href="#HTML-常用标签" class="headerlink" title="HTML 常用标签"></a>HTML 常用标签</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">标题标签 (熟记) head 头部. 标题 title 文档标题 HTML提供了6个等级的标题</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     和</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="tag">&lt;<span class="name">h6</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      段落标签( 熟记)</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>文本内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      水平线标签(认识)</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      是单标签 换行标签(熟记) <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="文本格式化标签-熟记"><a href="#文本格式化标签-熟记" class="headerlink" title="文本格式化标签(熟记)"></a>文本格式化标签(熟记)</h2><p><img src="/html/html1/1574422211138.png" alt="1574422211138"></p>
<h2 id="img-标记属性"><a href="#img-标记属性" class="headerlink" title="img 标记属性"></a>img 标记属性</h2><ul>
<li>src 图像的路径</li>
<li>alt 图像不能显示时的替换文本</li>
<li>title 鼠标悬停时显示的内容</li>
<li>width 设置图像的宽度</li>
<li>height 设置图像的高度</li>
<li>border 设置图像边框的宽度</li>
</ul>
<h2 id="链接标签-重点"><a href="#链接标签-重点" class="headerlink" title="链接标签(重点)"></a>链接标签(重点)</h2><p><code>&lt;a href=&quot;跳转目标&quot; target=&quot;目标窗口的弹出方式&quot;&gt;文本或图像&lt;/a&gt;</code></p>
<p>target：用于指定链接页面的打开方式，其取值有 self 和_blank 两种，其中 self 为默认值，blank 为在新窗口中打开方式。</p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><blockquote>
<p>1.外部链接 需要添加 http:// <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a><br>2.内部链接 直接链接内部页面名称即可 比如<code>&lt; a href=&quot;index.html&quot;&gt; 首页 &lt;/a &gt;</code><br>3.如果当时没有确定链接目标时，通常将链接标签的 href 属性值定义为“#”(即 href=”#”)，表示该链接暂时为一个空链接。<br>4.不仅可以创建文本超链接，在网页中各种网页元素，如图像、表格、音频、视频等都可以添加超链接。</p>
</blockquote>
<h2 id="锚点定位-（难点）"><a href="#锚点定位-（难点）" class="headerlink" title="锚点定位 （难点）"></a>锚点定位 （难点）</h2><p>vk control control 1.使用相应的 id 名标注跳转目标的位置。</p>
<p><code>&lt;h3 id=&quot;two&quot;&gt;第2集&lt;/h3&gt;</code></p>
<p>2.使用“a href=”#id 名&gt;“链接文本”<code>&lt;/a&gt;</code>创建链接文本（被点击的）<code>&lt;a href=&quot;#two&quot;&gt;</code></p>
<h2 id="base-标签-基本的"><a href="#base-标签-基本的" class="headerlink" title="base 标签 基本的"></a>base 标签 基本的</h2><ul>
<li>base 可以设置整体链接的打开状态</li>
<li>base 写到 <code>&lt;head&gt; &lt;/head&gt;</code> 之间</li>
<li>把所有的连接 都默认添加 target=”_blank”</li>
</ul>
<h2 id="特殊字符标签-（理解）"><a href="#特殊字符标签-（理解）" class="headerlink" title="特殊字符标签 （理解）"></a>特殊字符标签 （理解）</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574422894085.png" alt="1574422894085"></p>
<h2 id="路径-重点、难点"><a href="#路径-重点、难点" class="headerlink" title="路径(重点、难点)"></a>路径(重点、难点)</h2><h3 id="相对路径"><a href="#相对路径" class="headerlink" title="相对路径"></a>相对路径</h3><p>1.图像文件和 HTML 文件位于同一文件夹：只需输入图像文件的名称即可，如<code>&lt;img src=&quot;logo.gif&quot; /&gt;</code>。</p>
<p>2.图像文件位于 HTML 文件的下一级文件夹：输入文件夹名和文件名，之间用“/”隔开，如<code>&lt;img src=&quot;img/img01/logo.gif&quot; /&gt;</code>。</p>
<p>3.图像文件位于 HTML 文件的上一级文件夹：在文件名之前加入“../” ，如果是上两级，则需要使用 “../ ../”，以此类推，如<code>&lt;img src=&quot;../logo.gif&quot; /&gt;</code>。</p>
<h3 id="绝对路径"><a href="#绝对路径" class="headerlink" title="绝对路径"></a>绝对路径</h3><p>绝对路径以 Web 站点根目录为参考基础的目录路径。之所以称为绝对，意指当所有网页引用同一个文件时，所使用的路径都是一样的</p>
<p>“D:\web\img\logo.gif”，或完整的网络地址，例如“<a href="http://www.itcast.cn/image/logo.gif" target="_blank" rel="noopener">http://www.itcast.cn/image/logo.gif</a>”。</p>
]]></content>
      <categories>
        <category>html</category>
      </categories>
      <tags>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title>javaScript-变量-数据类型-数据类型的转换</title>
    <url>/js/javaScript-%E5%8F%98%E9%87%8F-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<h2 id="变量-（主要）"><a href="#变量-（主要）" class="headerlink" title="变量 （主要）"></a>变量 （主要）</h2><h3 id="为什么要使用变量"><a href="#为什么要使用变量" class="headerlink" title="为什么要使用变量"></a>为什么要使用变量</h3><ul>
<li>因为编程中会存在很多数据操作，多次进行数据操作很麻烦，而且会出错</li>
</ul>
<h3 id="什么是变量"><a href="#什么是变量" class="headerlink" title="什么是变量"></a>什么是变量</h3><ul>
<li>本质上就是保存数据的容器，用来方便进行数据操作</li>
</ul>
<h3 id="变量怎么操作"><a href="#变量怎么操作" class="headerlink" title="变量怎么操作"></a>变量怎么操作</h3><ul>
<li>变量的声明操作<ul>
<li>格式： var 变量名; - 注意：声明变量必须设置 var！！！<a id="more"></a>

</li>
</ul>
</li>
</ul>
<h3 id="变量的赋值操作"><a href="#变量的赋值操作" class="headerlink" title="变量的赋值操作"></a>变量的赋值操作</h3><ul>
<li><p>格式：var 变量名; 变量名 = 数据；</p>
</li>
<li><p>同时进行声明和赋值操作</p>
</li>
<li><p>格式： var 变量名 = 数据;</p>
</li>
<li><p>合并多个变量的声明或赋值</p>
<ul>
<li>格式： var 变量名 1 = 数据 1, 变量名 2， 变量名 3 = 数据; // ….</li>
</ul>
</li>
<li><p>操作变量实际上就是操作内部保存的数据。</p>
</li>
</ul>
<h2 id="基本数据类型-5-个"><a href="#基本数据类型-5-个" class="headerlink" title="基本数据类型 5 个"></a>基本数据类型 5 个</h2><h3 id="数值类型-number"><a href="#数值类型-number" class="headerlink" title="数值类型 number"></a>数值类型 number</h3><ul>
<li>组成<ul>
<li>基本数值：生活中的整数和小数</li>
<li>特殊数值：NaN - 非数值</li>
</ul>
</li>
<li>极限值（了解，不需要记忆）<ul>
<li>无穷和无限的概念只在生活中存在，是一种理想化的情况</li>
<li>计算机中的编程语言不可能表示出无限的数值位数，是具有最大和最小值的</li>
<li>Number.MAX_VALUE 超出了这个最大表示范围后出现 Infinity</li>
<li>Number.MIN_VALUE 正数的最小精度</li>
</ul>
</li>
</ul>
<h3 id="字符串类型-string"><a href="#字符串类型-string" class="headerlink" title="字符串类型 string"></a>字符串类型 string</h3><ul>
<li>特殊的标识方式<ul>
<li>成对的英文半角的单引号或双引号</li>
<li>推荐使用单引号进行标识</li>
</ul>
</li>
<li>转义符的使用<ul>
<li>转义符的符号： 反斜线 \</li>
<li>作用：<ul>
<li>将特殊字符转换为普通字符</li>
<li>将普通字符转换为特殊字符</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="布尔类型-boolean"><a href="#布尔类型-boolean" class="headerlink" title="布尔类型 boolean"></a>布尔类型 boolean</h3><p>组成： true 和 false</p>
<ul>
<li>用来表示某个结果的真 true 或假 false</li>
</ul>
<h3 id="undefined-未定义"><a href="#undefined-未定义" class="headerlink" title="undefined 未定义"></a>undefined 未定义</h3><ul>
<li>defined 定义</li>
<li>出现在某些操作的默认值中<ul>
<li>当变量声明还未赋值时，默认值为 undefined</li>
<li>后面学习的其他语法中也存在默认值为 undefined 的情况<ul>
<li>会在后面的内容中依次讲解，最后一天进行小结</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="null-空"><a href="#null-空" class="headerlink" title="null 空"></a>null 空</h3><p>当我们希望主动的将变量中保存的数据清空时，设置为 null 即可</p>
<h2 id="类型检测操作"><a href="#类型检测操作" class="headerlink" title="类型检测操作"></a>类型检测操作</h2><h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><ul>
<li><p>使用方式：</p>
<ul>
<li>typeof 数据</li>
<li>typeof(数据)</li>
</ul>
</li>
<li><p>两种方式检测结果没有区别，个人推荐第一种</p>
</li>
<li><p>结果：</p>
<ul>
<li>字符串形式的类型名称，例如’string’ ‘number’。。</li>
<li>问题：对 null 的检测结果不准确，是’object’，后续会介绍其他方式</li>
</ul>
</li>
</ul>
<h2 id="变量的交换操作"><a href="#变量的交换操作" class="headerlink" title="变量的交换操作"></a>变量的交换操作</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 需求：交换str1和str2中保存的数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = <span class="string">"我是第一个变量的内容"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str2 = <span class="string">"我是第二个变量的内容"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 实现方式，设置一个用来中转数据的变量即可</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> temp = str1;</span></pre></td></tr><tr><td class="code"><pre><span class="line">str1 = str2;</span></pre></td></tr><tr><td class="code"><pre><span class="line">str2 = temp;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">alert(str1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">alert(str2);</span></pre></td></tr></table></figure>

<h2 id="常用的输出方式"><a href="#常用的输出方式" class="headerlink" title="常用的输出方式"></a>常用的输出方式</h2><ul>
<li>alert() 普通的弹出提示框</li>
<li>console.log() 在控制台中输出内容，非常常用<ul>
<li>console.log(数据 1, 数据 2, 数据 3………);</li>
</ul>
</li>
<li>confirm() 确认提示框<ul>
<li>根据用户选择的确定和取消返回布尔值 true 或 false</li>
</ul>
</li>
<li>prompt() 输入提示框<ul>
<li>点击确定后，会将输入框中的内容返回，点击取消为空 null</li>
</ul>
</li>
<li>document.write() 在文档中输出内容（输出位置为 body 标签内）<ul>
<li>设置的 html 标签结构，会被生成为真正的标签</li>
</ul>
</li>
</ul>
<h2 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h2><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h3><ul>
<li>转换失败结果均为 NaN</li>
<li>强制转换：<ul>
<li>Number(数据);</li>
<li>parseInt()<ul>
<li>将数据转换为整数</li>
</ul>
</li>
<li>parseFloat()<ul>
<li>将数据转换为小数</li>
</ul>
</li>
</ul>
</li>
<li>隐式转换：<ul>
<li>+- 俗称正负号</li>
<li>+-*/%</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：转换失败结果均为 NaN</p>
</blockquote>
<h3 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h3><ul>
<li><p>指的是将其他类型转换为字符串类型</p>
</li>
<li><p>强制转换：</p>
<ul>
<li>数据.toString()</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：null 和 undefined 无法使用 数据.toString() 的方式</p>
</blockquote>
<ul>
<li><p>String(数据)</p>
</li>
<li><p>隐式转换(字符串拼接)：</p>
<ul>
<li>字符串和任意类型进行+操作，最终结果都是字符串<ul>
<li>通常类型转换时使用’’进行操作</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：任何数据类型与字符串相加 都会变成字符串拼接</p>
<p>包括复杂数据类型 array、 object</p>
</blockquote>
<h3 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h3><ul>
<li>转换方式： Boolean(数据)</li>
</ul>
<blockquote>
<p>只需掌握转换结果为 false 的 6 个值即可：</p>
<p>0</p>
<p>NaN</p>
<p>‘’ <code>//空字符串</code></p>
<p>null</p>
<p>undefined</p>
<p>false</p>
</blockquote>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>javaScript-数组</title>
    <url>/js/javaScript-%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li>数组是一个有<strong>顺序</strong>、<strong>有长度</strong>的数据集合；</li>
<li>数组：类型 Object；</li>
<li>特点：<ul>
<li>把数据放在一起；</li>
<li>有先后位置上的顺序；</li>
<li>有数据的长度；</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：数组的 typeof 结果是 object</p>
</blockquote>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 5个人的成绩为： 91，88，72，45，63</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 先声明一个数组，字面量的形式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"null"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 输出 []  这是一个没有数据在里面的数组，称为空数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr, <span class="keyword">typeof</span> arr);</span></pre></td></tr></table></figure>

<h2 id="存值"><a href="#存值" class="headerlink" title="存值"></a>存值</h2><ul>
<li>数组中的数据使用<strong>索引</strong>管理。</li>
<li>索引：<strong>序号、顺序、排位、位置、下标</strong></li>
<li><strong>索引从 0 开始</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//把成绩存储到数组中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">0</span>] = <span class="number">91</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">1</span>] = <span class="number">88</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">2</span>] = <span class="number">72</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">3</span>] = <span class="number">45</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">4</span>] = <span class="number">63</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// 输出 [91,88,72,45,63] 就是一个数据集合</span></span></pre></td></tr></table></figure>

<ul>
<li>把 <code>数组[索引]</code>格式当成一个变量使用就行，</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 初始化赋值完成后，也可以再次改变值，把前面的值覆盖掉；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">0</span>] = <span class="number">100</span>;</span></pre></td></tr></table></figure>

<ul>
<li>如果一开始就知道数组了，可以直接使用一个简单的语法存储数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">91</span>, <span class="number">88</span>, <span class="number">72</span>, <span class="number">45</span>, <span class="number">63</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// 输出的结果是一样的</span></span></pre></td></tr></table></figure>

<ul>
<li>上面每个位置上存的都是数字类型，可以为其他类型；</li>
</ul>
<h2 id="取值"><a href="#取值" class="headerlink" title="取值"></a>取值</h2><ul>
<li>把数据取出来，得知道你要取哪个位置上的数据把。</li>
<li>数据取值同样使用<strong>索引</strong>取。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 拿到索引为0，顺序上第一个位置上的数据；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 把 数组[索引] 格式当成一个变量使用就行；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr[<span class="number">0</span>]);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 数组求和：班里的成绩总和</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = arr[<span class="number">0</span>] + arr[<span class="number">1</span>] + arr[<span class="number">2</span>] + arr[<span class="number">3</span>] + arr[<span class="number">4</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">// 输出370</span></span></pre></td></tr></table></figure>

<h2 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h2><ul>
<li>求成绩总和：一个一个地把数组里面的数组取出来了，从索引 0 到最后一个索引，</li>
<li>索引从 0 开始到结束的过程，<strong>有重复的思想，需要用到循环；</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 最初的写法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = arr[<span class="number">0</span>] + arr[<span class="number">1</span>] + arr[<span class="number">2</span>] + arr[<span class="number">3</span>] + arr[<span class="number">4</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 循环 这个从0~最后一个索引，有重复的思想在里面，使用循环。</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> sum += arr[i];</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">// 输出 370，和我们一个一个相加是一样的</span></span></pre></td></tr></table></figure>

<ul>
<li>使用<strong>循环来遍历</strong>数组，当数组中的数据比较多的时候，会比较方便。<strong>一般是使用 for 循环；</strong></li>
</ul>
<h2 id="数组长度"><a href="#数组长度" class="headerlink" title="数组长度"></a>数组长度</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>存取数据：涉及到就是数组的<strong>顺序</strong>问题，通过索引去存取；</li>
<li>数组长度：数组中一共存放了多少个数据；</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr.length); <span class="comment">// 数组.length 就是数组的长度</span></span></pre></td></tr></table></figure>

<ul>
<li>如果数组的长度是 5，最后一个元素的<strong>索引</strong>就是 4；</li>
<li><strong>我们发现最大索引总是比长度少 1 ，所以遍历还可以这么写</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= arr.length - <span class="number">1</span>; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(arr[i]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 简化一下</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(arr[i]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="案例：求数组中所有数字的总和的平均值"><a href="#案例：求数组中所有数字的总和的平均值" class="headerlink" title="案例：求数组中所有数字的总和的平均值"></a>案例：求数组中所有数字的总和的平均值</h3><ul>
<li>分析：<ul>
<li>总和：循环遍历，加在一个变量上得到；</li>
<li>均值：总和 / 个数；（arr.length）</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 还可以更简单</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> sum += arr[i];</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(sum);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 求平均分</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 平均分= 总分 / 数组的长度</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> avg = sum / arr.length;</span></pre></td></tr></table></figure>

<h3 id="案例：求数组中的最大值"><a href="#案例：求数组中的最大值" class="headerlink" title="案例：求数组中的最大值"></a>案例：求数组中的最大值</h3><ul>
<li>分析：生活中，一堆人最高的（人很多，多到你一下看不出来）；<ul>
<li>最大值：最起码得两个数比较下，得到最大值；</li>
<li>假设：其中随便一个是最大值 MAX，每个元素和 max 比较，<ul>
<li>若有比 MAX 大的，那该元素代替 MAX；</li>
<li>若都没有 MAX 大，恭喜，你一开始就猜对了；</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> max = arr[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">if</span> (max &lt; arr[i]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  max = arr[i];</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<ul>
<li>需求：求数组中的最大值的索引</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 分析：找打最大值的时候，记录下最大值的下标就行了。</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> max_index = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> max = arr[max_index];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">if</span> (max &lt; arr[i]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  max = arr[i];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  max_index = i;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="清空数组"><a href="#清空数组" class="headerlink" title="清空数组"></a>清空数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr.length = <span class="number">0</span>;</span></pre></td></tr></table></figure>

<h2 id="数组的构造函数"><a href="#数组的构造函数" class="headerlink" title="数组的构造函数"></a>数组的构造函数</h2><ul>
<li>数组在 JS 中还可以使用另一种方式创建，这个方式我们称为 ： 构造函数</li>
<li>构造函数：能构造一个你需要的东西（对象）；</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用 构造函数 创建数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 存储数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">0</span>] = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">arr[<span class="number">1</span>] = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>, <span class="number">20</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr);</span></pre></td></tr></table></figure>

<ul>
<li>注意：一个数据，不要使用这个方式存储数据；它会认为你想要设置数组的长度，而不是要把数据存储在数组中。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// 输出 [empty × 10]</span></span></pre></td></tr></table></figure>

<h2 id="JS-实现数组去重（重复的元素只保留一个）"><a href="#JS-实现数组去重（重复的元素只保留一个）" class="headerlink" title="JS 实现数组去重（重复的元素只保留一个）"></a>JS 实现数组去重（重复的元素只保留一个）</h2><p><strong>优化遍历数组法（推荐）</strong></p>
<p>实现思路：双层循环，外循环表示从 0 到 arr.length，内循环表示从 i+1 到 arr.length</p>
<p>将没重复的右边值放入新数组。（检测到有重复值时终止当前循环同时进入外层循环的下一轮判断）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique4</span>(<span class="params">arr</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">var</span> hash = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (arr[i] === arr[j]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ++i;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  hash.push(arr[i]);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> hash;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>javaScript-操作符-分支结构-循环结构</title>
    <url>/js/javaScript-%E6%93%8D%E4%BD%9C%E7%AC%A6-%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84-%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<h2 id="1-操作符"><a href="#1-操作符" class="headerlink" title="1 操作符"></a>1 操作符</h2><h3 id="算术操作符"><a href="#算术操作符" class="headerlink" title="算术操作符"></a>算术操作符</h3><h4 id="自增操作符、自减操作符"><a href="#自增操作符、自减操作符" class="headerlink" title="自增操作符、自减操作符"></a>自增操作符、自减操作符</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ++ --</span></span></pre></td></tr></table></figure>

<blockquote>
<p>需要注意的是后++和后–，在和其他算术运算符一起操作时 是先原值操作在下次操作在再自身加减</p>
<p>口诀：</p>
<ul>
<li>++放在变量<strong>前面</strong>，什么时候计算++？先算++，在算整个运算；</li>
<li>++放在变量后面，什么时候计算++？先算整个运算，再算++；</li>
</ul>
</blockquote>
<a id="more"></a>

<h4 id><a href="#" class="headerlink" title="+ - * / %"></a>+ - * / %</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.常规操作：Number类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = 10;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var b = 3;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// + - / * %</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var c = a + b;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 10对3取余数；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var c = 10 % 3;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(c);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 2.非常规：字符串、Boolean、null、undefined；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串 遇见 +，把左右的数据类型 转化为字符串</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串 + 字符串 ：字符串拼接；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = 10 + "10";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = true + "10";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a, typeof a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 运算：从左到右运算；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = 10 + 10 + "10";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 只要字符串不是遇见+，遇见-*/% ，字符串会 隐式 转化 Number类型；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = 10 - "10";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a, typeof a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = 10 - "我";</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a, typeof a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 2.其他(排出string类型外)：true null undefined</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 隐式转化：转为数字类型；</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 输出 10</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = false + 10;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 输出 10</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = null + 10;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 输出 NaN</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// var a = undefined + 10;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// console.log(a);</span></span></pre></td></tr></table></figure>

<h3 id="比较操作符"><a href="#比较操作符" class="headerlink" title="比较操作符"></a>比较操作符</h3><p>比较操作符的就是比较两个数据，操作符号有:</p>
<p><code>&gt; &lt; &gt;= &lt;=</code> 运算结果是 布尔 类型</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">!= 和!== 是比较两个数据是否不相等的    !== 同时比较值和类型</span></pre></td></tr><tr><td class="code"><pre><span class="line">== 和 === 是用来比较两个数据是否相等的   === 不仅比较两个数据的值，还比较数据的类型</span></pre></td></tr></table></figure>

<h3 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h3><h4 id="逻辑与-amp-amp"><a href="#逻辑与-amp-amp" class="headerlink" title="逻辑与&amp;&amp;"></a>逻辑与&amp;&amp;</h4><ul>
<li>两个条件都为 true 结果为 true 否者为 false</li>
<li>逻辑短路：当第一个值为 false 将不再判断第二个值 直接返回第一个值</li>
</ul>
<h4 id="逻辑或"><a href="#逻辑或" class="headerlink" title="逻辑或 ||"></a>逻辑或 ||</h4><ul>
<li>只要有一个条件为 true 结果为 true，两个都是 false 才是 false</li>
<li>逻辑短路：当第一个值为 true 将不再判断第二个值 直接返回第一个值</li>
</ul>
<h4 id="逻辑非"><a href="#逻辑非" class="headerlink" title="逻辑非"></a>逻辑非</h4><ul>
<li>把 true 变 false 把 false 变 true</li>
</ul>
<blockquote>
<p>注意：逻辑非的优先级 仅次于（） 和 [ ] 与 前两个逻辑操作符一起用的时候需要注意</p>
</blockquote>
<h3 id="赋值操作符"><a href="#赋值操作符" class="headerlink" title="赋值操作符"></a>赋值操作符</h3><h4 id="-1"><a href="#-1" class="headerlink" title="= += -= *= /= %="></a>= += -= *= /= %=</h4><ul>
<li>+= 的作用是简写加法 a += 2; // 相当于是 a = a + 2; 就是一个简写的语法</li>
<li>-= *= /= %= 除了运算规则不同，作用是一样的，都是简写</li>
</ul>
<h3 id="操作的优先级"><a href="#操作的优先级" class="headerlink" title="操作的优先级"></a>操作的优先级</h3><ol>
<li>第一优先级： [] . ()</li>
<li>第二优先级： ++ – !</li>
<li>第三优先级： * / %</li>
<li>第四优先级： + -</li>
<li>第五优先级： &gt; &gt;= &lt; &lt;=</li>
<li>第六优先级： == != === !==</li>
<li>第七优先级： &amp;&amp;</li>
<li>第八优先级： ||</li>
<li>第九优先级： = += -= *= /= %=</li>
</ol>
<p>上面是具体的优先级，但是平时我们不会把很多的操作符放在一起运算，所以我们大致记住</p>
<ol>
<li>括号先算</li>
<li>其次算算术</li>
<li>再次算比较</li>
<li>然后算逻辑</li>
<li>最后算赋值</li>
</ol>
<h2 id="2-流程控制-三个名词"><a href="#2-流程控制-三个名词" class="headerlink" title="2 流程控制-三个名词"></a>2 流程控制-三个名词</h2><ul>
<li>表达式：有返回结果；<strong>在浏览器后台可以直接敲表达式，回车返回的就是该表达式的结果；</strong></li>
<li>语句：有思考在里面的表达式；思考主要是告诉浏览器要做什么事情；</li>
</ul>
<ul>
<li><p>结构：</p>
<ul>
<li>顺序结构：从上到下执行的代码就是顺序结构 程序默认就是由上到下顺序执行的</li>
</ul>
<ul>
<li>分支：<strong>不同的情况，走不同的分支 ；</strong></li>
<li>循环结构：要求一个流程要有<strong>重复的思想</strong>在里面；</li>
</ul>
</li>
</ul>
<h2 id="3-分支结构（重要）"><a href="#3-分支结构（重要）" class="headerlink" title="3 分支结构（重要）"></a>3 分支结构（重要）</h2><p>这就使用到了分支结构，分支结构分为三个大类</p>
<ul>
<li>if 结构</li>
<li>switch-case 结构</li>
<li>三元表达式</li>
</ul>
<h3 id="if-结构-（常用）"><a href="#if-结构-（常用）" class="headerlink" title="if 结构 （常用）"></a>if 结构 （常用）</h3><p>单个 if 结构：解决的一个分支的判断问题</p>
<p>if-else： if-else 结构，解决两个分支的判断问题</p>
<p>if-else-if：if-else-if 结构，解决多分支的判断问题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(条件表达式<span class="number">1</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   当条件表达式<span class="number">1</span>的结果是 <span class="literal">true</span> 时执行的代码</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(条件表达式<span class="number">2</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  当条件表达式<span class="number">2</span>的结果是 <span class="literal">true</span> 时执行的代码</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(条件表达式<span class="number">3</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  当条件表达式<span class="number">3</span>的结果是 <span class="literal">true</span> 时执行的代码</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 中间可以继续写多个判断</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  多个条件表达式的结果都是 <span class="literal">false</span> 的时候执行的代码</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//例如: 判断一下一个人的性别是不是男的,如果是男的，让他去男厕所，如果是女的，让他去女厕所 ， 否则不让他上厕所</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gender = prompt(<span class="string">'请输入性别'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(gender === <span class="string">'男'</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="string">'请去男厕所'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(gender === <span class="string">'女'</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">'请去女厕所'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;<span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">'你个不男不女的家伙，我们这里没有你能上的厕所，去别处吧'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>注意：在 if-else-if 连着多个判断时 最终只会进到一个分支中</p>
</blockquote>
<h3 id="switch-case-结构"><a href="#switch-case-结构" class="headerlink" title="switch-case 结构"></a>switch-case 结构</h3><p>switch-case 结构主要用于多个固定值之间的判断</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//例如： 判断一下一个人的性别是不是男的,如果是男的，让他去男厕所，如果是女的，让他去女厕所 ，如果是人妖，去人妖专用厕所，如果都不是，打晕送走</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gender = prompt(<span class="string">"请输入性别"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (gender) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">case</span> <span class="string">"男"</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"请去男厕所"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">case</span> <span class="string">"女"</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"请去女厕所"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">case</span> <span class="string">"人妖"</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"请去人妖专用厕所"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">default</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"净给我添乱，打晕送走"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>值得注意的是：这个结构里面的 break 并不是必须的，如果两个 case 之间没有 break ，执行完了一个 break 之后，会继续执行下面的 case 的代码</p>
</blockquote>
<h3 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h3><p>三元表达式的使用是简写 if-else 结构 属于表达式</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">表达式<span class="number">1</span> ? 表达式<span class="number">2</span> : 表达式<span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 这个表达式会先执行表达式1，判断其结果是true还是false，如果是true，则执行表达式2，</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//然后将表达式2的执行结果作为整个三元表达式的结果，如果表达式1的结果是false，则执行表达式3，</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//并表达式3的结果作为整个三元表达式的结果</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//例如： 求二个数字中谁更大</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> b = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> max = a &gt; b ? a : b;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(max);</span></pre></td></tr></table></figure>

<blockquote>
<p>总结</p>
<p>1.在我们需要判断的时候，就可以使用分支结构</p>
<p>2.if 判断用法很多，switch-case 却只能判断固定值</p>
<p>3.三元表达式就是 if-else 的简写，将来可以把代码写得更简洁</p>
</blockquote>
<h2 id="4-循环结构（重要）"><a href="#4-循环结构（重要）" class="headerlink" title="4 循环结构（重要）"></a>4 循环结构（重要）</h2><h3 id="for-循环-常用"><a href="#for-循环-常用" class="headerlink" title="for 循环(常用)"></a>for 循环(常用)</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (初始化表达式; 条件表达式; 自增表达式) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> 循环体;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//初始化表达式只是开始用到 后期反复执行。。。条件--&gt;循环体--&gt;自增--&gt;条件。。。。。</span></span></pre></td></tr></table></figure>

<p>执行过程：</p>
<ol>
<li>执行初始化表达式</li>
<li>执行条件表达式</li>
<li>如果条件表达式的结果为 false,结束循环，继续执行循环后面的代码</li>
<li>如果条件表达式的结果为 true，执行循环体</li>
<li>执行自增表达式</li>
<li>重复 2~5 的步骤，直到条件表达式的结果为 false，结束循环</li>
</ol>
<h3 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (条件表达式) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> 循环体;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 循环体就是重复执行的代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//可以做无限循环（true）就可以实现</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//需要结束时加break</span></span></pre></td></tr></table></figure>

<p>执行过程：</p>
<ol>
<li>先执行条件表达式，得到一个布尔类型的结果</li>
<li>如果表达式的结果为 false,循环结束，执行循环后面的代码</li>
<li>如果表达式的结果为 true，执行循环体</li>
<li>执行条件表达式，得到一个布尔类型的结果</li>
<li>重复 2~4 的过程，直到表达式结果为 false，结束循环</li>
</ol>
<h3 id="do-while-循环-补充"><a href="#do-while-循环-补充" class="headerlink" title="do-while 循环(补充)"></a>do-while 循环(补充)</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> 循环体;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">while</span> (条件表达式);</span></pre></td></tr></table></figure>

<p>执行过程</p>
<ol>
<li>先执行循环体</li>
<li>执行条件表达式</li>
<li>如果条件表达式结果为 false，结束循环</li>
<li>如果条件表达式结果为 true，执行循环体</li>
<li>重复 2~4 的步骤，直到条件表达式结果为 false，结束循环</li>
</ol>
<h3 id="break-和-continue"><a href="#break-和-continue" class="headerlink" title="break 和 continue"></a>break 和 continue</h3><ol>
<li>break 用于结束整个循环</li>
<li>continue 用于结束整个循环中的一次</li>
<li>break 和 continue 后面的代码都不会执行</li>
</ol>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>js中的微观任务和宏观任务</title>
    <url>/js/js%E4%B8%AD%E7%9A%84%E5%BE%AE%E8%A7%82%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%AE%8F%E8%A7%82%E4%BB%BB%E5%8A%A1/</url>
    <content><![CDATA[<h1 id="js中的微观任务和宏观任务"><a href="#js中的微观任务和宏观任务" class="headerlink" title="js中的微观任务和宏观任务"></a>js中的微观任务和宏观任务</h1><blockquote>
<p>首先js是单线程的,代码执行都在执行栈中，io接口事件和dom事件都放在任务队列中，等到执行栈执行完毕再去任务队列中看有没有可执行的任务，这称之为事件循环</p>
</blockquote>
<a id="more"></a>
<p>事件循环示意</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/bg2014100802.png" alt="bg2014100802"></p>
<h3 id="注意点1"><a href="#注意点1" class="headerlink" title="注意点1"></a>注意点1</h3><p>微观任务都是放在执行栈的最后来执行，还是在本轮事件循环中</p>
<p>宏观任务都是放在任务队列中执行，不在本轮事件循环之中</p>
<h3 id="注意点2"><a href="#注意点2" class="headerlink" title="注意点2"></a>注意点2</h3><p>asycn  的 await 下面的代码相当于都在promise的then里面都是本轮事件循环的最末执行，也就是说await下面的代码在等待await期间会被放到栈尾，而执行asnyc 函数下的代码</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E5%BE%AE%E8%A7%82%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%AE%8F%E8%A7%82%E4%BB%BB%E5%8A%A1.png" alt="微观任务和宏观任务"></p>
<p>总结：遇到setimeout 就放一边 ，遇到setImmediate也放 一边，遇到promise或者nextTick就放到本轮最后，等到本轮执行结束去找可以执行的settimeout或<strong>setImmediate</strong></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>picgo + typroa + github 实现自动上传图床</title>
    <url>/typora/picgo-typora-github-%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E4%B8%8A%E4%BC%A0%E5%9B%BE%E5%BA%8A/</url>
    <content><![CDATA[<h2 id="typora结合PicGo设置github图床"><a href="#typora结合PicGo设置github图床" class="headerlink" title="typora结合PicGo设置github图床"></a>typora结合PicGo设置github图床</h2><p> 详细教程：<a href="https://blog.csdn.net/beichuchuanyue/article/details/105493948" target="_blank" rel="noopener">https://blog.csdn.net/beichuchuanyue/article/details/105493948</a></p>
<blockquote>
<p>最近一直在用 ubuntu 所以直接使用 picgo-core （命令行） 实现上传图片 </p>
</blockquote>
<h2 id="picgo-core-配置文件"><a href="#picgo-core-配置文件" class="headerlink" title="picgo-core 配置文件"></a>picgo-core 配置文件</h2><blockquote>
<p>如果配置好了picgo app 直接把iconfig 粘进来就行</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"picBed"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"current"</span>: <span class="string">"github"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"github"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"branch"</span>: <span class="string">"分支"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"customUrl"</span>: <span class="string">"https://raw.githubusercontent.com/用户名/仓库/分支"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"path"</span>: <span class="string">"img/"</span>, <span class="comment">//具体文件夹</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"repo"</span>: <span class="string">"zhangbowen-github/my-gallery"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"token"</span>: <span class="string">"5fcc67787af3d565841804d347043720e5d6fdf2"</span> <span class="comment">//Settings -&gt; Developer settings -&gt; Personal access tokens-&gt;创建 全选</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"uploader"</span>: <span class="string">"github"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"settings"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"shortKey"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"picgo:upload"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">"enable"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">"key"</span>: <span class="string">"CommandOrControl+Shift+P"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">"name"</span>: <span class="string">"upload"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">"label"</span>: <span class="string">"快捷上传"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"server"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"enable"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"host"</span>: <span class="string">"127.0.0.1"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attr">"port"</span>: <span class="number">36677</span>  <span class="comment">//端口号不要改</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"showUpdateTip"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"pasteStyle"</span>: <span class="string">"markdown"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"autoRename"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"rename"</span>: <span class="literal">false</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"autoStart"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"miniWindowOntop"</span>: <span class="literal">false</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">"checkBetaUpdate"</span>: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"picgoPlugins"</span>: &#123;&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"debug"</span>: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"PICGO_ENV"</span>: <span class="string">"GUI"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">"needReload"</span>: <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>注意上传同名图片会导致失败</p>
</blockquote>
<p>常见报错：<a href="https://blog.csdn.net/qq754772661/article/details/111385955" target="_blank" rel="noopener">https://blog.csdn.net/qq754772661/article/details/111385955</a></p>
]]></content>
      <categories>
        <category>typora</category>
      </categories>
      <tags>
        <tag>picgo</tag>
        <tag>typora</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>postman 深入使用</title>
    <url>/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/postman%E6%B7%B1%E5%85%A5%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h2 id="设置变量-用于地址拼接"><a href="#设置变量-用于地址拼接" class="headerlink" title="设置变量 用于地址拼接"></a>设置变量 用于地址拼接</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574931493737.png" alt="1574931493737"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用时跟插值表达式一样用&#123;&#123; &#125;&#125; 包裹 注意 /的拼接</span></span></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574932590726.png" alt="1574932590726"></p>
<h2 id="拦截器：统一设置-token"><a href="#拦截器：统一设置-token" class="headerlink" title="拦截器：统一设置 token"></a>拦截器：统一设置 token</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574932641632.png" alt="1574932641632"></p>
<h2 id="导出自己的项目"><a href="#导出自己的项目" class="headerlink" title="导出自己的项目"></a>导出自己的项目</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1574932698478.png" alt="1574932698478"></p>
]]></content>
      <categories>
        <category>工具使用</category>
      </categories>
      <tags>
        <tag>工具使用</tag>
      </tags>
  </entry>
  <entry>
    <title>switch 多个case的用法</title>
    <url>/js/switch-%E5%A4%9A%E4%B8%AAcase%E7%9A%84%E7%94%A8%E6%B3%95/</url>
    <content><![CDATA[<p>switch中想要多个判断都进到一个分支中可以这样写</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">switch</span> (item) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">1</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">2</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">3</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">4</span>: <span class="comment">//以上case都执行这个分支</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(<span class="string">"进到1,2,3,4里"</span>, item);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">5</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">case</span> <span class="number">6</span>: </span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(<span class="string">"进到5,6里"</span>, item);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">default</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到1,2,3,4里 1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到1,2,3,4里 2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到1,2,3,4里 3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到1,2,3,4里 4</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到5,6里 5</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//进到5,6里 6</span></span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>ubuntu下常用软件的安装</title>
    <url>/Linux/ubuntu%E4%B8%8B%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<h2 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h2><p>官方：<a href="https://git-scm.com/download/linux" target="_blank" rel="noopener">https://git-scm.com/download/linux</a></p>
<h2 id="安装搜狗拼音"><a href="#安装搜狗拼音" class="headerlink" title="安装搜狗拼音"></a>安装搜狗拼音</h2><p>官方：<a href="https://pinyin.sogou.com/linux/" target="_blank" rel="noopener">https://pinyin.sogou.com/linux/</a>  ，<a href="https://pinyin.sogou.com/linux/help.php" target="_blank" rel="noopener">https://pinyin.sogou.com/linux/help.php</a></p>
<h2 id="qq"><a href="#qq" class="headerlink" title="qq"></a>qq</h2><p>官方：<a href="https://im.qq.com/linuxqq/download.html" target="_blank" rel="noopener">https://im.qq.com/linuxqq/download.html</a></p>
<h3 id="百度网盘"><a href="#百度网盘" class="headerlink" title="百度网盘"></a>百度网盘</h3><p>官方：<a href="https://pan.baidu.com/download" target="_blank" rel="noopener">https://pan.baidu.com/download</a></p>
<h2 id="微信网页可用版本"><a href="#微信网页可用版本" class="headerlink" title="微信网页可用版本"></a>微信网页可用版本</h2><p><a href="https://dcstore.spark-app.store/store/chat/wechat-linux-spark/" target="_blank" rel="noopener">https://dcstore.spark-app.store/store/chat/wechat-linux-spark/</a></p>
<h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><p>安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nginx</span></pre></td></tr></table></figure>

<p>查看nginx是否安装成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nginx -v</span></pre></td></tr></table></figure>

<p>启动nginx</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service nginx start</span></pre></td></tr></table></figure>

<p>关闭</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service nginx stop</span></pre></td></tr></table></figure>

<p>详细教程：<a href="https://blog.csdn.net/qq_23832313/article/details/83578836" target="_blank" rel="noopener">https://blog.csdn.net/qq_23832313/article/details/83578836</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>treer生成文件结构目录</title>
    <url>/js/treer%E7%94%9F%E6%88%90%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E7%9B%AE%E5%BD%95/</url>
    <content><![CDATA[<p>参考资料：<a href="https://blog.csdn.net/weixin_43998681/article/details/88708847" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43998681/article/details/88708847</a></p>
<blockquote>
<p>tip :  treer 生成的机构目录是按大小写倒序生成 ，看起来会怪怪的  可以使用git bash tree 命令生成 好看正序的</p>
</blockquote>
<h2 id="treer"><a href="#treer" class="headerlink" title="treer"></a>treer</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install treer -g													</span></pre></td></tr><tr><td class="code"><pre><span class="line">// 全局安装treer，如果只想安装在当前目录可以去掉-g</span></pre></td></tr></table></figure>

<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ treer --<span class="built_in">help</span> 					//输出treer的使用帮助信息</span></pre></td></tr><tr><td class="code"><pre><span class="line">选项:</span></pre></td></tr><tr><td class="code"><pre><span class="line">-V, --version          			//输出版本号信息</span></pre></td></tr><tr><td class="code"><pre><span class="line">-d, --directory [dir]  			//指定一个目录来生成目录树</span></pre></td></tr><tr><td class="code"><pre><span class="line">-i, --ignore [ig]      			//忽略特定的目录名</span></pre></td></tr><tr><td class="code"><pre><span class="line">-e, --<span class="built_in">export</span> [epath]   			//导出目录到一个文件中</span></pre></td></tr></table></figure>

<h3 id="具体示例"><a href="#具体示例" class="headerlink" title="具体示例"></a>具体示例</h3><p>输出到tree.md</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">treer -i <span class="string">"/node_modules|dist_electron|devtools|nouse|.git|.vscode/"</span> -e <span class="string">"tree.md"</span></span></pre></td></tr></table></figure>

<h2 id="使用git-bash-tree-命令"><a href="#使用git-bash-tree-命令" class="headerlink" title="使用git bash tree 命令"></a>使用git bash tree 命令</h2><p>git 中默认不带 tree 命令 需要下载 <code>tree.exe</code> 并将其复制到 <code>/git/usr/bin</code> 目录下,这样 <code>git bash</code> 本身就支持 <code>tree</code> 命令了.</p>
<p>下载地址： <a href="https://github.com/zruibin/tree/blob/master/tree.exe" target="_blank" rel="noopener">https://github.com/zruibin/tree/blob/master/tree.exe</a></p>
<h3 id="使用方法-1"><a href="#使用方法-1" class="headerlink" title="使用方法"></a>使用方法</h3><p>输出到tree.md</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ tree -I  <span class="string">"node_modules|devtools|dist_electron|public|nouse"</span>  &gt; tree.md</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>vscode设置文件以何种方式高亮解析</title>
    <url>/vscode/vscode%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%A5%E4%BD%95%E7%A7%8D%E6%96%B9%E5%BC%8F%E9%AB%98%E4%BA%AE%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<blockquote>
<p>在实际工作中有时需要用到只定义文件后缀 ， 我最近遇到的项目需要定义.rule 文件 ，但语法类似javascript，文件编辑起来很费劲，因为不带高亮和语法提示，每次修改文件后缀也麻烦 ，我需要的是.rule 文件，以jjavascript的方式让vscode解析提示和高亮；</p>
</blockquote>
<h2 id="修改设置"><a href="#修改设置" class="headerlink" title="修改设置"></a>修改设置</h2><p>首选项 -&gt; 设置 -&gt;文本编辑器 -&gt;文件</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201224095242258.png" alt="image-20201224095242258"></p>
<p>修改保存即可 ，语言要写全名 像<code>javascript</code>不要写成<code>js</code></p>
<p>也可以直接编辑setting</p>
<h2 id="setting-修改"><a href="#setting-修改" class="headerlink" title="setting 修改"></a>setting 修改</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201224095505868.png" alt="image-20201224095505868"></p>
<p>json中添加</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"files.associations": &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  "*.rule": "javascript"</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>vscode</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>vuetify自定义过度动画createSimpleTransition的使用实现左右抽屉效果</title>
    <url>/vue/vuetify%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E5%BA%A6%E5%8A%A8%E7%94%BBcreateSimpleTransition%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<blockquote>
<p>因为vuetify中dailog只有上下抽屉的效果，想要左右抽屉效果 于是自己写了一个左右抽屉的组件 其中比较难搞的还是样式 和过渡</p>
<p>vuetify中创建过渡组件的方式：<a href="https://vuetifyjs.com/zh-Hans/styles/transitions/#todo-list" target="_blank" rel="noopener">https://vuetifyjs.com/zh-Hans/styles/transitions/#todo-list</a></p>
</blockquote>
<p>实现效果：</p>
<a id="more"></a>

<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/vuetfiy%E6%8A%BD%E5%B1%89%E6%95%88%E6%9E%9C.gif" alt="vuetfiy抽屉效果"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;v-dialog</span></pre></td></tr><tr><td class="code"><pre><span class="line">    class&#x3D;&quot;slide-drawer&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    content-class&#x3D;&quot;my-slide-drawer&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    :value&#x3D;&quot;value&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    @input&#x3D;&quot;val &#x3D;&gt; $emit(&#39;input&#39;, val)&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    scrollable</span></pre></td></tr><tr><td class="code"><pre><span class="line">    width&#x3D;&quot;600px&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    v-bind&#x3D;&quot;$attrs&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    v-on&#x3D;&quot;$listeners&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    transition&#x3D;&quot;my-transition&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    origin&#x3D;&quot;0px 0px&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;v-card&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-card-title&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;v-btn icon @click&#x3D;&quot;$emit(&#39;input&#39;, false)&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &lt;v-icon&gt;mdi-close&lt;&#x2F;v-icon&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;&#x2F;v-btn&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;v-card-title&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-divider&gt;&lt;&#x2F;v-divider&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-card-text&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;div v-html&#x3D;&quot;content&quot;&gt;&lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;v-card-text&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;v-card&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;&#x2F;v-dialog&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 导入创建组件方法</span></pre></td></tr><tr><td class="code"><pre><span class="line">import &#123; createSimpleTransition &#125; from &quot;vuetify&#x2F;lib&#x2F;components&#x2F;transitions&#x2F;createTransition&quot;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 创建 my-transition 过渡组件  这个组件在模板中的transition属性使用</span></pre></td></tr><tr><td class="code"><pre><span class="line">const myTransition &#x3D; createSimpleTransition(&quot;my-transition&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 注册组件</span></pre></td></tr><tr><td class="code"><pre><span class="line">import Vue from &quot;vue&quot;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Vue.component(&quot;my-transition&quot;, myTransition);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; import Dialog from &quot;@&#x2F;components&#x2F;common&#x2F;dialog&quot;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">export default &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: &quot;HistoryInfoDrawer&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  components: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#x2F;&#x2F; Dialog</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    value: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type: Boolean,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      defualt: false</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    content: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type: String,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      defualt: &quot;&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.v-dialog__content &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#x2F;&#x2F; 改变dialog布局 靠右</span></pre></td></tr><tr><td class="code"><pre><span class="line">  justify-content: start !important;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">::v-deep &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  .my-slide-drawer &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    border-radius: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    margin: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    max-height: 100% !important;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    .v-sheet.v-card &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      border-radius: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#x2F;&#x2F; 添加侧面抽屉效果</span></pre></td></tr><tr><td class="code"><pre><span class="line">    .my-transition &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#x2F;&#x2F; 进入和离开的状态</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &amp;-enter,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &amp;-leave-to &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        transform: translateX(-800px);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">或者&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style lang&#x3D;&quot;scss&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 添加侧面抽屉效果</span></pre></td></tr><tr><td class="code"><pre><span class="line">.my-transition &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &amp;-enter,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &amp;-leave-to &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    transform: translateX(-800px);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure>

<blockquote>
<p>注意事项：样式不能在 scoped 中要不不会生效 或者放到 ::v-deep 中</p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vuetify</tag>
      </tags>
  </entry>
  <entry>
    <title>vue + vuetify + electron 实现ctrl+f的搜索功能</title>
    <url>/vue/vue-vuetify-electron-%E5%AE%9E%E7%8E%B0ctrl-f%E7%9A%84%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<blockquote>
<p>因为在electron 中没有找到ctrl+f 调用浏览器搜索的方法 于是借鉴文章自己撸了一个搜索组件</p>
</blockquote>
<p>借鉴文章地址：<a href="https://www.jb51.net/article/181616.htm" target="_blank" rel="noopener">https://www.jb51.net/article/181616.htm</a></p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E5%AE%9E%E7%8E%B0ctrl+f%E7%9A%84%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD.gif" alt="实现ctrl+f的搜索功能"></p>
<a id="more"></a>

<p>模板部分</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;v-card class&#x3D;&quot;history-info-drawer&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!-- 头部操作栏 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;v-toolbar dense dark color&#x3D;&quot;primary&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;!-- input --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;v-text-field</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type&#x3D;&quot;text&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      hide-details</span></pre></td></tr><tr><td class="code"><pre><span class="line">      prepend-icon&#x3D;&quot;mdi-magnify&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      single-line</span></pre></td></tr><tr><td class="code"><pre><span class="line">      clearable</span></pre></td></tr><tr><td class="code"><pre><span class="line">      placeholder&#x3D;&quot;请输入要搜索的字符串 回车进行定位&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      v-model&#x3D;&quot;searchStr&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      @keyup.enter&#x3D;&quot;e &#x3D;&gt; submit()&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &gt;&lt;&#x2F;v-text-field&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;!-- 上下按钮 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;v-btn icon @click&#x3D;&quot;submit(&#39;up&#39;)&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-icon&gt;mdi-chevron-up&lt;&#x2F;v-icon&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;v-btn&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;v-btn icon @click&#x3D;&quot;submit(&#39;down&#39;)&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-icon&gt;mdi-chevron-down&lt;&#x2F;v-icon&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;v-btn&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;!-- 关闭按钮 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;v-btn icon @click&#x3D;&quot;$emit(&#39;input&#39;, false)&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;v-icon&gt;mdi-close&lt;&#x2F;v-icon&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;v-btn&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;&#x2F;v-toolbar&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;!-- 内容显示区域 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;v-card-text&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;div v-html&#x3D;&quot;transitionContent&quot; class&#x3D;&quot;history-info-content&quot;&gt;&lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;&#x2F;v-card-text&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;v-card&gt;</span></pre></td></tr></table></figure>

<p>逻辑部分</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: <span class="string">"HistoryInfoDrawer"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 传入的内容字符串</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    content: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type: <span class="built_in">String</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      defualt: <span class="string">""</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  data() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">//搜索内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      searchStr: <span class="string">""</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 搜索定位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      currentPosition: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 经过转换的展示内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      transitionContent: <span class="string">""</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 当前搜索字符串是否是首次定位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      firstPosition: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  methods: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    handleTransitionContent(searchStr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">//获取动态变化的搜索词</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">if</span> (searchStr !== <span class="string">""</span> &amp;&amp; searchStr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 将特殊符号转义</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> searchRegExp = searchStr.replace(<span class="regexp">/(\.|\+|\?|\*)/g</span>, <span class="string">"\\$1"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//若搜索词不为空，对搜索词进行替换 背景颜色变黄色</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.content</span></pre></td></tr><tr><td class="code"><pre><span class="line">          .replace(</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">new</span> <span class="built_in">RegExp</span>(searchRegExp, <span class="string">"g"</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="string">'&lt;a style="background-color: yellow;"  &gt;'</span> + searchStr + <span class="string">"&lt;/a&gt;"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          )</span></pre></td></tr><tr><td class="code"><pre><span class="line">          .replace(<span class="regexp">/\n/g</span>, <span class="string">"&lt;/br&gt;"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.content.replace(<span class="regexp">/\n/g</span>, <span class="string">"&lt;/br&gt;"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 定位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    handlePosition(flag = <span class="string">"down"</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 容器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">const</span> container = <span class="built_in">document</span>.querySelector(<span class="string">".history-info-content"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 获取所有a</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">let</span> alist = container.getElementsByTagName(<span class="string">"a"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">let</span> aListLength = alist.length;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 首次搜索不执行定位的增减</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.firstPosition) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        flag = <span class="string">""</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">switch</span> (flag) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">"down"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">//定位+1，走满一圈归0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.currentPosition &lt; aListLength - <span class="number">1</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.currentPosition += <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.currentPosition == aListLength - <span class="number">1</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.currentPosition = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">//定位-1，走满一圈归最后一位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">case</span> <span class="string">"up"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.currentPosition &gt; <span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.currentPosition -= <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.currentPosition == <span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.currentPosition = aListLength - <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">default</span>:</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="built_in">console</span>.log(<span class="string">"Bowen: change "</span>, <span class="keyword">this</span>.currentPosition);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">if</span> (aListLength != <span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 当前的定位元素的背景颜色变红</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> a <span class="keyword">of</span> alist) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          a.style.backgroundColor = <span class="string">"yellow"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">let</span> currentA = alist[<span class="keyword">this</span>.currentPosition];</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Bowen: handlePosition -&gt; currentA"</span>, currentA);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        currentA &amp;&amp; (currentA.style.backgroundColor = <span class="string">"red"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 滚动到当前元素</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        currentA.scrollIntoView(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          behavior: <span class="string">"smooth"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          block: <span class="string">"center"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          inline: <span class="string">"nearest"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.firstPosition = <span class="literal">false</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  watch: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    searchStr(searchStr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 输入改变定位清零</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.currentPosition = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 赋值转化后的字符串</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.transitionContent = <span class="keyword">this</span>.handleTransitionContent(searchStr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 设置为首次定位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">this</span>.firstPosition = <span class="literal">true</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  mounted() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 首次先赋值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.transitionContent = <span class="keyword">this</span>.handleTransitionContent(<span class="string">""</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<blockquote>
<p>组件使用的是vuetify ，主要可以看逻辑部分  element 等组件的用法大同小异</p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vuetify</tag>
        <tag>electron</tag>
      </tags>
  </entry>
  <entry>
    <title>vue 移动端采坑</title>
    <url>/vue/vue%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%87%87%E5%9D%91/</url>
    <content><![CDATA[<h2 id="1-报错"><a href="#1-报错" class="headerlink" title="1.报错"></a>1.报错</h2><h3 id="组件没注册报错"><a href="#组件没注册报错" class="headerlink" title="组件没注册报错"></a>组件没注册报错</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">vue.esm.js?efeb:<span class="number">591</span> [Vue warn]: Unknown custom element: <span class="xml"><span class="tag">&lt;<span class="name">el-container</span>&gt;</span> - did you register the component correctly? For recursive components, make sure to provide the "name" option.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="xml">found in</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">---&gt; &lt;Container&gt; at src/components/Container.vue</span></pre></td></tr><tr><td class="code"><pre><span class="line">       &lt;App&gt; at src/App.vue</span></pre></td></tr><tr><td class="code"><pre><span class="line">         &lt;Root&gt;</span></pre></td></tr></table></figure>

<p><strong>以上错误 表示你没有注册这个组件 需要单独注册</strong></p>
<h3 id="JSON-parse-的使用"><a href="#JSON-parse-的使用" class="headerlink" title="JSON.parse()的使用"></a><code>JSON.parse()</code>的使用</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20191201171855.jpg" alt="搜狗截图20191201171855"></p>
<blockquote>
<p>注意：<strong><code>JSON.parse(null)</code> 是返回 null 其他除了 string 类型的数据都会报错</strong></p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack注意事项</title>
    <url>/webpack/webpack%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
    <content><![CDATA[<h2 id="html-webpack-plugin-报错"><a href="#html-webpack-plugin-报错" class="headerlink" title="html-webpack-plugin 报错"></a>html-webpack-plugin 报错</h2><h3 id="Error-The-loader-didn’t-return-html"><a href="#Error-The-loader-didn’t-return-html" class="headerlink" title="Error: The loader didn’t return html"></a>Error: The loader didn’t return html</h3><p>报错原因：[Webpack v5.22.0`破坏了HTMLWebpackLoader ](<a href="https://github.com/jantimon/html-webpack-plugin/issues/1603" target="_blank" rel="noopener">https://github.com/jantimon/html-webpack-plugin/issues/1603</a>)</p>
<p>解决方案： package.json 中 html-webpack-plugin 版本号是<code>&quot;^4.5.0&quot;</code>  直接更新至<code>5.1.0</code></p>
<h3 id="Error-Automatic-publicPath-is-not-supported-in-this-browser"><a href="#Error-Automatic-publicPath-is-not-supported-in-this-browser" class="headerlink" title="Error: Automatic publicPath is not supported in this browser"></a>Error: Automatic publicPath is not supported in this browser</h3><p>设置 webpack.config.js 中 output 中 publicPath: ‘’  为空字符串</p>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>webpack-cli</tag>
      </tags>
  </entry>
  <entry>
    <title>yarn 和 npm</title>
    <url>/npm/yarn%E5%92%8Cnpm/</url>
    <content><![CDATA[<h2 id="关于-npm-和-yarn"><a href="#关于-npm-和-yarn" class="headerlink" title="关于 npm 和 yarn"></a>关于 npm 和 yarn</h2><p>npm 和 yarn 都是管理第三方包的。</p>
<p>yarn 相比 npm 稍微快一些。</p>
<p>下面是 npm 和 yarn 常用命令对照表：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># yarn init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm init</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn add 包名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install 包名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn install 或者直接 yarn</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn add -D 包名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install -D 包名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn remove 包名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm uninstall 包名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn global add 包名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install --global 包名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># yarn global remove 包名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm uninstall --global 包名</span></pre></td></tr></table></figure>

<a id="more"></a>

<p>在一个项目中，使用哪个包管理工具那你就自始至终都使用这个工具，千万不要混用，否则会导致文件丢失。</p>
<p>如果你想切换项目使用的包管理工具或者你因为混用包管理工具导致项目的模块丢失报错了，使用下面的方式解决：</p>
<p>1、删除 node_modules</p>
<p>2、使用你要使用的包管理工具把所有依赖重新安装一遍</p>
<ul>
<li>如果是 yarn 就直接执行 <code>yarn</code> 或者 <code>yarn install</code></li>
<li>如果 npm 就执行 <code>npm install</code></li>
</ul>
<p>3、之后都使用你切换之后的包管理工具进行装包</p>
<h2 id="补充：关于-VueCLI-创建项目使用的包管理器"><a href="#补充：关于-VueCLI-创建项目使用的包管理器" class="headerlink" title="补充：关于 VueCLI 创建项目使用的包管理器"></a>补充：关于 VueCLI 创建项目使用的包管理器</h2><p>使用 VueCLI 创建项目的时候会帮我们自动装包。</p>
<ul>
<li>如果你的机器只有 npm，则它默认就使用 npm 安装包</li>
<li>如果你的机器只有 yarn，则它默认就使用 yarn 安装包</li>
</ul>
<p>如果你的机器同时存在 npm 和 yarn，则它会提示你使用 npm 还是 yarn 来装包，例如下面这样：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Vue CLI v4.1.1</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Please pick a preset:<span class="built_in"> default </span>(babel, eslint)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Pick the package manager <span class="keyword">to</span> use when installing dependencies: (Use arrow keys)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; Use Yarn</span></pre></td></tr><tr><td class="code"><pre><span class="line">  Use NPM</span></pre></td></tr></table></figure>

<blockquote>
<p>Use Yarn：使用 yarn</p>
<p>Use NPM：使用 npm</p>
</blockquote>
<p>根据提示选择对应的包管理器工具之后，接下来它就会使用你选择的包管理器工具安装项目依赖。</p>
<p>但是之后你使用 <code>vue</code> 命令创建项目的时候，它都会使用你之前选择的包管理工具安装依赖，而不再给你提示选择的机会。</p>
<p>这是因为 VueCLI 默认记住了你第 1 次选择使用的包管理器，是好事儿也是坏事儿。</p>
<p>如果你想要在初始化的时候重新选择使用的包管理工具，那就找到你操作系统用户目录下的 <code>.vuerc</code> 将其删除即可。</p>
]]></content>
      <categories>
        <category>npm</category>
      </categories>
      <tags>
        <tag>工具使用</tag>
        <tag>npm</tag>
        <tag>yarn</tag>
      </tags>
  </entry>
  <entry>
    <title>使用vscode直接调试js代码</title>
    <url>/vscode/%E4%BD%BF%E7%94%A8vscode%E7%9B%B4%E6%8E%A5%E8%B0%83%E8%AF%95js%E4%BB%A3%E7%A0%81/</url>
    <content><![CDATA[<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ul>
<li>将当前标签页设置为需要调试的js</li>
<li>将需要打断点的地方标上小红点</li>
<li>左侧工具栏点击小虫子（Run and Debug）</li>
<li>点击运行和调试</li>
<li>选择nodejs作为调试工具</li>
<li>开始调试</li>
</ul>
<p><img src="https://gitee.com/zhangbowen-1/my-gallery/raw/master/img/image-20210309103224511.png" alt="image-20210309103224511"></p>
<p>如果只调试js代码的话，选择nodejs即可</p>
<p><img src="https://gitee.com/zhangbowen-1/my-gallery/raw/master/img/image-20210309103344902.png" alt="image-20210309103344902"></p>
<h2 id="调试界面"><a href="#调试界面" class="headerlink" title="调试界面"></a>调试界面</h2><p><img src="https://gitee.com/zhangbowen-1/my-gallery/raw/master/img/image-20210309103733550.png" alt="image-20210309103733550"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>使用vscode调试非常方便，比直接在浏览器中调式体验更好，可以边调试边改代码，很爽的体验；</p>
]]></content>
      <categories>
        <category>vscode</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>使用xlsx.js 实现隐藏工作簿</title>
    <url>/xlsx/%E4%BD%BF%E7%94%A8xlsx-js-%E5%AE%9E%E7%8E%B0%E9%9A%90%E8%97%8F%E5%B7%A5%E4%BD%9C%E7%B0%BF/</url>
    <content><![CDATA[<p><a href="http://sheetjs.com/" target="_blank" rel="noopener">SheetJS js-xlsx</a> 中文文档： <a href="https://github.com/rockboom/SheetJS-docs-zh-CN" target="_blank" rel="noopener">https://github.com/rockboom/SheetJS-docs-zh-CN</a></p>
<p>下面是对工作簿能见度的描述文档</p>
<h2 id="数据表能见度"><a href="#数据表能见度" class="headerlink" title="数据表能见度"></a>数据表能见度</h2><p>Excel支持将表格隐藏在更低的标签栏。表格数据存储文件内，但是UI不容易让它可以使用。标准的隐藏表格会被显示在”Unhide”菜单内。Excel也有”very hidden”表格，这些表格不能被显示在菜单内。只可以通过Vb编辑器访问。</p>
<p>能见度的设置被存储在表格属性数组的<code>Hidden</code>属性当中。</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Definition</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>Visible</td>
</tr>
<tr>
<td>1</td>
<td>Hidden</td>
</tr>
<tr>
<td>2</td>
<td>Very Hidden</td>
</tr>
</tbody></table>
<p>更多详情请查看<a href="https://rawgit.com/SheetJS/test_files/master/sheet_visibility.xlsx：" target="_blank" rel="noopener">https://rawgit.com/SheetJS/test_files/master/sheet_visibility.xlsx：</a></p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">&gt; wb.<span class="symbol">Workbook</span>.<span class="symbol">Sheets</span>.map(function(x) &#123; return [x.name, x.<span class="symbol">Hidden</span>] &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">[ [ <span class="string">'Visible'</span>, <span class="number">0</span> ], [ <span class="string">'Hidden'</span>, <span class="number">1</span> ], [ <span class="string">'VeryHidden'</span>, <span class="number">2</span> ] ]</span></pre></td></tr></table></figure>

<p>非Excel格式不支持”Very Hidden”状态。测试一个数据比哦啊是否可见的最好方式是检查是否<code>Hidden</code>属性为逻辑truth：</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">&gt; wb.Workbook.Sheets.map(<span class="function"><span class="keyword">function</span><span class="params">(x)</span> </span>&#123; <span class="keyword">return</span> [x.name, !x.Hidden] &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">[ [ <span class="string">'Visible'</span>, <span class="literal">true</span> ], [ <span class="string">'Hidden'</span>, <span class="literal">false</span> ], [ <span class="string">'VeryHidden'</span>, <span class="literal">false</span> ] ]</span></pre></td></tr></table></figure>

<p>文档上对工作簿隐藏有说明，但是没有具体的隐藏方法，尝试直接修改工作簿的<code>Hidden</code>属性，没有任何效果， 但是皇天不负有心人， 通过查看 <a href="https://github.com/SheetJS/sheetjs/blob/master/xlsx.js" target="_blank" rel="noopener">源码</a> 发现了实现工作簿隐藏的方法</p>
<h2 id="XLSX-utils-book-set-sheet-visibility-方法"><a href="#XLSX-utils-book-set-sheet-visibility-方法" class="headerlink" title="XLSX.utils.book_set_sheet_visibility  方法"></a>XLSX.utils.book_set_sheet_visibility  方法</h2><p>下面是源码中方法的定义   </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* set sheet visibility (visible/hidden/very hidden) */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">utils.book_set_sheet_visibility = <span class="function"><span class="keyword">function</span>(<span class="params">wb, sh, vis</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">	get_default(wb,<span class="string">"Workbook"</span>,&#123;&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">	get_default(wb.Workbook,<span class="string">"Sheets"</span>,[]);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">	<span class="keyword">var</span> idx = wb_sheet_idx(wb, sh);</span></pre></td></tr><tr><td class="code"><pre><span class="line">	<span class="comment">// $FlowIgnore</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">	get_default(wb.Workbook.Sheets,idx, &#123;&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">	<span class="keyword">switch</span>(vis) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">		<span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">break</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">		<span class="keyword">default</span>: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Bad sheet visibility setting "</span> + vis);</span></pre></td></tr><tr><td class="code"><pre><span class="line">	&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">	<span class="comment">// $FlowIgnore</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">	wb.Workbook.Sheets[idx].Hidden = vis;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<p>方法分别传入三个参数：</p>
<ul>
<li>工作表对象，</li>
<li>工作簿在工作簿数组中的下标，</li>
<li>需要设置的<code>Hidden</code>属性的值 （0，1，2）</li>
</ul>
<p>工作表对象生成方法见文档,下面用<code>workbook</code>表示，工作簿在工作簿数组中的下标，可以通过workbook.SheetNames找到对应的下标</p>
<h2 id="具体实现："><a href="#具体实现：" class="headerlink" title="具体实现："></a>具体实现：</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 隐藏采购员表   因为整个xlsx的使用是以class实现的这里截取隐藏工作表的方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">hideBuyerSheet()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> indexs = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> [i,name] <span class="keyword">of</span> <span class="keyword">this</span>.workbook.SheetNames.entries()) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span>(<span class="regexp">/采购员/</span>.test(name))&#123; <span class="comment">//找到所有带采购员名称的表的下标</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      indexs.push(i);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">of</span> indexs) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="comment">// 将对应下标的工作簿隐藏 </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    XLSX.utils.book_set_sheet_visibility(<span class="keyword">this</span>.workbook, i, <span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>xlsx</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>xlsx</tag>
      </tags>
  </entry>
  <entry>
    <title>关于vue组件样式的作用域问题</title>
    <url>/vue/%E5%85%B3%E4%BA%8Evue%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E5%92%8C%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6%E6%8F%92%E6%A7%BD/</url>
    <content><![CDATA[<blockquote>
<p>参考文档：</p>
<ul>
<li><a href="https://vue-loader.vuejs.org/zh/guide/scoped-css.html" target="_blank" rel="noopener">https://vue-loader.vuejs.org/zh/guide/scoped-css.html</a></li>
</ul>
</blockquote>
<h2 id="关于组件的作用域样式"><a href="#关于组件的作用域样式" class="headerlink" title="关于组件的作用域样式"></a>关于组件的作用域样式</h2><p>影响全局：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="comment">/* 全局样式 */</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr></table></figure>

<p>作用域样式，只对当前组件内部生效：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="selector-class">.example</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  color: red;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"example"</span>&gt;</span>hi<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></pre></td></tr></table></figure>

<p>所谓的作用域，其实就是在转换的时候为其添加了一个唯一的属性名原理：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="selector-class">.example</span><span class="selector-attr">[data-v-f3f3eg9]</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  color: red;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"example"</span> <span class="attr">data-v-f3f3eg9</span>&gt;</span>hi<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></pre></td></tr></table></figure>

<p>你可以在一个组件中同时使用有 scoped 和非 scoped 样式：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="comment">/* 全局样式 */</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="comment">/* 本地样式 */</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="子组件的根元素"><a href="#子组件的根元素" class="headerlink" title="子组件的根元素"></a>子组件的根元素</h2><p>使用 <code>scoped</code> 后，父组件的样式将不会渗透到子组件中。不过一个子组件的根节点会同时受其父组件的 scoped CSS 和子组件的 scoped CSS 的影响。这样设计是为了让父组件可以从布局的角度出发，调整其子组件根元素的样式。</p>
<p>注意：只能是根元素。</p>
<h2 id="如何设置子组件根元素的样式"><a href="#如何设置子组件根元素的样式" class="headerlink" title="如何设置子组件根元素的样式"></a>如何设置子组件根元素的样式</h2><p>方式一：审查元素，观察该组件根节点的 class 类名</p>
<p>方式二：手动给组件添加 class，该类名会自动作用到组件的根元素</p>
<p>以上两种方式也只能作用到子组件的根节点 ，想要作用子组件内部的节点有两种方法</p>
<p>方法一：为当前样式单独包一个 style 标签，去掉 scoped 作用全局即可，但不是很推荐</p>
<p>方法二：使用 vue 提供的深度作用选择器， 强烈推荐！</p>
<h2 id="深度作用选择器"><a href="#深度作用选择器" class="headerlink" title="深度作用选择器"></a>深度作用选择器</h2><p>如果你希望 <code>scoped</code> 样式中的一个选择器能够作用得“更深”，例如影响子组件，你可以使用 <code>&gt;&gt;&gt;</code> 操作符：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css"> <span class="selector-class">.a</span> &gt;&gt;&gt; <span class="selector-class">.b</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">  <span class="comment">/* ... */</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr></table></figure>

<p>上述代码将会编译成：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.a</span><span class="selector-attr">[data-v-f3f3eg9]</span> <span class="selector-class">.b</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/* ... */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>有些像 Sass 之类的预处理器无法正确解析 <code>&gt;&gt;&gt;</code>。这种情况下你可以使用 <code>/deep/</code> 或 <code>::v-deep</code> 操作符取而代之——两者都是 <code>&gt;&gt;&gt;</code> 的别名，同样可以正常工作。</p>
<p>建议使用 <code>/deep/</code> 或者 <code>::v-deep</code>，因为 <code>&gt;&gt;&gt;</code> 可能在预处理器中报错。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span> <span class="selector-tag">scoped</span>&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.a /deep/ .b &#123; /* ... */ &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;/style&gt;</span></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>如果想要在父组件中影响子组件样式：</p>
<ul>
<li>要嘛不要有作用域，那就是全局，影响任何组件</li>
<li>有作用域<ul>
<li>默认只能影响根节点<ul>
<li>审查元素找到子组件根节点类名使用</li>
<li>或者手动给子组件添加一个 class，它会自动添加到子组件根节点的 class 中</li>
</ul>
</li>
<li>如果需要影响的更深，则使用深度选择器：<code>&gt;&gt;&gt;</code>、<code>/deep/</code>、<code>::v-deep</code></li>
</ul>
</li>
</ul>
<h2 id="关于如何自定义第三方组件的内容"><a href="#关于如何自定义第三方组件的内容" class="headerlink" title="关于如何自定义第三方组件的内容"></a>关于如何自定义第三方组件的内容</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  一般在使用第三方组件的时候，它们默认给出的是最常用的功能</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  如果需要自定义内容展示，那就看文档，看看人家是否支持自定义插槽</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">"单元格"</span> <span class="attr">value</span>=<span class="string">"内容"</span> <span class="attr">label</span>=<span class="string">"hello"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">"单元格"</span> <span class="attr">value</span>=<span class="string">"内容"</span> <span class="attr">label</span>=<span class="string">"hello"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">button</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- 当你没有给元素插槽起名字的时候，这个组件提供了默认插槽 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">span</span>&gt;</span>默认内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"default"</span>&gt;</span>默认内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- 同名插槽可以插入多次 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span>world<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>力扣刷题两数之和</title>
    <url>/%E7%AE%97%E6%B3%95/%E5%8A%9B%E6%89%A3%E5%88%B7%E9%A2%98%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/</url>
    <content><![CDATA[<h1 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h1><p>题目描述：<br>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那两个整数，并返回他们的数组下标。<br>你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。</p>
<p>示例：<br>给定 nums = [2, 7, 11, 15], target = 9<br>因为 nums[0] + nums[1] = 2 + 7 = 9<br>所以返回 [0, 1]</p>
<p>目前是看到的最优解决方案：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> twoSum = <span class="function"><span class="keyword">function</span> (<span class="params">nums, target</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">let</span> hashMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">for</span> (<span class="keyword">const</span> [i, num] <span class="keyword">of</span> nums.entries()) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> temp = target - num;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (hashMap.has(temp)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">return</span> [hashMap.get(temp), i];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   hashMap.set(num, i);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
      </tags>
  </entry>
  <entry>
    <title>布局容器布局下的左右托拽指令</title>
    <url>/vue/%E5%B8%83%E5%B1%80%E5%AE%B9%E5%99%A8%E5%B8%83%E5%B1%80%E4%B8%8B%E7%9A%84%E5%B7%A6%E5%8F%B3%E6%89%98%E6%8B%BD%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="vue-elementUI-项目-实现-Container-布局容器布局下的左右托拽指令"><a href="#vue-elementUI-项目-实现-Container-布局容器布局下的左右托拽指令" class="headerlink" title="vue+elementUI 项目 实现 Container 布局容器布局下的左右托拽指令"></a>vue+elementUI 项目 实现 Container 布局容器布局下的左右托拽指令</h1><p>话不多说上代码</p>
<a id="more"></a>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> resize = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//被绑定元素插入父节点时调用 (仅保证父节点存在，但不一定已被插入文档中)。</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> inserted(el, binding, vnode, oldVnode) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//创建一个定位的节点定位到要托拽的节点上</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> resize: HTMLElement = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  resize.innerText = <span class="string">"✌"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> style = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   position: <span class="string">"absolute"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   top: <span class="string">"0%"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   right: <span class="string">"0"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   display: <span class="string">"flex"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   flexDirection: <span class="string">"column"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   alignItems: <span class="string">"center"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   justifyContent: <span class="string">"center"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   width: <span class="string">"10px"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   height: <span class="string">"100%"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   overflow: <span class="string">"hidden"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   cursor: <span class="string">"e-resize"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> style) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (resize.style.hasOwnProperty(key)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    resize.style[key] = style[key];</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  el.appendChild(resize);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//获取binding参数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> &#123; container = <span class="literal">false</span>, percent = <span class="number">0.5</span> &#125; = binding.value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//容器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> containerNode = container</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ? <span class="built_in">document</span>.querySelector(container)</span></pre></td></tr><tr><td class="code"><pre><span class="line">   : el.parentElement;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//容器宽度</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> clientWidth = containerNode.clientWidth;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//要托拽节点的位置参数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> targetPosition = el.getBoundingClientRect();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//最大可托拽宽度</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> maxWidth = clientWidth * percent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//托拽事件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> handleMove = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> targetWidth = e.clientX - targetPosition.right + targetPosition.width;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   targetWidth &gt; maxWidth ? (targetWidth = maxWidth) : <span class="literal">null</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   el.style.flex = <span class="string">`0 0 <span class="subst">$&#123;targetWidth&#125;</span>px`</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//鼠标按下触发托拽</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  resize.addEventListener(<span class="string">"mousedown"</span>, (e) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   containerNode.addEventListener(<span class="string">"mousemove"</span>, handleMove);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//鼠标抬起清除事件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  containerNode.addEventListener(<span class="string">"mouseup"</span>, (e) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   containerNode.removeEventListener(<span class="string">"mousemove"</span>, handleMove);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Vue.directive(<span class="string">"resize"</span>, resize);</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>排序算法</title>
    <url>/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<p> 1</p>
<h2 id="所有排序方法对比"><a href="#所有排序方法对比" class="headerlink" title="所有排序方法对比"></a>所有排序方法对比</h2><p><a href="https://www.cnblogs.com/scode2/p/8809049.html" target="_blank" rel="noopener">https://www.cnblogs.com/scode2/p/8809049.html</a></p>
<p>图示：<a href="https://www.cnblogs.com/eniac12/p/5329396.html#s32" target="_blank" rel="noopener">https://www.cnblogs.com/eniac12/p/5329396.html#s32</a></p>
<h2 id="牛客网刷题"><a href="#牛客网刷题" class="headerlink" title="牛客网刷题"></a>牛客网刷题</h2><table>
<thead>
<tr>
<th>名称</th>
<th>运行时间</th>
<th>占用内存</th>
</tr>
</thead>
<tbody><tr>
<td>快速排序</td>
<td>1335ms</td>
<td>60404KB</td>
</tr>
<tr>
<td>冒泡排序</td>
<td>2001ms</td>
<td>7716KB</td>
</tr>
<tr>
<td>插入排序</td>
<td>2001ms</td>
<td>8080KB</td>
</tr>
<tr>
<td>sort方法</td>
<td>677ms</td>
<td>36724KB</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
      </tags>
  </entry>
  <entry>
    <title>es6 模块规范</title>
    <url>/es6/%E6%A8%A1%E5%9D%97%E8%A7%84%E8%8C%83/</url>
    <content><![CDATA[<h3 id="导出-export"><a href="#导出-export" class="headerlink" title="导出 export"></a>导出 export</h3><p>如果模块只有一个成员，建议 <code>export default</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> 数字|字符串|数组|对象|函数。。。任何数据</span></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<p>1.export default 只能有一次，重复会报错</p>
<p>2.使用时不要在后面做声明 var 、 let 、const 、直接写需要导出的对象或其他， 也可以先声明变量或常量， 再直接导出</p>
</blockquote>
<p>如果一个模块有多个成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  成员<span class="number">1</span>: 值,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  成员<span class="number">2</span>: 值<span class="number">2</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  成员<span class="number">3.</span>..</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>如果成员之间没有依赖关系，不是用于某个数据的完整整体，不推荐，你可能只使用其中某个成员，而必须加载整体数据对象</p>
<p>除非这个对象是一个完整的整体，例如 Vue 组件的实例选项对象，这样是可以的</p>
</blockquote>
<a id="more"></a>

<p>ECMAScript 6 提供了一种更优化的方案，当多个成员没有具体的依赖关系的时候，我们推荐使用 <code>export</code> 语法进行导出，因为它支持<strong>按需加载</strong>，就是说你用什么就只加载什么，其它多余的都不要，这样有利于程序的执行效率。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b = <span class="number">2</span>;</span></pre></td></tr></table></figure>

<p>也可以集中按需导出多个成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> b = <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> c = <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 语法就是这样，后面的成员也不是对象的简写方式， &#123;&#125; 中的成员必须当前模块能够访问的成员名称</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 不是 a: a 的简写，必须 a</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// a 必须是当前模块中的某个成员</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> a,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> b,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> c,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 以上写法等价于</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export const a = 1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export const b = 2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export const c = 3</span></span></pre></td></tr></table></figure>

<p>有时候模块中有很多成员的时候，我们会 <code>export default</code> 和 <code>export</code> 一起使用。</p>
<p>我们把最常用的使用 <code>export default</code> 导出，把不太常用的使用 <code>export</code> 导出（用于按需加载）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b = <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> x + y;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="导入-import"><a href="#导入-import" class="headerlink" title="导入 import"></a>导入 import</h3><p>加载 <code>export default</code> 成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx <span class="keyword">from</span> <span class="string">"模块路径"</span>;</span></pre></td></tr></table></figure>

<p>按需加载 <code>export</code> 成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; 成员<span class="number">1</span> <span class="keyword">as</span> 别名, 成员<span class="number">2.</span>.. &#125; <span class="keyword">from</span> <span class="string">'模块路径'</span></span></pre></td></tr></table></figure>

<p>混着加载 <code>export default</code> 和 <code>export</code> 成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx, &#123; 成员<span class="number">1</span>, 成员<span class="number">2.</span>.. &#125; <span class="keyword">from</span> <span class="string">'模块路径'</span></span></pre></td></tr></table></figure>

<p>一次性加载所有成员</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> xxx <span class="keyword">from</span> <span class="string">"模块路径"</span>;</span></pre></td></tr></table></figure>

<blockquote>
<p>包括 <code>export default</code> 和 <code>export</code> 所有成员</p>
<p><code>export default</code> 就是一个名字叫 <code>default</code> 的成员，知道即可，不推荐这样来使用 <code>xxx.default</code></p>
</blockquote>
<p>下面是一个导出的例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">123</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export default 只能有1次，多次就报错，语法不允许</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export default 'hello'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 如果你想导出多个成员，可以放到1个对象中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export default &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//   a: 1,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//   b: 2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 大多数情况下我们其实只需要使用到对象中某几个成员，而不是所有</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// ECMAScript 6 为了优化这一点，增加了：按需加载和导出功能</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 使用谁，加载谁，更有利于性能优化，打包优化</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 按需导出可以导出任意个成员</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 注意：export 成员必须有名字</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b = <span class="string">"hello"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 也不能这么写</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// const d = 789</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export d</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export const d = 789</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// export function hello () &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//   console.log('hello')</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 建议写法：</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 我们一般会把最主要的那个成员作为 export  default 导出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 如果有其它的成员，作为 export 成员按需导出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 没有主要的那就不用设置了，</span></span></pre></td></tr></table></figure>

<h3 id="模块数据结构"><a href="#模块数据结构" class="headerlink" title="模块数据结构"></a>模块数据结构</h3><p>使用 import * as xx form “xxx” 可以获取 模块的结构</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">default</span>: &#123;	  <span class="comment">// export default 导出的数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"default"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  module1: &#123;	<span class="comment">// 单独 export 导出的数据 </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;, </span></pre></td></tr><tr><td class="code"><pre><span class="line">  module2: &#123;	<span class="comment">// 多个 export 都再这一层</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"module2"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125; </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="简便写法"><a href="#简便写法" class="headerlink" title="简便写法"></a>简便写法</h3><h4 id="导入多个-导出多个"><a href="#导入多个-导出多个" class="headerlink" title="导入多个 导出多个"></a>导入多个 导出多个</h4><p><a name="project1">案例1.1</a></p>
<p>module1.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module1 = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module3= &#123;    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"module3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> module1;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; module1 &#125;; <span class="comment">// 多个导出模块也可以这样写 export &#123; module1 &#125;;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; module3 &#125;;</span></pre></td></tr></table></figure>

<p>module2.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module2 = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"module2"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> module2;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">export</span> &#123; module2 &#125;;</span></pre></td></tr></table></figure>

<p>index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">"./module1"</span>; <span class="comment">//会将 module1 内部使用 export 导出的模块都导出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">"./module2"</span>;</span></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> modules <span class="keyword">from</span> <span class="string">'./index.js'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"modules"</span>, modules)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 下面是 modules 数据结构  因为都是使用 export 导出 所以没有 default</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module1"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module3"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module2"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module2"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h4 id="导入默认模块-并导出为默认模块"><a href="#导入默认模块-并导出为默认模块" class="headerlink" title="导入默认模块 并导出为默认模块"></a>导入默认模块 并导出为默认模块</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'./dialog.vue'</span>  <span class="comment">// 将默认模块 导出为默认模块</span></span></pre></td></tr></table></figure>

<h3 id="常用写法"><a href="#常用写法" class="headerlink" title="常用写法"></a>常用写法</h3><h4 id="组件的导出"><a href="#组件的导出" class="headerlink" title="组件的导出"></a>组件的导出</h4><p>index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> VBtn <span class="keyword">from</span> <span class="string">'./VBtn'</span>   <span class="comment">// 将index.js作为导出的中转将VBtn.vue导出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; VBtn &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> VBtn</span></pre></td></tr></table></figure>



<h3 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h3><h4 id="多次导出一个模块-只执行一次"><a href="#多次导出一个模块-只执行一次" class="headerlink" title="多次导出一个模块 只执行一次"></a>多次导出一个模块 只执行一次</h4><p>module1.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module1 = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: <span class="string">"module1"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  id: <span class="built_in">Date</span>.now() + <span class="built_in">Math</span>.random() * <span class="number">100</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> module1;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; module1 &#125;</span></pre></td></tr></table></figure>

<p>多个模块导入一起导入 </p>
<blockquote>
<p>tip:本例中虽然是两个js但打包后会合并到一个页面中执行，如果路由发生跳转则相当于重新编译所以导入模块也将重置</p>
</blockquote>
<p>index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> modules <span class="keyword">from</span> <span class="string">'./module1.js'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"name"</span>: <span class="string">"module1"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"id"</span>: <span class="number">1615195779568.6755</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> modules <span class="keyword">from</span> <span class="string">'./module1.js'</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"name"</span>: <span class="string">"module1"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"id"</span>: <span class="number">1615195779568.6755</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>下面的id都是 1615195779568.6755 </p>
<h4 id="export-导出重名模块-只会存在一个"><a href="#export-导出重名模块-只会存在一个" class="headerlink" title="export 导出重名模块 只会存在一个"></a>export 导出重名模块 只会存在一个</h4><p>将 <a href="#project1">案例1.1</a> 修改一下 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module1 = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> module2= &#123;    <span class="comment">//module2.js 导出 和 module1.js 的导出 都有 module2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"module3"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> module1;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; module1 &#125;; </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; module2&#125;;</span></pre></td></tr></table></figure>

<p>main.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> modules <span class="keyword">from</span> <span class="string">'./index.js'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"modules"</span>, modules)  <span class="comment">// 有两个重名模块 只会留在上面那个导出的模块</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module1"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module2"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module3"</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>如果修改一下 index.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">"./module2"</span>;  <span class="comment">// 最终导出的 module2 将是 module2.js 中的</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">"./module1"</span>;   </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module1"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module1"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"module2"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"name"</span>: <span class="string">"module2"</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="ES6-模块与-CommonJS-模块的差异"><a href="#ES6-模块与-CommonJS-模块的差异" class="headerlink" title="ES6 模块与 CommonJS 模块的差异"></a>ES6 模块与 CommonJS 模块的差异</h3><p>讨论 Node.js 加载 ES6 模块之前，必须了解 ES6 模块与 CommonJS 模块完全不同。</p>
<p>它们有三个重大差异。</p>
<ul>
<li>CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。</li>
<li>CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。</li>
<li>CommonJS 模块的<code>require()</code>是同步加载模块，ES6 模块的<code>import</code>命令是异步加载，有一个独立的模块依赖的解析阶段。</li>
</ul>
<p>第二个差异是因为 CommonJS 加载的是一个对象（即<code>module.exports</code>属性），该对象只有在脚本运行完才会生成。而 ES6 模块不是对象，它的对外接口只是一种静态定义，在代码静态解析阶段就会生成。</p>
<p>详细分析见阮一峰es6入门：<a href="https://es6.ruanyifeng.com/#docs/module-loader" target="_blank" rel="noopener">https://es6.ruanyifeng.com/#docs/module-loader</a></p>
<h4 id="CommonJS-模块加载-ES6-模块"><a href="#CommonJS-模块加载-ES6-模块" class="headerlink" title="CommonJS 模块加载 ES6 模块"></a>CommonJS 模块加载 ES6 模块</h4><p>CommonJS 的<code>require()</code>命令不能加载 ES6 模块，会报错，只能使用<code>import()</code>这个方法加载。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'./my-app.mjs'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)();</span></pre></td></tr></table></figure>

<h4 id="ES6-模块加载-CommonJS-模块"><a href="#ES6-模块加载-CommonJS-模块" class="headerlink" title="ES6 模块加载 CommonJS 模块"></a>ES6 模块加载 CommonJS 模块</h4><p>ES6 模块的<code>import</code>命令可以加载 CommonJS 模块，但是只能整体加载，不能只加载单一的输出项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> packageMain <span class="keyword">from</span> <span class="string">'commonjs-package'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; method &#125; <span class="keyword">from</span> <span class="string">'commonjs-package'</span>;</span></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>es6</category>
      </categories>
      <tags>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>运行electron-builder-install-app-deps-卡住不动的问题解决</title>
    <url>/electron/%E8%BF%90%E8%A1%8Celectron-builder-install-app-deps-%E5%8D%A1%E4%BD%8F%E4%B8%8D%E5%8A%A8%E7%9A%84%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</url>
    <content><![CDATA[<p> 背景：使用electron-builder 和 @journeyapps/sqlcipher 的项目 ，在新电脑上clone项目，npm 装包时遇到错误</p>
<p>一般electron-builder的项目下完包的最后，会调用electron-builder install-app-deps 命令重新构建本地依赖</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201213113529472-1607837076092-1607839721753.png" alt="image-20201213112431054"></p>
<p>换了电脑后就是在这里卡住，卡住几个小时都不动，也不报错，无奈尝试遍各种方法都不行，比如卸载node重新安装，卸载python和 visual studio,修改npm 配置改为淘宝镜像地址，使用 yarn，cnpm 安装，都是不行，百度上也没有对应的案例，就差祈祷了，感觉每次npm 下包都是看运气，哎，还是经验少啊。</p>
<p>最后因为是卡在@journeyapps/sqlcipher 这个sqlite加密版插件上，于是package.json中提高了@journeyapps/sqlcipher的版本改成5.0.0最新版本，并改用cnpm正经淘宝镜像来安装， 发现可以正常编译 ，最后的electron-builder install-app-deps 也过去了，但是运行项目的时候却 报错说缺编译@journeyapps/sqlcipher 的builder模块，说明electron-builder install-app-deps 没成功啊，继续找原因，灵光一闪看到：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201213112431054-1607837073833-1607839720074.png" alt="image-20201213113529472"></p>
<p>node-pre-gyp，可以将存在网络上的作者根据不同平台预编译好的二进制文件下载下来</p>
<p>关于gyp与node-gyp与node-pre-gyp 可以看这篇文章<a href="https://zhuanlan.zhihu.com/p/330468774" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/330468774</a></p>
<p>原来 这个包的时候先去·<code>https://journeyapps-node-binary.s3.amazonaws.com/@journeyapps/sqlcipher/v4.1.0/node-v83-win32-x64.tar.gz</code>  找对应系统的对应node版本的二进制文件， 如果没有就会下载源码进行编译，之前在linux上下载这个包就出现过这个问题，</p>
<p>node-v83 表示当前node的NODE_MODULE_VERSION <a href="https://nodejs.org/zh-cn/download/releases/" target="_blank" rel="noopener">官网</a>可以查到,因为是新电脑所以下的是node的最新版本14，还是太年轻啊，以为最新的就是最好的，不知道好多插件都没有最新node版本的二进制文件，通过 <a href="https://npm.taobao.org/mirrors?spm=a2c6h.14029880.0.0.735975d7WMqyIm" target="_blank" rel="noopener">淘宝镜像</a> （一般淘宝镜像上有的就一定是有了）看到最新的包是<code>node-v72-win32-x64.tar.gz</code>,也就是node的12版本，果断卸载14 安装 12 。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20201213115738432-1607837078098-1607839723068.png" alt="image-20201213115738432"></p>
<p>最后试了几次之后终于重新构建本地依赖成功</p>
]]></content>
      <categories>
        <category>electron</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>Nodejs</tag>
        <tag>electron</tag>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>Promise对象和async函数</title>
    <url>/es6/Promise%E5%AF%B9%E8%B1%A1%E5%92%8Casync%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h2 id="异步代码"><a href="#异步代码" class="headerlink" title="异步代码"></a>异步代码</h2><h3 id="现在常见的的异步代码"><a href="#现在常见的的异步代码" class="headerlink" title="现在常见的的异步代码"></a>现在常见的的异步代码</h3><ul>
<li>定时器</li>
<li>ajax 请求</li>
</ul>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p><strong>1.在 JavaScript 中，记住一件事儿：所有的异步回调函数执行一定在普通代码执行之后</strong></p>
<p><strong>2.如果想要获取异步代码的执行结果：通过回调函数来接收</strong></p>
<h3 id="基于回调函数的异步流程控制"><a href="#基于回调函数的异步流程控制" class="headerlink" title="基于回调函数的异步流程控制"></a>基于回调函数的异步流程控制</h3><p>封装一个原生 get 请求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url, cd</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></pre></td></tr><tr><td class="code"><pre><span class="line"> xhr.open(<span class="string">"get"</span>, url);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> xhr.send();</span></pre></td></tr><tr><td class="code"><pre><span class="line"> xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  cd(<span class="keyword">this</span>.response);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h4 id="原生-ajax-请求注意事项"><a href="#原生-ajax-请求注意事项" class="headerlink" title="原生 ajax 请求注意事项"></a>原生 ajax 请求注意事项</h4><p>事件最好放在发送请求前 不然像捕获发送失败这种函数会获不到</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></pre></td></tr><tr><td class="code"><pre><span class="line">xhr.addEventListener(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> resolve(<span class="keyword">this</span>.response);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">xhr.addEventListener(<span class="string">"error"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> reject(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">xhr.open(<span class="string">"get"</span>, url);</span></pre></td></tr><tr><td class="code"><pre><span class="line">xhr.send();</span></pre></td></tr></table></figure>

<h4 id="异步并行"><a href="#异步并行" class="headerlink" title="异步并行"></a>异步并行</h4><ul>
<li>一起执行 不分先后顺序</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">get</span>("http://jsonplaceholder.typicode.com/posts", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">get</span>("http://jsonplaceholder.typicode.com/comments", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">get</span>("http://jsonplaceholder.typicode.com/users", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">3</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<h4 id="异步串行"><a href="#异步串行" class="headerlink" title="异步串行"></a>异步串行</h4><ul>
<li>依次执行 上一层执行完毕在执行下面代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">get</span>("http://jsonplaceholder.typicode.com/posts", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">get</span>("http://jsonplaceholder.typicode.com/comments", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">get</span>("http://jsonplaceholder.typicode.com/users", function (res) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="built_in">console</span>.log(<span class="number">3</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<h3 id="回调地狱"><a href="#回调地狱" class="headerlink" title="回调地狱"></a>回调地狱</h3><p>异步串行如果嵌套过深会造成经典的<code>回调地狱</code> 这时需要用到 es6 新增的 Promise 对象来解决</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/timg.jpg" alt="img"></p>
<h3 id="axios-的串行"><a href="#axios-的串行" class="headerlink" title="axios 的串行"></a>axios 的串行</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">axios(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> method: <span class="string">"GET"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> url: <span class="string">"http://jsonplaceholder.typicode.com/posts"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"> .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"2 posts 的响应结果"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> axios(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   method: <span class="string">"GET"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   url: <span class="string">"http://jsonplaceholder.typicode.com/users"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"> .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"3 users 的响应结果"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> axios(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   method: <span class="string">"GET"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   url: <span class="string">"http://jsonplaceholder.typicode.com/comments"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"> .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"4 comments 的响应结果"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;);</span></pre></td></tr></table></figure>

<h3 id="补充：setTimeout、setInterval-被遗忘的第三个参数"><a href="#补充：setTimeout、setInterval-被遗忘的第三个参数" class="headerlink" title="补充：setTimeout、setInterval 被遗忘的第三个参数"></a>补充：setTimeout、setInterval 被遗忘的第三个参数</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout" target="_blank" rel="noopener">MDN</a>介绍</p>
<p>定时器启动时候，第三个以后的参数是作为第一个<code>func()</code>的参数传进去。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span> (<span class="params">x, y, z</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(x + y + z); <span class="comment">// 打印6</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">setTimeout(sum, <span class="number">1000</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span></pre></td></tr></table></figure>

<h2 id="Promise-对象"><a href="#Promise-对象" class="headerlink" title="Promise 对象"></a>Promise 对象</h2><h3 id="Promise-的含义"><a href="#Promise-的含义" class="headerlink" title="Promise 的含义"></a>Promise 的含义</h3><p>Promise 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大。它由社区最早提出和实现，ES6 将其写进了语言标准，统一了用法，原生提供了<code>Promise</code>对象。</p>
<p>所谓<code>Promise</code>，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。Promise 提供统一的 API，各种异步操作都可以用同样的方法进行处理。</p>
<p><code>Promise</code>对象有以下两个特点。</p>
<p>（1）对象的状态不受外界影响。<code>Promise</code>对象代表一个异步操作，有三种状态：<code>pending</code>（进行中）、<code>fulfilled</code>（已成功）和<code>rejected</code>（已失败）。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是<code>Promise</code>这个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。</p>
<p>（2）一旦状态改变，就不会再变，任何时候都可以得到这个结果。<code>Promise</code>对象的状态改变，只有两种可能：从<code>pending</code>变为<code>fulfilled</code>和从<code>pending</code>变为<code>rejected</code>。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为 resolved（已定型）。如果改变已经发生了，你再对<code>Promise</code>对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。</p>
<p>注意，为了行文方便，本章后面的<code>resolved</code>统一只指<code>fulfilled</code>状态，不包含<code>rejected</code>状态。</p>
<p>有了<code>Promise</code>对象，就可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回调函数。此外，<code>Promise</code>对象提供统一的接口，使得控制异步操作更加容易。</p>
<p><code>Promise</code>也有一些缺点。首先，无法取消<code>Promise</code>，一旦新建它就会立即执行，无法中途取消。其次，如果不设置回调函数，<code>Promise</code>内部抛出的错误，不会反应到外部。第三，当处于<code>pending</code>状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</p>
<p>如果某些事件不断地反复发生，一般来说，使用 <a href="https://nodejs.org/api/stream.html" target="_blank" rel="noopener">Stream</a> 模式（node.js）是比部署<code>Promise</code>更好的选择。</p>
<h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ... some code</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (<span class="comment">/* 异步操作成功 */</span>)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    resolve(value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    reject(error);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p><code>Promise</code>构造函数接受一个函数作为参数，该函数的两个参数分别是<code>resolve</code>和<code>reject</code>。它们是两个函数，由 JavaScript 引擎提供，不用自己部署。</p>
<p><code>resolve</code>函数的作用是，将<code>Promise</code>对象的状态从“未完成”变为“成功”（即从 pending 变为 resolved），在异步操作成功时调用，并将异步操作的结果，作为参数传递出去；<code>reject</code>函数的作用是，将<code>Promise</code>对象的状态从“未完成”变为“失败”（即从 pending 变为 rejected），在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去。</p>
<p><code>Promise</code>实例生成以后，可以用<code>then</code>方法分别指定<code>resolved</code>状态和<code>rejected</code>状态的回调函数。</p>
<p><code>then</code>方法可以接受两个回调函数作为参数。第一个回调函数是<code>Promise</code>对象的状态变为<code>resolved</code>时调用，第二个回调函数是<code>Promise</code>对象的状态变为<code>rejected</code>时调用。其中，第二个函数是可选的，不一定要提供。这两个函数都接受<code>Promise</code>对象传出的值作为参数。</p>
<p>下面是一个<code>Promise</code>对象的简单例子。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">ms</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  setTimeout(resolve, ms, <span class="string">"done"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">timeout(<span class="number">100</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>上面代码中，<code>timeout</code>方法返回一个<code>Promise</code>实例，表示一段时间以后才会发生的结果。过了指定的时间（<code>ms</code>参数）以后，<code>Promise</code>实例的状态变为<code>resolved</code>，就会触发<code>then</code>方法绑定的回调函数。</p>
<h3 id="Promise-then-方法"><a href="#Promise-then-方法" class="headerlink" title="Promise-then 方法"></a>Promise-then 方法</h3><ul>
<li>then 方法执行完以后会返回一个新的 Promise 对象</li>
<li>如果是普通数据，那么它会把该数据包装为那个返回的 Promise 的 resolve 结果</li>
<li>如果你返回的数据就是一个 Promise 对象，那它就不做任何处理了</li>
</ul>
<h2 id="async-函数"><a href="#async-函数" class="headerlink" title="async 函数"></a>async 函数</h2><p><strong>Async 函数简化了 Promise 的调用，本质还是 Promise，有点类似 promise 的 then 方法</strong></p>
<p><strong>任何函数都可以被标记为 async 函数</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// 具名函数：async function main() &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 匿名函数：async function () &#123;&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 箭头函数：async () =&gt; &#123;&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 对象函数成员简写：</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// const user = &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//   sayHello: async function () &#123;&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//   sayHello: async () =&gt; &#123;&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">注意对象里函数的简写  <span class="keyword">async</span>写在方法名的前面 其他的放在函数前即可</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   async sayHello () &#123;&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// &#125;</span></span></pre></td></tr></table></figure>

<h3 id="async-函数-返回值"><a href="#async-函数-返回值" class="headerlink" title="async 函数-返回值"></a>async 函数-返回值</h3><ul>
<li>async 函数始终返回 Promise</li>
<li>async 函数的返回值<ul>
<li>如果是普通数据，则直接把它包装到 promise 对象中，数据就是 resolve 的结果</li>
<li>如果你返回的直接就是一个 promise 对象，则不作任何处理</li>
<li>如果你什么都没有反回，则返回一个空的 promise 对象</li>
</ul>
</li>
</ul>
<h3 id="await"><a href="#await" class="headerlink" title="await"></a>await</h3><p>await 代表等待的意思，就是等待后面的 promise 执行完返回后 在执行后续代码 ，相当于将后面的代码改成同步执行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">ayrequest</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> res = <span class="keyword">await</span> request(<span class="string">"http://jsonplaceholder.typicode.com/users"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">1</span>); <span class="comment">//此代码会等待上面代码返回后再执行</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> request(<span class="string">"http://jsonplaceholder.typicode.com/users"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="number">2</span>); <span class="comment">// 此代码不会等待上面代码返回 ， 直接执行</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="async-函数-异常处理"><a href="#async-函数-异常处理" class="headerlink" title="async 函数-异常处理"></a>async 函数-异常处理</h3><p>跟推荐使用 try catch 语法来获取异常</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">ayrequest</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> res = <span class="keyword">await</span> request(<span class="string">"http://jsonplaceholder.typicode.com/users"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> request(<span class="string">"http://jsonplaceholder.typicode.com/posts"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 异常处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> request(<span class="string">"sdf://dsfsdfsdf.sdf.com/dsf"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(res);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125; <span class="keyword">catch</span> (error) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"发送失败"</span>, error);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="在-Vue-中使用-async-函数"><a href="#在-Vue-中使用-async-函数" class="headerlink" title="在 Vue 中使用 async 函数"></a>在 Vue 中使用 async 函数</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> created () &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        axios(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          method: <span class="string">'GET'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          url: <span class="string">'http://jsonplaceholder.typicode.com/posts'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="built_in">console</span>.log(res)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>es6</category>
      </categories>
      <tags>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>Vuex入门</title>
    <url>/vue/Vuex/</url>
    <content><![CDATA[<h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h2><h3 id="1-1-组件化开发"><a href="#1-1-组件化开发" class="headerlink" title="1.1. 组件化开发"></a>1.1. 组件化开发</h3><p>在现代 Web 开发复杂多变的需求驱动之下，组件化开发已然成为了事实上的标准。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/components.png" alt="components"></p>
<p>组件化开发为我们带来了：</p>
<ul>
<li>更快的开发效率</li>
<li>更好的可维护性</li>
</ul>
<h3 id="1-2-组件内的状态管理流程"><a href="#1-2-组件内的状态管理流程" class="headerlink" title="1.2. 组件内的状态管理流程"></a>1.2. 组件内的状态管理流程</h3><p>每个组件都有自己的状态、视图和行为等组成部分。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// state</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> data() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   count: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// view</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> template: <span class="string">`</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        &lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">        `</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// actions</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> methods: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  increment() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.count++;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<ul>
<li>state，驱动应用的数据源；</li>
<li>view，以声明方式将 state 映射到视图；</li>
<li>actions，响应在 view 上的用户输入导致的状态变化</li>
</ul>
<p>以下是一个表示“单向数据流”理念的简单示意：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/flow.png" alt="flow"></p>
<h3 id="1-3-组件通信"><a href="#1-3-组件通信" class="headerlink" title="1.3. 组件通信"></a>1.3. 组件通信</h3><p>然而大多数场景下的组件都并不是独立存在的，而是相互协作共同构成了一个复杂的业务功能。在 Vue<br>中为不同的组件关系提供了不同的通信规则。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1575007644430.png" alt="1575007644430"></p>
<ul>
<li>父子关系</li>
<li>非父子</li>
<li>。。。</li>
</ul>
<h3 id="1-3-1-父传子：Props-Down"><a href="#1-3-1-父传子：Props-Down" class="headerlink" title="1.3.1. 父传子：Props Down"></a>1.3.1. 父传子：Props Down</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">title</span>=<span class="string">"My journey with Vue"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Vue.component(<span class="string">"blog-post"</span>, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> props: [<span class="string">"title"</span>],</span></pre></td></tr><tr><td class="code"><pre><span class="line"> template: <span class="string">"&lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;/h3&gt;"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<h3 id="1-3-2-子传父：Events-Up"><a href="#1-3-2-子传父：Events-Up" class="headerlink" title="1.3.2. 子传父：Events Up"></a>1.3.2. 子传父：Events Up</h3><p>在子组件中使用 $emit 发布一个自定义事件：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"$emit('enlarge-text')"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> Enlarge text</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr></table></figure>

<p>在使用这个组件的时候，使用 v-on 监听这个自定义事件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">...</span> <span class="attr">v-on:enlarge-text</span>=<span class="string">"postFontSize += 0.1"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span></pre></td></tr></table></figure>

<h3 id="1-3-3-通过-ref-获取子组件"><a href="#1-3-3-通过-ref-获取子组件" class="headerlink" title="1.3.3. 通过 ref 获取子组件"></a>1.3.3. 通过 ref 获取子组件</h3><p>在使用组件的时候，添加 ref 属性：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">blog-post</span> <span class="attr">title</span>=<span class="string">"My journey with Vue"</span> <span class="attr">ref</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;/<span class="name">blog-post</span>&gt;</span></span></pre></td></tr></table></figure>

<p>然后使用 $refs 访问：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$refs.post;</span></pre></td></tr></table></figure>

<h3 id="1-3-4-非父子：Event-Bus"><a href="#1-3-4-非父子：Event-Bus" class="headerlink" title="1.3.4. 非父子：Event Bus"></a>1.3.4. 非父子：Event Bus</h3><p>我们可以使用一个非常简单的 Event Bus 来解决这个问题：</p>
<p><code>event-bus.js :</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vue();</span></pre></td></tr></table></figure>

<p>然后在需要通信的两端：</p>
<p>使用 <code>$on</code>订阅：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 没有参数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">bus.$on(<span class="string">"自定义事件名称"</span>, () =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 执行操作</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 有参数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">bus.$on(<span class="string">"自定义事件名称"</span>, (data) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 执行操作</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>使用<code>$emit</code>发布：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 没有自定义传参</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">bus.$emit(<span class="string">"自定义事件名称"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 有自定义传参</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">bus.$emit(<span class="string">"自定义事件名称"</span>, 数据);</span></pre></td></tr></table></figure>

<h3 id="1-4-多个组件状态共享"><a href="#1-4-多个组件状态共享" class="headerlink" title="1.4. 多个组件状态共享"></a>1.4. 多个组件状态共享</h3><p>但是，当我们的应用遇到多个组件共享状态时：</p>
<ul>
<li>多个视图依赖于同一状态</li>
<li>来自不同视图的行为需要变更同一状态</li>
</ul>
<blockquote>
<p>最典型的场景就是购物车</p>
</blockquote>
<p>对于问题一，传参的方法对于多层嵌套的组件将会非常繁琐，并且对于兄弟组件间的状态传递无能为<br>力。</p>
<p>对于问题二，我们经常会采用父子组件直接引用或者通过事件来变更和同步状态的多份拷贝。以上的这<br>些模式非常脆弱，通常会导致无法维护的代码。</p>
<p>因此，我们为什么不把组件的共享状态抽取出来，以一个全局单例模式管理呢？在这种模式下，我们的<br>组件树构成了一个巨大的“视图”，不管在树的哪个位置，任何组件都能获取状态或者触发行为！</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1575009217911.png" alt="1575009217911"></p>
<p>通过定义和隔离状态管理中的各种概念并通过强制规则维持视图和状态间的独立性，我们的代码将会变<br>得更结构化且易维护。</p>
<h3 id="1-5-什么是-Vuex"><a href="#1-5-什么是-Vuex" class="headerlink" title="1.5. 什么是 Vuex"></a>1.5. 什么是 Vuex</h3><blockquote>
<p>官方文档：<code>Vuex</code>是一个专为 <code>Vue.js</code>应用程序开发的状态管理模式。它采用集中式存储管理应用<br>的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。Vuex 也集成到 Vue<br>的官方调试工具 devtools extension，提供了诸如零配置的 time-travel 调试、状态快照导入导出<br>等高级调试功能。</p>
</blockquote>
<ul>
<li><code>Vue</code> 是专门为<code>Vue.js</code> 设计的状态管理库</li>
<li>它采用集中式的方式存储需要共享的数据</li>
<li>从使用角度，它就是一个 JavaScript 库</li>
<li>它的作用是进行状态管理，解决复杂组件通信，数据贡献</li>
</ul>
<h3 id="1-6-什么情况下使用-Vuex"><a href="#1-6-什么情况下使用-Vuex" class="headerlink" title="1.6. 什么情况下使用 Vuex"></a>1.6. 什么情况下使用 Vuex</h3><blockquote>
<p>官方文档：<br><code>Vuex</code> 可以帮助我们管理共享状态，并附带了更多的概念和框架。这需要对短期和长期效益进行权<br>衡。<br>如果您不打算开发大型单页应用，使用<code>Vuex</code> 可能是繁琐冗余的。确实是如此——如果您的应用<br>够简单，您最好不要使用<code>Vuex</code>。一个简单的 store 模式就足够您所需了。但是，如果您需要构建<br>一个中大型单页应用，您很可能会考虑如何更好地在组件外部管理状态，<code>Vuex</code> 将会成为自然而然<br>的选择。引用 <code>Redux</code>的作者 <code>Dan Abramov</code>的话说就是：Flux 架构就像眼镜：您自会知道什么时<br>候需要它。</p>
</blockquote>
<p>当你的应用中具有以下需求场景的时候：</p>
<ul>
<li><strong>多个视图依赖于同一状态</strong>。</li>
<li><strong>来自不同视图的行为需要变更同一状态</strong>。</li>
</ul>
<p>建议符合这种场景的业务使用 <code>Vuex</code>来进行数据管理，例如非常典型的场景：<strong>购物车</strong>。</p>
<p><strong>注意：<code>Vuex</code> 不要滥用，不符合以上需求的业务不要使用，反而会让你的应用变得更麻烦</strong></p>
<h2 id="2-准备"><a href="#2-准备" class="headerlink" title="2. 准备"></a>2. 准备</h2><p>实现一个类似于购物车的组件案例</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1575009753493.png" alt="1575009753493"></p>
<p>1、使用 VueCLI 创建一个练习项目：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vue create vuex-demo cd vuex-demo npm run serve</span></pre></td></tr></table></figure>

<p>2、准备两个组件</p>
<p>Foo.vue 和 Bar.vue</p>
<p>3、最后在 App.vue 中加载使用 Foo 和 Bar</p>
<p>最终达到上图效果</p>
<h2 id="3-安装-Vuex"><a href="#3-安装-Vuex" class="headerlink" title="3. 安装 Vuex"></a>3. 安装 Vuex</h2><pre><code>官方文档：https://vuex.vuejs.org/zh/installation.html</code></pre><p>最方便的方式就是使用 npm：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 或者 yarn add vuex</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> npm <span class="keyword">install</span> vuex</span></pre></td></tr></table></figure>

<h2 id="4-配置-Vuex"><a href="#4-配置-Vuex" class="headerlink" title="4. 配置 Vuex"></a>4. 配置 Vuex</h2><p>1、在项目中新建<code>store/index.js</code>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">"vuex"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Vue.use(Vuex);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 创建一个 Vuex 容器实例，用来在组件的外部管理共享的数据状态</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  * 类似于组件中的 data</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> state: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  count: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span></pre></td></tr></table></figure>

<p>2、在 <code>main.js</code>将<code>store</code>注册到 <code>Vue</code>根实例</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"./App.vue"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">"./store/"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">Vue.config.productionTip = <span class="literal">false</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> render: <span class="function">(<span class="params">h</span>) =&gt;</span> h(App),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> store,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;).$mount(<span class="string">"#app"</span>);</span></pre></td></tr></table></figure>

<h2 id="5-State"><a href="#5-State" class="headerlink" title="5. State"></a>5. State</h2><blockquote>
<p>目标：<br>知道什么是 State<br>掌握如何定义 State<br>掌握如何在组件中访问 State 数据</p>
</blockquote>
<p>容器中的 state 就好比组件的 data，用来存储共享数据：</p>
<ul>
<li>容器中的数据是共享的，任何组件都可以访问</li>
<li>容器中的数据也是响应式的，数据改变也会驱动视图更新</li>
</ul>
<p>在组件中访问容器中的数据，可以通过以下几种方式。</p>
<p>在组件模板中直接通过 $store 访问容器数据：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; $store.state.count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>

<p>在组件 JavaScript 中访问容器数据需要加 this ：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    onClick () &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$store.state.count)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>如果在组件中多次使用到容器数据，可以将其封装到一个计算属性中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">computed: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    count () &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.count</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>然后就像使用访问自己的数据一样来访问容器中的数据</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="6-在调试工具中调试-Vuex-容器数据"><a href="#6-在调试工具中调试-Vuex-容器数据" class="headerlink" title="6. 在调试工具中调试 Vuex 容器数据"></a>6. 在调试工具中调试 Vuex 容器数据</h2><p>也可以通过调试工具查看 Vuex 容器中的数据：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1575011046982.png" alt="1575011046982"></p>
<h2 id="7-Mutation"><a href="#7-Mutation" class="headerlink" title="7. Mutation"></a>7. Mutation</h2><p>目标：</p>
<ul>
<li>了解 Mutation 的作用是什么</li>
<li>掌握如何定义 Mutation</li>
<li>掌握如何调用 Mutation</li>
</ul>
<p><strong>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation</strong>。Vuex 中的 mutation 非常类似于事件：每<br>个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。这个回调函数就是我们<br>实际进行状态更改的地方，并且它会接受 state 作为第一个参数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> state: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  count: <span class="number">1</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> mutations: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  increment(state) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 变更状态</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   state.count++;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>然后在组件中调用 mutation：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"com"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Bar 组件<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; $store.state.count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- 如果是在 JS 中，则 this.$store.commit('increment') --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$store.commit('increment')"</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></pre></td></tr></table></figure>

<p>mutation 函数也可以自定义传参：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">mutations: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    increment (state, n) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        state.count += n</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(<span class="string">"increment"</span>, <span class="number">10</span>);</span></pre></td></tr></table></figure>

<p><strong>注意：mutation 只能传递 1 个自定义参数</strong></p>
<p>如果需要传递多个参数，就放到一个对象中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">mutations: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    increment (state, payload) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(payload) <span class="comment">// &#123; n: 10, m: 20 &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        state.count += payload.n</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(<span class="string">"increment"</span>, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> n: <span class="number">10</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> m: <span class="number">20</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>提交 mutation 的另一种方式是直接使用包含 <code>type</code>属性的对象：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.commit(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> type: <span class="string">"increment"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> amount: <span class="number">10</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>当使用对象风格的提交方式，整个对象都作为载荷传给 mutation 函数，因此处理函数保持不变：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mutations: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    increment (state, payload) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        state.count += payload.amount</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>总结：</p>
<ul>
<li>修改容器的 state 务必使用 mutation 函数，因为只有 mutation 函数中修改 state 数据才会和调试工具正常工作。</li>
<li>mutation 函数的第 1 个参数是 state 对象</li>
<li>mutation 函数也可以自定义传参</li>
<li><strong>注意：不要在 mutation 中执行异步操作修改 state 、调试工具会出现问题。</strong></li>
</ul>
<h2 id="9-Action"><a href="#9-Action" class="headerlink" title="9.Action"></a>9.Action</h2><p>目标：</p>
<ul>
<li>了解 Action 的作用是什么</li>
<li>掌握如何定义 Action</li>
<li>掌握如何调用 Action</li>
</ul>
<p>Action 类似于 mutation，不同在于：</p>
<ul>
<li>Action 提交的是 mutation，而不是直接变更状态。</li>
<li>Action 可以包含任意异步操作。</li>
</ul>
<h3 id="9-1-定义-Action"><a href="#9-1-定义-Action" class="headerlink" title="9.1. 定义 Action"></a>9.1. 定义 Action</h3><p>让我们来注册一个简单的 action：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> state: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  count: <span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> mutations: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  increment(state) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   state.count++;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> actions: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  increment(context) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 执行异步操作</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 提交 mutation 更新 state</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    context.commit(<span class="string">"increment"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;, <span class="number">1000</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象，因此你可以调用<br><code>context.commit</code> 提交一个 mutation。<br>Action 通过<code>store.dispatch</code>方法触发：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">store.dispatch(<span class="string">"increment"</span>);</span></pre></td></tr></table></figure>

<p>例如我在组件中：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$store.dispatch('increment')"</span>&gt;</span>分发 Action<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr></table></figure>

<p>Actions 和 Mutation 一样，也支持自定义传参：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 只有一个参数 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$store.dispatch('increment', 10)"</span>&gt;</span>分发 Action<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 多个参数放到一个对象中 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"$store.dispatch('increment', &#123; n: 10, m: 20 &#125;)"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> 分发 Action</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr></table></figure>

<p>总结：</p>
<ul>
<li>action 中异步操作结束以后，提交 mutation 来修改 state</li>
<li><strong>注意：也不要在 action 中直接修改 state，永远通过 mutation 来修改 state</strong></li>
<li>action 函数的第 1 个参数是容器对象</li>
<li>action 也可以像 mutation 函数一样自定义传参</li>
</ul>
<h2 id="10-Vuex-状态管理流程"><a href="#10-Vuex-状态管理流程" class="headerlink" title="10. Vuex 状态管理流程"></a>10. Vuex 状态管理流程</h2><h3 id="10-1-同步操作"><a href="#10-1-同步操作" class="headerlink" title="10.1. 同步操作"></a>10.1. 同步操作</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/vuex%E5%90%8C%E6%AD%A5.png" alt="vuex同步"></p>
<ul>
<li>组件通过 Commit 调用 Mutations 中的方法</li>
<li>Mutations 执行内部逻辑修改 State 数据 ，同时在调试工具 Devtools 上显示对应变化内容</li>
<li>State 变化影响组件视图更新</li>
</ul>
<h3 id="10-2-异步操作"><a href="#10-2-异步操作" class="headerlink" title="10.2 异步操作"></a>10.2 异步操作</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/vuex.png" alt></p>
<ul>
<li>组件通过 Dispatch 调用 Actions 中的方法</li>
<li>Actions 中的方法通过 Commit 调用 Mutations 中的方法</li>
<li>Mutations 执行内部逻辑修改 State 数据 ，同时在调试工具 Devtools 上显示对应变化内容</li>
<li>State 变化影响组件视图更新</li>
</ul>
<p><strong>注意点：</strong></p>
<ul>
<li><strong>不要在 action 中直接修改 state，调试工具工作有问题</strong></li>
<li><strong>也不要在 mutation 中执行异步操作修改 state，调试工具工作有问题</strong></li>
<li><strong>只有 mutation 中修改 state 才能反应到调试工具中</strong></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>WebSocket的简单了解和使用</title>
    <url>/%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8/WebSocket%E7%9A%84%E7%AE%80%E5%8D%95%E4%BA%86%E8%A7%A3%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h2 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/bg2017051501.png" alt="img"></p>
<ul>
<li>WebSocket 是一种数据通信协议，类似于我们常见的 http</li>
<li>既然有 http，为啥还要 WebSocket</li>
<li>http 通信是单向的<ul>
<li>请求 + 响应</li>
<li>没有请求也就没有响应</li>
</ul>
</li>
</ul>
<p>初次接触 WebSocket 的人，都会问同样的问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它能带来什么好处？</p>
<a id="more"></a>

<p>答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。</p>
<p>举例来说，我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。</p>
<p>这种单向请求的特点，注定了如果服务器有连续的状态变化，客户端要获知就非常麻烦。我们只能使用<a href="https://www.pubnub.com/blog/2014-12-01-http-long-polling/" target="_blank" rel="noopener">“轮询”</a>：每隔一段时候，就发出一个询问，了解服务器有没有新的信息。最典型的场景就是聊天室。</p>
<p>轮询的效率低，非常浪费资源（因为必须不停连接，或者 HTTP 连接始终打开）。因此，工程师们一直在思考，有没有更好的方法。WebSocket 就是这样发明的。</p>
<p>WebSocket 协议在 2008 年诞生，2011 年成为国际标准。所有浏览器都已经支持了。</p>
<p>它的最大特点就是，<strong>服务器可以主动向客户端推送信息</strong>，<strong>客户端也可以主动向服务器发送信息</strong>，是真正的<strong>双向平等对话</strong>，属于<a href="https://en.wikipedia.org/wiki/Push_technology" target="_blank" rel="noopener">服务器推送技术</a>的一种。</p>
<p>简单理解：</p>
<p>HTTP 打电话：</p>
<ul>
<li>我问一句</li>
<li>你回答一句</li>
<li>没有提问就没有回答，即便对方主动给你说话，我也是个聋子听不见</li>
</ul>
<p>WebSocket 打电话：</p>
<ul>
<li>双向对话</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/bg2017051502.png" alt="img"></p>
<blockquote>
<p>HTTP 和 WebSocket 通信模型</p>
</blockquote>
<p>其他特点包括：</p>
<p>（1）建立在 TCP 协议之上，服务器端的实现比较容易。</p>
<p>（2）与 HTTP 协议有着良好的兼容性。默认端口也是 80 和 443，并且握手阶段（第 1 次建立连接）采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</p>
<p>（3）数据格式比较轻量，性能开销小，通信高效。</p>
<p>（4）可以发送文本，也可以发送二进制数据。</p>
<p>（5）没有同源跨域限制，客户端可以与任意服务器通信。</p>
<p>（6）协议标识符是<code>ws</code>（如果加密，则为<code>wss</code>），服务器网址就是 URL。</p>
<p>（7）浏览器专门为 WebSocket 通信提供了一个请求对象 <code>WebSocket</code></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">ws:<span class="regexp">//</span>example.com:<span class="number">80</span><span class="regexp">/some/</span>path</span></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/bg2017051503.jpg" alt="img"></p>
<h2 id="使用原生-WebSocket（了解）"><a href="#使用原生-WebSocket（了解）" class="headerlink" title="使用原生 WebSocket（了解）"></a>使用原生 WebSocket（了解）</h2><blockquote>
<p>参考文档：</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket" target="_blank" rel="noopener">MDN - WebSocket</a></li>
</ul>
</blockquote>
<p>浏览器为 HTTP 通信提供了 <code>XMLHttpRequest</code> 对象，同样的，也为 WebSocket 通信提供了一个通信操作接口：<code>WebSocket</code>。</p>
<p>通信模型：</p>
<ul>
<li>拨号（建立连接）</li>
<li>通话（双向通信）</li>
<li>结束通话（关闭连接）</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// WebSocet 通信模型</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 1. 拨打电话（建立连接）</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 注意：wss://echo.websocket.org 是一个在线的测试接口，仅用于 WebSocket 协议通信测试使用</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"wss://echo.websocket.org"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 当连接建立成功，触发 open 事件</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   ws.onopen = <span class="function"><span class="keyword">function</span> <span class="params">(evt)</span> </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"建立连接成功 ..."</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="comment">// 连接建立成功以后，就可以使用这个连接对象通信了</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="comment">// send 方法发送数据</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    ws.send(<span class="string">"Hello WebSockets!"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 当接收到对方发送的消息的时候，触发 message 事件</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 我们可以通过回调函数的 evt.data 获取对方发送的数据内容</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   ws.onmessage = <span class="function"><span class="keyword">function</span> <span class="params">(evt)</span> </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"接收到消息: "</span> + evt.data);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="comment">// 当不需要通信的时候，可以手动的关闭连接</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="comment">// ws.close();</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 当连接断开的时候触发 close 事件</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   ws.onclose = <span class="function"><span class="keyword">function</span> <span class="params">(evt)</span> </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"连接已关闭."</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>

<p>怎么查看 WebSocket 请求日志：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1569575005360.png" alt="1569575005360"></p>
<blockquote>
<p>朝上的绿色箭头是发出去的消息</p>
<p>朝下的红色箭头是收到的消息</p>
</blockquote>
<h2 id="Socket-IO（了解体验）"><a href="#Socket-IO（了解体验）" class="headerlink" title="Socket.IO（了解体验）"></a>Socket.IO（了解体验）</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul>
<li>原生的 WebSocket 使用比较麻烦，所以推荐使用一个封装好的解决方案：socket.io</li>
<li>socket.io 提供了服务端 + 客户端的实现<ul>
<li>客户端：浏览器</li>
<li>服务端：Java、Python、PHP、。。。。Node.js</li>
</ul>
</li>
<li>对于前端开发者来说，只需要关心她的客户端如何使用即可</li>
<li>注意：Socket.io 必须前后端配套使用<ul>
<li>实际工作中，socket.io 已经成为了各大后端开发的 WebSocket 通信主流解决方案</li>
</ul>
</li>
<li><a href="https://github.com/socketio/socket.io" target="_blank" rel="noopener">GitHub 仓库</a></li>
<li><a href="https://socket.io/" target="_blank" rel="noopener">官网</a></li>
</ul>
<p>Socket.io 和 WebSocket 就好比它就好比 axios 和 XMLHTTPRequest 的关系。</p>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>官方的 Hello World：<a href="https://socket.io/get-started/chat/" target="_blank" rel="noopener">https://socket.io/get-started/chat/</a>。</p>
<p>服务端代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="built_in">require</span>(<span class="string">"express"</span>)();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>).createServer(app);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> io = <span class="built_in">require</span>(<span class="string">"socket.io"</span>)(http);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">app.get(<span class="string">"/"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> res.sendFile(__dirname + <span class="string">"/index.html"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">io.on(<span class="string">"connection"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> socket.on(<span class="string">"disconnect"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"user disconnected"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> socket.on(<span class="string">"chat message"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  io.emit(<span class="string">"chat message"</span>, msg);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">http.listen(<span class="number">3000</span>, <span class="string">"0.0.0.0"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="string">"listening on *:3000"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<p>客户端代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Socket.IO chat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   * &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    margin: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    box-sizing: border-box;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   body &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    font: 13px Helvetica, Arial;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   form &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#000</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 3px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    position: fixed;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    bottom: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    width: 100%;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   form input &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    border: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 10px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    width: 90%;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">    <span class="selector-tag">margin-right</span>: 0<span class="selector-class">.5</span>%;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   form button &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    width: 9%;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    background: rgb(130, 224, 255);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    border: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 10px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">   <span class="selector-id">#messages</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    list-style-type: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    margin: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">   <span class="selector-id">#messages</span> <span class="selector-tag">li</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    padding: 5px 10px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">   <span class="selector-id">#messages</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child(odd)</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#eee</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- 消息列表 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"messages"</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- 发送消息的表单 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"m"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span> /&gt;</span><span class="tag">&lt;<span class="name">button</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- SocketIO 提供了一个客户端实现：socket.io.js --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/socket.io/socket.io.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-1.11.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="comment">// 建立连接，得到 socket 通信对象</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="keyword">var</span> socket = io();</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   socket.on(<span class="string">"connect"</span>, () =&gt; &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"建立连接成功了"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   $(<span class="string">"form"</span>).submit(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    e.preventDefault(); <span class="comment">// prevents page reloading</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    socket.emit(<span class="string">"chat message"</span>, $(<span class="string">"#m"</span>).val());</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    $(<span class="string">"#m"</span>).val(<span class="string">""</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="keyword">return</span> <span class="literal">false</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   socket.on(<span class="string">"chat message"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(msg)</span> </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    $(<span class="string">"#messages"</span>).append($(<span class="string">"&lt;li&gt;"</span>).text(msg));</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>我们只需要关注客户端怎么使用：</p>
<ul>
<li>怎么建立连接</li>
<li>怎么发送消息</li>
<li>怎么接收消息</li>
</ul>
<p>建立连接：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> socket = io(<span class="string">"连接地址"</span>);</span></pre></td></tr></table></figure>

<p>发送数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 发送指定类型的消息</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 数据可以是任何类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">socket.emit(<span class="string">"消息类型"</span>, 数据);</span></pre></td></tr></table></figure>

<p>接收消息：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 消息类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 回调函数参数获取消息数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">socket.on(<span class="string">"消息类型"</span>, (data) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(data);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>

<blockquote>
<p>消息类型由后端给出，他会告诉你收发消息的类型，就好比 HTTP 接口中的请求路径一样。</p>
</blockquote>
<p>利用广播实现多人沟通</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//服务器端</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">io.on(<span class="string">"connection"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> socket.broadcast.emit(<span class="string">"有用户连接"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//这条信息会发送给除了当前socket的其他用户</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>网络应用</category>
      </categories>
      <tags>
        <tag>网络应用</tag>
      </tags>
  </entry>
  <entry>
    <title>elementUI的使用注意事项</title>
    <url>/elementUI/elementUI%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
    <content><![CDATA[<blockquote>
<p>这篇文章是我在工作中使用elementUi遇到的问题做的简单汇总，希望能对看到这篇文章的你有所帮助</p>
</blockquote>
<h2 id="el-table"><a href="#el-table" class="headerlink" title="el-table"></a>el-table</h2><h3 id="如何修改el-table展开树的三角图标"><a href="#如何修改el-table展开树的三角图标" class="headerlink" title="如何修改el-table展开树的三角图标"></a>如何修改el-table展开树的三角图标</h3><p>只需要给定before的content即可</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"> // 隐藏展开箭头</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-class">.el-table__expand-icon</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    // 修改展开箭头的样式</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="selector-class">.el-icon-arrow-right</span><span class="selector-pseudo">::before</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attribute">content</span>: <span class="string">"\e791"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>参考网址：<a href="https://blog.csdn.net/m0_37378152/article/details/102628860" target="_blank" rel="noopener">https://blog.csdn.net/m0_37378152/article/details/102628860</a></p>
<h3 id="elementUI的table-的每一项的min-width不要使用百分比"><a href="#elementUI的table-的每一项的min-width不要使用百分比" class="headerlink" title="elementUI的table 的每一项的min-width不要使用百分比"></a>elementUI的table 的每一项的min-width不要使用百分比</h3><blockquote>
<p>elementUI的table 的每一项的min-width不要使用百分比 ,不然会出现这种情况</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200227163411930.png" alt="image-20200227163411930"></p>
<blockquote>
<p>固定的序号和checkbox 会掉下来</p>
</blockquote>
<h3 id="修改el-table表头高度的坑"><a href="#修改el-table表头高度的坑" class="headerlink" title="修改el-table表头高度的坑"></a>修改el-table表头高度的坑</h3><blockquote>
<p>el-table 固定列的table，在dom上是有两个thead的所以要修改表头高度就一定要两个都修改 ，不然会导致固定列表头高度与正常表头高度不一致现象 ，在薪酬项目的代码示例</p>
</blockquote>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">//处理表头高度</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="selector-class">.el-table__header-wrapper</span> <span class="selector-tag">th</span> <span class="selector-class">.cell</span> <span class="selector-class">.edit-table-header</span> &gt; <span class="selector-tag">p</span> &gt; <span class="selector-tag">span</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="selector-class">.el-table__fixed-header-wrapper</span> <span class="selector-tag">th</span> <span class="selector-class">.cell</span> <span class="selector-class">.edit-table-header</span> &gt; <span class="selector-tag">p</span> &gt; <span class="selector-tag">span</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr></table></figure>

<h3 id="在dialog中使用table的问题"><a href="#在dialog中使用table的问题" class="headerlink" title="在dialog中使用table的问题"></a>在dialog中使用table的问题</h3><blockquote>
<p>在dialog中使用table发现无论怎样设置表头都会出现表头高度不正常现象 和数据不正常现象</p>
<p>这时可以使用dialog的destroy-on-close属性 （关闭时销毁 Dialog 中的元素）</p>
</blockquote>
<h3 id="el-table自定义动态表头：更新数据之后表头不更新"><a href="#el-table自定义动态表头：更新数据之后表头不更新" class="headerlink" title="el-table自定义动态表头：更新数据之后表头不更新"></a>el-table自定义动态表头：更新数据之后表头不更新</h3><p>在开发中 表头但是多级表头并且是动态遍历的 ，遍历的数据发生改变表头数据却没有更新</p>
<h4 id="问题出现原因："><a href="#问题出现原因：" class="headerlink" title="问题出现原因："></a>问题出现原因：</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">v-for</span>=<span class="string">"item in columnData"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">&lt;!--一级表头文字--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"header"</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-head"</span>&gt;</span>&#123;&#123;item.name &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">&lt;!--.........战略性省略业务代码.........--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></pre></td></tr></table></figure>

<p>排查了很久，后发现：在自定义表头的时候，由于是用的v-for循环生成的，因此会给每个循环体一个固定的key，导致数据频繁更新时，因为这个key没有变，所以el-table觉得表头数据是没有变化的，因此就只更新了整体表格数据、key值有变化的列的表头。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--表头的v-for中的key 使用 id + index 组合的形式使key变成动态的--&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in tableData"</span> <span class="attr">:key</span>=<span class="string">"item.id + index"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  .....</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="el-form"><a href="#el-form" class="headerlink" title="el-form"></a>el-form</h2><h3 id="elementUI的form表单数据resetFields重置方法注意事项"><a href="#elementUI的form表单数据resetFields重置方法注意事项" class="headerlink" title="elementUI的form表单数据resetFields重置方法注意事项"></a>elementUI的form表单数据resetFields重置方法注意事项</h3><p>this.$refs.form<a href>“resetFields”</a>;</p>
<p>form无法重置表单项的原因有以下四点：</p>
<ol>
<li>el-form-item的prop属性缺失或属性值 不等于 字段名称</li>
<li>表单项本身就有默认值</li>
<li>表单数据绑定时未使用$nextTick函数（resetFields 重置到挂载前的数据）</li>
<li>未显示的表单项无法重置</li>
</ol>
<h3 id="form-的坑-element-ui-form表单只有一个输入框获取焦点的时候回车会触发表单的submit事件，导致页面刷新"><a href="#form-的坑-element-ui-form表单只有一个输入框获取焦点的时候回车会触发表单的submit事件，导致页面刷新" class="headerlink" title="form 的坑  element ui form表单只有一个输入框获取焦点的时候回车会触发表单的submit事件，导致页面刷新"></a>form 的坑  element ui form表单只有一个输入框获取焦点的时候回车会触发表单的submit事件，导致页面刷新</h3><p><strong>解决方法：</strong></p>
<blockquote>
<p>当一个 form 元素中只有一个输入框时，在该输入框中按下回车应提交该表单。如果希望阻止这一默认行为，可以在 标签上添加 @submit.native.prevent。</p>
</blockquote>
<h2 id="tree"><a href="#tree" class="headerlink" title="tree"></a>tree</h2><h3 id="elementUI的tree的loadData-从新加载节点方法使用"><a href="#elementUI的tree的loadData-从新加载节点方法使用" class="headerlink" title="elementUI的tree的loadData()从新加载节点方法使用"></a>elementUI的tree的loadData()从新加载节点方法使用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 更新节点数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.currentNode.loaded = <span class="literal">false</span>;  <span class="comment">//需要配合node.loaded = false 使用</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.currentNode.loadData();</span></pre></td></tr></table></figure>

<h3 id="elementUI-tree未展开的子节点数据改变却不更新的bug"><a href="#elementUI-tree未展开的子节点数据改变却不更新的bug" class="headerlink" title="elementUI tree未展开的子节点数据改变却不更新的bug"></a>elementUI tree未展开的子节点数据改变却不更新的bug</h3><p>不采用懒加载方式直接改变tree的data数据发现为展开的子节点数据改变，展开后展示的数据却未变，</p>
<p>查看文档发现有个属性<code>render-after-expand</code>是否在第一次展开某个树节点后才渲染其子节点,</p>
<p>设置为<code>false</code>就可以解决了</p>
<h3 id="element-的tree的懒加载使用方法"><a href="#element-的tree的懒加载使用方法" class="headerlink" title="element 的tree的懒加载使用方法"></a>element 的tree的懒加载使用方法</h3><h4 id="load属性"><a href="#load属性" class="headerlink" title="load属性"></a>load属性</h4><p>懒加载子树数据的方法，需要配合lazy 属性为true 时生效，点开当前节点时就会触发；  类型：function(node, resolve)</p>
<p><strong>node：</strong></p>
<ul>
<li>id: 26</li>
<li>text: null</li>
<li>checked: false</li>
<li>indeterminate: false</li>
<li>data: Object  当前绑定的data</li>
<li>expanded: true</li>
<li>parent: Node  父节点</li>
<li>visible: true</li>
<li>isCurrent: false</li>
<li>store: TreeStore</li>
<li>level: 4      当前在第几级</li>
<li>loaded: true</li>
<li>childNodes: Array(5) 子节点</li>
<li>loading: false</li>
<li>isLeaf: false</li>
<li>label: “中非莱基” 绑定显示的文字</li>
<li>key: undefined</li>
<li>disabled: “”</li>
<li>nextSibling: Node</li>
<li>previousSibling: Node</li>
</ul>
<p><strong>resolve:</strong>接收子节点的data 自动绑定到树上</p>
<h4 id="props属性"><a href="#props属性" class="headerlink" title="props属性"></a>props属性</h4><p>定义data中的绑定项的key</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">说明</th>
<th align="left">类型</th>
<th align="left">可选值</th>
<th align="left">默认值</th>
</tr>
</thead>
<tbody><tr>
<td align="left">label</td>
<td align="left">指定节点标签为节点对象的某个属性值</td>
<td align="left">string, function(data, node)</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">children</td>
<td align="left">指定子树为节点对象的某个属性值</td>
<td align="left">string</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">disabled</td>
<td align="left">指定节点选择框是否禁用为节点对象的某个属性值</td>
<td align="left">boolean, function(data, node)</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">isLeaf</td>
<td align="left">指定节点是否为叶子节点，仅在指定了 lazy 属性的情况下生效</td>
<td align="left">boolean, function(data, node)</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
</tbody></table>
<h2 id="el-input"><a href="#el-input" class="headerlink" title="el-input"></a>el-input</h2><h3 id="el-input-同过正则限制只能输入正数可以带小数点-但不生效问题"><a href="#el-input-同过正则限制只能输入正数可以带小数点-但不生效问题" class="headerlink" title="el-input 同过正则限制只能输入正数可以带小数点 但不生效问题"></a>el-input 同过正则限制只能输入正数可以带小数点 但不生效问题</h3><p>代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;el-input</span></pre></td></tr><tr><td class="code"><pre><span class="line">    type=<span class="string">"text"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    v-model.number=<span class="string">"editingFormData.salary"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    oninput=<span class="string">"value=value.replace(/^\D*(\d*(?:\.\d&#123;0,2&#125;)?).*$/g, '$1')"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt;<span class="xml"><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span></span></pre></td></tr></table></figure>

<blockquote>
<p>正则一直不好 无法输入小数点 ， 是因为加了number 修饰符无法输入小数点， 找了我一个多小时啊</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/%E6%AD%A3%E5%88%99%E4%B8%8D%E7%94%9F%E6%95%88%E5%8E%9F%E5%9B%A0.jpg" alt="正则不生效原因"></p>
<h3 id="工作中出现的—表头带input搜索框-搜索后点击表格会刷新数据bug"><a href="#工作中出现的—表头带input搜索框-搜索后点击表格会刷新数据bug" class="headerlink" title="工作中出现的—表头带input搜索框 搜索后点击表格会刷新数据bug"></a>工作中出现的—表头带input搜索框 搜索后点击表格会刷新数据bug</h3><blockquote>
<p>表格带表头input搜索的结构 搜索需要回车，  发现每次搜索回车后 点击表格或其他地方， 表格会刷新一下，经同事指点打开Network 发现 ，点击其他地方会发次请求，打开table组件的源码发现 被别的同事添加了@blur失去焦点事件，并且与回车事件调用同一个函数，因为回车不会使input框失去焦点，点击表格其他地方时input失去焦点导致再次触发搜索，所有好像自己刷新了一下的样子。 下面是表格内input的代码</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">el-input</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        <span class="attr">v-if</span>=<span class="string">"[undefined, '', 'input', 'button', 'string'].includes(field.fieldType)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        <span class="attr">v-bind</span>=<span class="string">"field.headerSearchAttrs"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        <span class="attr">v-model.trim</span>=<span class="string">"field.inputValue"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        <span class="attr">clearable</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        <span class="attr">:placeholder</span>=<span class="string">"field.label"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        @<span class="attr">keyup.enter.native</span>=<span class="string">"handleBlur(field.prop, field.inputValue)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        @<span class="attr">blur</span>=<span class="string">"handleBlur(field.prop, field.inputValue)"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">        @<span class="attr">clear</span>=<span class="string">"clearQueryInput"</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">    /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- @keyup.enter 和@blur调用同一函数产生的bug --&gt;</span></span></pre></td></tr></table></figure>

<h2 id><a href="#" class="headerlink" title></a></h2><h2 id="el-image"><a href="#el-image" class="headerlink" title="el-image"></a>el-image</h2><h3 id="elementUI的image的src加载vue系统或本地图片的方法（重要）"><a href="#elementUI的image的src加载vue系统或本地图片的方法（重要）" class="headerlink" title="elementUI的image的src加载vue系统或本地图片的方法（重要）"></a>elementUI的image的src加载vue系统或本地图片的方法（重要）</h3><blockquote>
<p>正常情况以下情形是不生效的， 会提示找不到图片 所以需要用到，原生的require方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div class&#x3D;&quot;message-item&quot; v-for&#x3D;&quot; (item ,index) in uploadMessage&quot; :key&#x3D;&quot;index&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;span class&#x3D;&quot;item-txt&quot;&gt;&#123;&#123;item.txt&#125;&#125;&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;el-image :src&#x3D;&quot;item.img&quot; :preview-src-list&#x3D;&quot;srcList&quot;&gt;&lt;&#x2F;el-image&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;div&gt;</span></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//js部分</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> uploadMessage = [</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   img: <span class="string">'@/hrwa/assets/taxset-information-management/taxset1.png'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   img: <span class="string">'@/hrwa/assets/taxset-information-management/taxset2.png'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   img: <span class="string">'@/hrwa/assets/taxset-information-management/taxset3.png'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   img: <span class="string">'@/hrwa/assets/taxset-information-management/taxset4.png'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> ]; <span class="comment">//提示</span></span></pre></td></tr></table></figure>

<blockquote>
<p>图片会显示加载失败 ，   修改后 的代码结构  如下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">uploadMessage = [</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  img: <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset1.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  img: <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset2.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  img: <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset3.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  txt: <span class="string">'1.进入税务系统'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  img: <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset4.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">];</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//大图地址也需要加require</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">srcList = [</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset1.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset2.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset3.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">require</span>(<span class="string">'@/hrwa/assets/taxset-information-management/taxset4.png'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">];</span></pre></td></tr></table></figure>

<h2 id="样式问题"><a href="#样式问题" class="headerlink" title="样式问题"></a>样式问题</h2><ul>
<li>table通过th display: table-cell !important; 控制在谷歌浏览器下边框不对齐问题</li>
<li>导航菜单选中项样式问题通过类名.is-active 设置</li>
<li>顶部logo部分的顶部栏的高度，和子项宽度 都是通过flex属性设置，flex ：0 0 220px</li>
<li>elementui的样式变量在E:\project\hr-web-container\node_modules\element-ui\packages\theme-chalk\src\common\var.scss内</li>
</ul>
]]></content>
      <categories>
        <category>elementUI</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>elementUI</tag>
      </tags>
  </entry>
  <entry>
    <title>NexT主题的设置 - hexo新版主题next7.x设置</title>
    <url>/hexo/next%E4%B8%BB%E9%A2%98%E7%9A%84%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<h1 id="hexo新版主题next7-x设置"><a href="#hexo新版主题next7-x设置" class="headerlink" title="hexo新版主题next7.x设置"></a>hexo新版主题next7.x设置</h1><p>内容提要</p>
<ul>
<li><p>开启赞赏打赏码</p>
</li>
<li><p>设置阅读时长和本文字数</p>
</li>
<li><p>添加背景动画效果</p>
</li>
<li><p>阅读全文设置</p>
</li>
<li><p>阅读全文 去掉自动定位more</p>
</li>
<li><p>修改文章及主题样式</p>
</li>
<li><p>代码段调整上下行距及样式</p>
</li>
<li><p>代码块背景色缺失问题</p>
</li>
</ul>
<a id="more"></a>

<h2 id="开启赞赏打赏码"><a href="#开启赞赏打赏码" class="headerlink" title="开启赞赏打赏码"></a>开启赞赏打赏码</h2><h3 id="1-获取支付宝和微信打赏码"><a href="#1-获取支付宝和微信打赏码" class="headerlink" title="1.获取支付宝和微信打赏码"></a>1.获取支付宝和微信打赏码</h3><ul>
<li>支付宝打赏码<ul>
<li><a href="https://qr.alipay.com/paipai/open.htm" target="_blank" rel="noopener">https://qr.alipay.com/paipai/open.htm</a></li>
</ul>
</li>
<li>微信打赏码<ul>
<li>打开手机微信</li>
<li>选择我的–支付</li>
<li>选择收付款–赞赏码</li>
<li>生成</li>
</ul>
</li>
</ul>
<h3 id="2-把生成的二维码下载放到next主题"><a href="#2-把生成的二维码下载放到next主题" class="headerlink" title="2.把生成的二维码下载放到next主题"></a>2.把生成的二维码下载放到next主题</h3><ul>
<li>放到themes\next\source\images文件夹中</li>
</ul>
<h3 id="3-配置主题-config-yml"><a href="#3-配置主题-config-yml" class="headerlink" title="3.配置主题_config.yml"></a>3.配置主题_config.yml</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward_settings:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># If true, reward will be displayed in every article by default.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span> <span class="comment">#是否开启动画效果 可以自己调整样式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">comment:</span> <span class="string">原创技术分享，您的支持将鼓励我继续创作!</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">reward:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">wechatpay:</span> <span class="string">/images/wechatpay.png</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">alipay:</span> <span class="string">/images/alipay.png</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">#paypal: /images/paypal.png</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">#bitcoin: /images/bitcoin.png</span></span></pre></td></tr></table></figure>

<h3 id="4-修改按钮样式"><a href="#4-修改按钮样式" class="headerlink" title="4.修改按钮样式"></a>4.修改按钮样式</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//路径 next/source/css/_common/components/post/post-reward.styl</span></pre></td></tr><tr><td class="code"><pre><span class="line">//简单的改了一下按钮样式</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">button</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">background</span>: transparent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">cursor</span>: pointer;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">line-height</span>: <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">outline</span>: none;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">vertical-align</span>: text-top;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &amp;:hover &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="selector-tag">background</span>: <span class="selector-id">#fc6423</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">transparent</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="selector-tag">color</span>: <span class="selector-id">#fff</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>

<h3 id="5-展示效果"><a href="#5-展示效果" class="headerlink" title="5.展示效果"></a>5.展示效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801125315315.png" alt="image-20200801125315315"></p>
<h2 id="设置阅读时长和本文字数"><a href="#设置阅读时长和本文字数" class="headerlink" title="设置阅读时长和本文字数"></a>设置阅读时长和本文字数</h2><h3 id="1-配置主题-config-yml"><a href="#1-配置主题-config-yml" class="headerlink" title="1.配置主题_config.yml"></a>1.配置主题_config.yml</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">false</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">awl:</span> <span class="number">2</span> <span class="comment">#平均字长</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">wpm:</span> <span class="number">200</span> <span class="comment">#每分钟字数</span></span></pre></td></tr></table></figure>

<blockquote>
<p>详细配置介绍 <a href="https://github.com/theme-next/hexo-symbols-count-time" target="_blank" rel="noopener">https://github.com/theme-next/hexo-symbols-count-time</a></p>
</blockquote>
<h3 id="2-对应文字修改"><a href="#2-对应文字修改" class="headerlink" title="2.对应文字修改"></a>2.对应文字修改</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#路径 next\languages\zh-CN.yml</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">count:</span> <span class="string">本文字数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">count_total:</span> <span class="string">站点总字数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">time:</span> <span class="string">阅读时长</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">time_total:</span> <span class="string">站点阅读时长</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">time_minutes:</span> <span class="string">分钟</span></span></pre></td></tr></table></figure>

<h3 id="3-展示效果"><a href="#3-展示效果" class="headerlink" title="3.展示效果"></a>3.展示效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801130036785.png" alt="image-20200801130036785"></p>
<h2 id="设置阅读次数和评论"><a href="#设置阅读次数和评论" class="headerlink" title="设置阅读次数和评论"></a>设置阅读次数和评论</h2><h3 id="建议添加gitalk评论系统"><a href="#建议添加gitalk评论系统" class="headerlink" title="建议添加gitalk评论系统"></a>建议添加gitalk评论系统</h3><p>参考文章：<a href="https://www.jianshu.com/p/02fc71f3633f" target="_blank" rel="noopener">https://www.jianshu.com/p/02fc71f3633f</a></p>
<h3 id="展示效果："><a href="#展示效果：" class="headerlink" title="展示效果："></a>展示效果：</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200916135526251.png" alt="image-20200916135526251"></p>
<h3 id="显示阅读次数"><a href="#显示阅读次数" class="headerlink" title="显示阅读次数"></a>显示阅读次数</h3><p>1.配置主题_config.yml</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">fa</span> <span class="string">fa-user</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span></pre></td></tr></table></figure>

<h3 id="展示效果：-1"><a href="#展示效果：-1" class="headerlink" title="展示效果："></a>展示效果：</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200916135902653.png" alt="image-20200916135902653"></p>
<h2 id="添加背景动画效果"><a href="#添加背景动画效果" class="headerlink" title="添加背景动画效果"></a>添加背景动画效果</h2><h3 id="1-配置主题-config-yml-1"><a href="#1-配置主题-config-yml-1" class="headerlink" title="1.配置主题_config.yml"></a>1.配置主题_config.yml</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进度条</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-pace  更改配置详情看github说明</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># For more information: https://github.com/HubSpot/pace</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">pace:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># Themes list:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">theme:</span> <span class="string">minimal</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 3D背景</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># JavaScript 3D library.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-three  更改配置详情看github说明</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">three:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">three_waves:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">canvas_lines:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">canvas_sphere:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 彩带背景</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Canvas-ribbon</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-ribbon 更改配置详情看github说明</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># For more information: https://github.com/zproo/canvas-ribbon</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">canvas_ribbon:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">size:</span> <span class="number">300</span> <span class="comment"># The width of the ribbon</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span> <span class="comment"># The transparency of the ribbon</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># The display level of the ribbo</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">#关键配置CDN</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">vendors:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># 进度条</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">pace:</span> <span class="string">//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">pace_css:</span> <span class="string">//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># 3D背景</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">three:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">three_waves:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">canvas_lines:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_lines.min.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">canvas_sphere:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_sphere.min.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># 彩带背景</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">canvas_ribbon:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js</span></span></pre></td></tr></table></figure>

<h3 id="2-本地查看效果"><a href="#2-本地查看效果" class="headerlink" title="2.本地查看效果"></a>2.本地查看效果</h3><ol>
<li>转到NexT目录</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">$ cd themes/next</span></pre></td></tr><tr><td class="code"><pre><span class="line">$ ls</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">_config</span>.</span></span>yml  crowdin.yml  docs  gulpfile.js  languages  layout  <span class="module-access"><span class="module"><span class="identifier">LICENSE</span>.</span></span>md  package.json  <span class="module-access"><span class="module"><span class="identifier">README</span>.</span></span>md  scripts  source</span></pre></td></tr></table></figure>

<ol start="2">
<li>将模块安装到<code>source/lib</code>目录</li>
</ol>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">git clone <span class="symbol">https:</span>/<span class="regexp">/github.com/theme</span>-<span class="keyword">next</span>/theme-<span class="keyword">next</span>-three source/<span class="class"><span class="keyword">lib</span>/<span class="title">three</span></span></span></pre></td></tr></table></figure>

<ol start="3">
<li>启动服务查看效果</li>
</ol>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo s</span></span></pre></td></tr></table></figure>

<h3 id="3-展示效果-1"><a href="#3-展示效果-1" class="headerlink" title="3.展示效果"></a>3.展示效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/next%E8%83%8C%E6%99%AF%E5%BD%A9%E5%B8%A6%E5%B1%95%E7%A4%BA%E6%95%88%E6%9E%9C.gif" alt="next背景彩带展示效果"></p>
<h2 id="阅读全文设置"><a href="#阅读全文设置" class="headerlink" title="阅读全文设置"></a>阅读全文设置</h2><h3 id="1-配置主题-config-yml-2"><a href="#1-配置主题-config-yml-2" class="headerlink" title="1.配置主题_config.yml"></a>1.配置主题_config.yml</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Automatically excerpt description in homepage as preamble text.  自动摘要</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">excerpt_description:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># Read more button</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># If true, the read more button will be displayed in excerpt section. 显示阅读全文按钮</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">read_more_btn:</span> <span class="literal">true</span></span></pre></td></tr></table></figure>

<h3 id="2-install自动摘录生成器"><a href="#2-install自动摘录生成器" class="headerlink" title="2.install自动摘录生成器"></a>2.install自动摘录生成器</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-excerpt <span class="comment">--save</span></span></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>比较不好的一点是这个只能自动读取摘要 不是很智能 ，读取的摘要狠多 ，推荐编写文章时自己设置摘要</p>
</li>
<li><p>若想保留了样式并且自行选择显示哪些内容来预览。就可以在写md博文时，在想要显示预览的部分后加上<code>&lt;I--more--&gt;</code>，这样这样首页和列表页展示的文章内容就是<code>&lt;!--more--&gt;</code>之前的文字，而之后的就不会显示了，同时也保留文章原样式。</p>
</li>
</ul>
</blockquote>
<h3 id="3-展示效果-2"><a href="#3-展示效果-2" class="headerlink" title="3.展示效果"></a>3.展示效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801163505378.png" alt="image-20200801163505378"></p>
<h2 id="阅读全文-去掉自动定位more"><a href="#阅读全文-去掉自动定位more" class="headerlink" title="阅读全文 去掉自动定位more"></a>阅读全文 去掉自动定位more</h2><p>老版本中可以使用<code>scroll_to_more: false</code> 这个选项</p>
<p>最新版本已经移除此选项，官方认为scroll_to_more是个默认行为for任何hexo主题</p>
<p>新版本解决方案：强制修改\themes\next\layout_macro\post.swig中</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a class&#x3D;&quot;btn&quot; href&#x3D;&quot;&#123;&#123; url_for(post.path) &#125;&#125;#more&quot; rel&#x3D;&quot;contents&quot;&gt;</span></pre></td></tr></table></figure>

<p>修改为 去除#more 锚点即可</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for(post.path) &#125;&#125;"</span> <span class="attr">rel</span>=<span class="string">"contents"</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="修改文章及主题样式"><a href="#修改文章及主题样式" class="headerlink" title="修改文章及主题样式"></a>修改文章及主题样式</h2><h3 id="修改文件位置"><a href="#修改文件位置" class="headerlink" title="修改文件位置"></a>修改文件位置</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//themes\next\source\css\_common\scaffolding\base.styl</span></pre></td></tr><tr><td class="code"><pre><span class="line">//将样式手动调整</span></pre></td></tr><tr><td class="code"><pre><span class="line">//修改行距只需要修改p标签的margin</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">//引用样式调整</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">blockquote</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">border-left</span>: <span class="number">4px</span> solid $grey-lighter;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blockquote-color);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">cite</span>::before &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    content: <span class="string">'-'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">5px</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="代码段调整上下行距及样式"><a href="#代码段调整上下行距及样式" class="headerlink" title="代码段调整上下行距及样式"></a>代码段调整上下行距及样式</h2><h3 id="1-配置主题-config-yml-3"><a href="#1-配置主题-config-yml-3" class="headerlink" title="1.配置主题_config.yml"></a>1.配置主题_config.yml</h3><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#代码块样式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># Code Highlight theme</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># Available values: normal | night | night eighties | night blue | night bright | solarized | solarized dark | galactic</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># See: https://github.com/chriskempson/tomorrow-theme  白色主题 normal</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">highlight_theme:</span> <span class="string">normal</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment"># Add copy button on codeblock 复制按钮</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attr">copy_button:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment"># Show text copy result.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">show_result:</span> <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment"># Available values: default | flat | mac</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">style:</span> <span class="string">mac</span></span></pre></td></tr></table></figure>

<h3 id="2-调整样式文件"><a href="#2-调整样式文件" class="headerlink" title="2.调整样式文件"></a>2.调整样式文件</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//文件位置：themes\next\source\css\_common\scaffolding\highlight\highlight.styl</span></span></pre></td></tr></table></figure>

<p>搜索pre 将对应的padding值调整为自己想要的样式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">pre</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  @extend $code-block;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">auto</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  padding: 2px 10px;  //我这里上下调整为2px</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="3-展示效果-3"><a href="#3-展示效果-3" class="headerlink" title="3.展示效果"></a>3.展示效果</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801171206790.png" alt="image-20200801171206790"></p>
<h2 id="代码块背景色缺失问题"><a href="#代码块背景色缺失问题" class="headerlink" title="代码块背景色缺失问题"></a>代码块背景色缺失问题</h2><h3 id="1-问题展示"><a href="#1-问题展示" class="headerlink" title="1.问题展示"></a>1.问题展示</h3><blockquote>
<p>有时候编辑后的md文档会发生背景色缺失现象   如图</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801172746730.png" alt="image-20200801172746730"></p>
<h3 id="2-形成原因"><a href="#2-形成原因" class="headerlink" title="2.形成原因"></a>2.形成原因</h3><blockquote>
<p>原因：编辑时回车 换行，会导致当前行渲染后元素高度无法达到正常高度，如图：</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801175234139.png" alt="image-20200801175234139"></p>
<blockquote>
<p>正常的pre也就是当前行如图：</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200801175338090.png" alt="image-20200801175338090"></p>
<blockquote>
<p>而每行tr都有自己的背景色 （一般是白色），一但pre没有高度 ,就会造成背景色的混乱</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//mian.css 下有段用于区分斑马纹表格和 hover样式的代码影响到了代码段的tr</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">tbody</span> <span class="selector-tag">tr</span><span class="selector-pseudo">:nth-of-type(odd)</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--table-row-odd-bg-color);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="selector-tag">tbody</span> <span class="selector-tag">tr</span><span class="selector-pseudo">:hover</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--table-row-hover-bg-color);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h3 id="3-解决方案"><a href="#3-解决方案" class="headerlink" title="3.解决方案"></a>3.解决方案</h3><p><strong>1.在编辑md文档代码块时 回车换行都加个空格防止pre没有正常高度的情况</strong></p>
<blockquote>
<p>但是很麻烦 ， 所以还是用css调调样式吧</p>
<p>因为pre没有高度 tr把背景色覆盖成了其他颜色， 但是td还是正常大小啊 ，把td的背景色调调成pre的就可以了</p>
</blockquote>
<p><strong>2.修改css样式</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//文件位置：themes\next\source\css\_common\scaffolding\highlight\highlight.styl</span></pre></td></tr><tr><td class="code"><pre><span class="line">//找到td修改样式</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="selector-tag">td</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    background: $highlight-background;//防止背景色缺失</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="selector-tag">td</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    background: $highlight-background;//防止背景色缺失</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>next</tag>
        <tag>NexT</tag>
      </tags>
  </entry>
  <entry>
    <title>npm scripts  使用指南</title>
    <url>/npm/npm-scripts-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
    <content><![CDATA[<blockquote>
<p>本片文章转载于阮一峰老师的博客：<a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html</a></p>
</blockquote>
<p>Node 开发离不开 npm，而脚本功能是 npm 最强大、最常用的功能之一。</p>
<p>本文介绍如何使用 npm 脚本（npm scripts）。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/bg2016101101.jpg" alt="img"></p>
<h2 id="一、什么是-npm-脚本？"><a href="#一、什么是-npm-脚本？" class="headerlink" title="一、什么是 npm 脚本？"></a>一、什么是 npm 脚本？</h2><p>npm 允许在<code>package.json</code>文件里面，使用<code>scripts</code>字段定义脚本命令。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"scripts"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"build"</span>: <span class="string">"node build.js"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码是<code>package.json</code>文件的一个片段，里面的<code>scripts</code>字段是一个对象。它的每一个属性，对应一段脚本。比如，<code>build</code>命令对应的脚本是<code>node build.js</code>。</p>
<p>命令行下使用<code>npm run</code>命令，就可以执行这段脚本。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm run build</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 等同于执行</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ node build.js</span></pre></td></tr></table></figure>
</blockquote>
<p>这些定义在<code>package.json</code>里面的脚本，就称为 npm 脚本。它的优点很多。</p>
<blockquote>
<ul>
<li>项目的相关脚本，可以集中在一个地方。</li>
<li>不同项目的脚本命令，只要功能相同，就可以有同样的对外接口。用户不需要知道怎么测试你的项目，只要运行<code>npm run test</code>即可。</li>
<li>可以利用 npm 提供的很多辅助功能。</li>
</ul>
</blockquote>
<p>查看当前项目的所有 npm 脚本命令，可以使用不带任何参数的<code>npm run</code>命令。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm run</span></pre></td></tr></table></figure>
</blockquote>
<h2 id="二、原理"><a href="#二、原理" class="headerlink" title="二、原理"></a>二、原理</h2><p>npm 脚本的原理非常简单。每当执行<code>npm run</code>，就会自动新建一个 Shell，在这个 Shell 里面执行指定的脚本命令。因此，只要是 Shell（一般是 Bash）可以运行的命令，就可以写在 npm 脚本里面。</p>
<p>比较特别的是，<code>npm run</code>新建的这个 Shell，会将当前目录的<code>node_modules/.bin</code>子目录加入<code>PATH</code>变量，执行结束后，再将<code>PATH</code>变量恢复原样。</p>
<p>这意味着，当前目录的<code>node_modules/.bin</code>子目录里面的所有脚本，都可以直接用脚本名调用，而不必加上路径。比如，当前项目的依赖里面有 Mocha，只要直接写<code>mocha test</code>就可以了。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"test"</span>: <span class="string">"mocha test"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>而不用写成下面这样。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"test"</span>: <span class="string">"./node_modules/.bin/mocha test"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>由于 npm 脚本的唯一要求就是可以在 Shell 执行，因此它不一定是 Node 脚本，任何可执行文件都可以写在里面。</p>
<p>npm 脚本的退出码，也遵守 Shell 脚本规则。如果退出码不是<code>0</code>，npm 就认为这个脚本执行失败。</p>
<h2 id="三、通配符"><a href="#三、通配符" class="headerlink" title="三、通配符"></a>三、通配符</h2><p>由于 npm 脚本就是 Shell 脚本，因为可以使用 Shell 通配符。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"lint"</span>: <span class="string">"jshint *.js"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"lint"</span>: <span class="string">"jshint **/*.js"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，<code>*</code>表示任意文件名，<code>**</code>表示任意一层子目录。</p>
<p>如果要将通配符传入原始命令，防止被 Shell 转义，要将星号转义。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"test"</span>: <span class="string">"tap test/\*.js"</span></span></pre></td></tr></table></figure>
</blockquote>
<h2 id="四、传参"><a href="#四、传参" class="headerlink" title="四、传参"></a>四、传参</h2><p>向 npm 脚本传入参数，要使用<code>--</code>标明。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"lint"</span>: <span class="string">"jshint **.js"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>向上面的<code>npm run lint</code>命令传入参数，必须写成下面这样。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm run lint --  --reporter checkstyle &gt; checkstyle.xml</span></pre></td></tr></table></figure>
</blockquote>
<p>也可以在<code>package.json</code>里面再封装一个命令。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"lint"</span>: <span class="string">"jshint **.js"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"lint:checkstyle"</span>: <span class="string">"npm run lint -- --reporter checkstyle &gt; checkstyle.xml"</span></span></pre></td></tr></table></figure>
</blockquote>
<h2 id="五、执行顺序"><a href="#五、执行顺序" class="headerlink" title="五、执行顺序"></a>五、执行顺序</h2><p>如果 npm 脚本里面需要执行多个任务，那么需要明确它们的执行顺序。</p>
<p>如果是并行执行（即同时的平行执行），可以使用<code>&amp;</code>符号。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm run script1.js &amp; npm run script2.js</span></pre></td></tr></table></figure>
</blockquote>
<p>如果是继发执行（即只有前一个任务成功，才执行下一个任务），可以使用<code>&amp;&amp;</code>符号。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm run script1.js &amp;&amp; npm run script2.js</span></pre></td></tr></table></figure>
</blockquote>
<p>这两个符号是 Bash 的功能。此外，还可以使用 node 的任务管理模块：<a href="https://github.com/paulpflug/script-runner" target="_blank" rel="noopener">script-runner</a>、<a href="https://github.com/mysticatea/npm-run-all" target="_blank" rel="noopener">npm-run-all</a>、<a href="https://github.com/coderaiser/redrun" target="_blank" rel="noopener">redrun</a>。</p>
<h2 id="六、默认值"><a href="#六、默认值" class="headerlink" title="六、默认值"></a>六、默认值</h2><p>一般来说，npm 脚本由用户提供。但是，npm 对两个脚本提供了默认值。也就是说，这两个脚本不用定义，就可以直接使用。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"start"</span>: <span class="string">"node server.js"</span>，</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"install"</span>: <span class="string">"node-gyp rebuild"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，<code>npm run start</code>的默认值是<code>node server.js</code>，前提是项目根目录下有<code>server.js</code>这个脚本；<code>npm run install</code>的默认值是<code>node-gyp rebuild</code>，前提是项目根目录下有<code>binding.gyp</code>文件。</p>
<h2 id="七、钩子"><a href="#七、钩子" class="headerlink" title="七、钩子"></a>七、钩子</h2><p>npm 脚本有<code>pre</code>和<code>post</code>两个钩子。举例来说，<code>build</code>脚本命令的钩子就是<code>prebuild</code>和<code>postbuild</code>。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"prebuild"</span>: <span class="string">"echo I run before the build script"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"build"</span>: <span class="string">"cross-env NODE_ENV=production webpack"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"postbuild"</span>: <span class="string">"echo I run after the build script"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>用户执行<code>npm run build</code>的时候，会自动按照下面的顺序执行。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run prebuild &amp;&amp; npm run build &amp;&amp; npm run postbuild</span></pre></td></tr></table></figure>
</blockquote>
<p>因此，可以在这两个钩子里面，完成一些准备工作和清理工作。下面是一个例子。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"clean"</span>: <span class="string">"rimraf ./dist &amp;&amp; mkdir dist"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"prebuild"</span>: <span class="string">"npm run clean"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"build"</span>: <span class="string">"cross-env NODE_ENV=production webpack"</span></span></pre></td></tr></table></figure>
</blockquote>
<p>npm 默认提供下面这些钩子。</p>
<blockquote>
<ul>
<li>prepublish，postpublish</li>
<li>preinstall，postinstall</li>
<li>preuninstall，postuninstall</li>
<li>preversion，postversion</li>
<li>pretest，posttest</li>
<li>prestop，poststop</li>
<li>prestart，poststart</li>
<li>prerestart，postrestart</li>
</ul>
</blockquote>
<p>自定义的脚本命令也可以加上<code>pre</code>和<code>post</code>钩子。比如，<code>myscript</code>这个脚本命令，也有<code>premyscript</code>和<code>postmyscript</code>钩子。不过，双重的<code>pre</code>和<code>post</code>无效，比如<code>prepretest</code>和<code>postposttest</code>是无效的。</p>
<p>npm 提供一个<code>npm_lifecycle_event</code>变量，返回当前正在运行的脚本名称，比如<code>pretest</code>、<code>test</code>、<code>posttest</code>等等。所以，可以利用这个变量，在同一个脚本文件里面，为不同的<code>npm scripts</code>命令编写代码。请看下面的例子。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> TARGET = process.env.npm_lifecycle_event;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (TARGET === <span class="string">'test'</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the test task!`</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (TARGET === <span class="string">'pretest'</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the pretest task!`</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (TARGET === <span class="string">'posttest'</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the posttest task!`</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>注意，<code>prepublish</code>这个钩子不仅会在<code>npm publish</code>命令之前运行，还会在<code>npm install</code>（不带任何参数）命令之前运行。这种行为很容易让用户感到困惑，所以 npm 4 引入了一个新的钩子<code>prepare</code>，行为等同于<code>prepublish</code>，而从 npm 5 开始，<code>prepublish</code>将只在<code>npm publish</code>命令之前运行。</p>
<h2 id="八、简写形式"><a href="#八、简写形式" class="headerlink" title="八、简写形式"></a>八、简写形式</h2><p>四个常用的 npm 脚本有简写形式。</p>
<blockquote>
<ul>
<li><code>npm start</code>是<code>npm run start</code></li>
<li><code>npm stop</code>是<code>npm run stop</code>的简写</li>
<li><code>npm test</code>是<code>npm run test</code>的简写</li>
<li><code>npm restart</code>是<code>npm run stop &amp;&amp; npm run restart &amp;&amp; npm run start</code>的简写</li>
</ul>
</blockquote>
<p><code>npm start</code>、<code>npm stop</code>和<code>npm restart</code>都比较好理解，而<code>npm restart</code>是一个复合命令，实际上会执行三个脚本命令：<code>stop</code>、<code>restart</code>、<code>start</code>。具体的执行顺序如下。</p>
<blockquote>
<ol>
<li>prerestart</li>
<li>prestop</li>
<li>stop</li>
<li>poststop</li>
<li>restart</li>
<li>prestart</li>
<li>start</li>
<li>poststart</li>
<li>postrestart</li>
</ol>
</blockquote>
<h2 id="九、变量"><a href="#九、变量" class="headerlink" title="九、变量"></a>九、变量</h2><p>npm 脚本有一个非常强大的功能，就是可以使用 npm 的内部变量。</p>
<p>首先，通过<code>npm_package_</code>前缀，npm 脚本可以拿到<code>package.json</code>里面的字段。比如，下面是一个<code>package.json</code>。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"name"</span>: <span class="string">"foo"</span>, </span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"version"</span>: <span class="string">"1.2.5"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"scripts"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"view"</span>: <span class="string">"node view.js"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>那么，变量<code>npm_package_name</code>返回<code>foo</code>，变量<code>npm_package_version</code>返回<code>1.2.5</code>。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// view.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(process.env.npm_package_name); <span class="comment">// foo</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(process.env.npm_package_version); <span class="comment">// 1.2.5</span></span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，我们通过环境变量<code>process.env</code>对象，拿到<code>package.json</code>的字段值。如果是 Bash 脚本，可以用<code>$npm_package_name</code>和<code>$npm_package_version</code>取到这两个值。</p>
<p><code>npm_package_</code>前缀也支持嵌套的<code>package.json</code>字段。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"repository"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"type"</span>: <span class="string">"git"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"url"</span>: <span class="string">"xxx"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">scripts: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"view"</span>: <span class="string">"echo $npm_package_repository_type"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，<code>repository</code>字段的<code>type</code>属性，可以通过<code>npm_package_repository_type</code>取到。</p>
<p>下面是另外一个例子。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"install"</span>: <span class="string">"foo.js"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，<code>npm_package_scripts_install</code>变量的值等于<code>foo.js</code>。</p>
<p>然后，npm 脚本还可以通过<code>npm_config_</code>前缀，拿到 npm 的配置变量，即<code>npm config get xxx</code>命令返回的值。比如，当前模块的发行标签，可以通过<code>npm_config_tag</code>取到。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"view"</span>: <span class="string">"echo $npm_config_tag"</span>,</span></pre></td></tr></table></figure>
</blockquote>
<p>注意，<code>package.json</code>里面的<code>config</code>对象，可以被环境变量覆盖。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; </span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"name"</span> : <span class="string">"foo"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"config"</span> : &#123; <span class="string">"port"</span> : <span class="string">"8080"</span> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"scripts"</span> : &#123; <span class="string">"start"</span> : <span class="string">"node server.js"</span> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码中，<code>npm_package_config_port</code>变量返回的是<code>8080</code>。这个值可以用下面的方法覆盖。</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm config <span class="built_in">set</span> foo:port 80</span></pre></td></tr></table></figure>
</blockquote>
<p>最后，<code>env</code>命令可以列出所有环境变量。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"env"</span>: <span class="string">"env"</span></span></pre></td></tr></table></figure>
</blockquote>
<h2 id="十、常用脚本示例"><a href="#十、常用脚本示例" class="headerlink" title="十、常用脚本示例"></a>十、常用脚本示例</h2><blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 删除目录</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"clean"</span>: <span class="string">"rimraf dist/*"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 本地搭建一个 HTTP 服务</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"serve"</span>: <span class="string">"http-server -p 9090 dist/"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 打开浏览器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"open:dev"</span>: <span class="string">"opener http://localhost:9090"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 实时刷新</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="string">"livereload"</span>: <span class="string">"live-reload --port 9091 dist/"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 构建 HTML 文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"build:html"</span>: <span class="string">"jade index.jade &gt; dist/index.html"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 只要 CSS 文件有变动，就重新执行构建</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"watch:css"</span>: <span class="string">"watch 'npm run build:css' assets/styles/"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 只要 HTML 文件有变动，就重新执行构建</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"watch:html"</span>: <span class="string">"watch 'npm run build:html' assets/html"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 部署到 Amazon S3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"deploy:prod"</span>: <span class="string">"s3-cli sync ./dist/ s3://example-com/prod-site/"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 构建 favicon</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"build:favicon"</span>: <span class="string">"node scripts/favicon.js"</span>,</span></pre></td></tr></table></figure>
</blockquote>
<h2 id="十一、参考链接"><a href="#十一、参考链接" class="headerlink" title="十一、参考链接"></a>十一、参考链接</h2><ul>
<li><a href="https://www.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/" target="_blank" rel="noopener">How to Use npm as a Build Tool</a>, by Keith Cirkel</li>
<li><a href="https://github.com/RyanZim/awesome-npm-scripts#articles" target="_blank" rel="noopener">Awesome npm scripts</a>, by Ryan Zimmerman</li>
</ul>
<p>（完）</p>
]]></content>
      <categories>
        <category>npm</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>npm</tag>
        <tag>node</tag>
        <tag>package.json</tag>
      </tags>
  </entry>
  <entry>
    <title>模拟一个MVVM框架-Vue实现思路</title>
    <url>/vue/%E6%A8%A1%E6%8B%9F%E4%B8%80%E4%B8%AAMVVM%E6%A1%86%E6%9E%B6-Vue%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF/</url>
    <content><![CDATA[<h2 id="MVVM-框架介绍"><a href="#MVVM-框架介绍" class="headerlink" title="MVVM 框架介绍"></a>MVVM 框架介绍</h2><p>M（Model，模型层 ），<br>V（View，视图层），<br>VM（ViewModel，视图模型，V 与 M 连接的桥梁）</p>
<p>MVVM 框架实现了数据双向绑定<br>当 M 层数据进行修改时，VM 层会监测到变化，并且通知 V 层进行相应的修改<br>修改 V 层则会通知 M 层数据进行修改<br>MVVM 框架实现了视图与模型层的相互解耦<br><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/Vue%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E5%8E%9F%E7%90%86MVVM.png" alt="Vue双向绑定原理MVVM"></p>
<a id="more"></a>

<h2 id="几种双向数据绑定的方式"><a href="#几种双向数据绑定的方式" class="headerlink" title="几种双向数据绑定的方式"></a>几种双向数据绑定的方式</h2><ul>
<li><p>发布-订阅者模式（backbone.js）</p>
<ul>
<li>一般通过 pub、sub 的方式来实现数据和视图的绑定，但是使用起来比较麻烦</li>
</ul>
</li>
<li><p>脏值检查(angular.js)</p>
<ul>
<li>angular.js 是通过脏值检测的方式比对数据是否有变更，来决定是否更新视图。类似于通过定时器轮训检测数据是否发生了改变。</li>
</ul>
</li>
<li><p>数据劫持</p>
<ul>
<li>vue.js 则是采用数据劫持结合发布者-订阅者模式的方式。通过 Object.defineProperty()来劫持各个属性的 setter，getter，在数据变动时发布消息给订阅者，触发相应的监听回调。<br>注意：vuejs 不兼容 IE8 以以下的版本</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1576331348832.png" alt="1576331348832"></p>
<h2 id="Vue-实现思路"><a href="#Vue-实现思路" class="headerlink" title="Vue 实现思路"></a>Vue 实现思路</h2><ul>
<li>实现一个 Compiler 模板解析器，能够对模版中的指令和插值表达式进行解析,并且赋予不同的操作</li>
<li>实现一个 Observer 数据监听器，能够对数据对象的所有属性进行监听</li>
<li>实现一个 Watcher 观察者，将 Compile 的解析结果，与 Observer 所观察的对象连接起来，建立关系，在 Observer 观察到对象数据变化时，接收通知，同时更新 DOM</li>
<li>创建一个公共的入口对象，接收初始化的配置并且协调上面三个模块，也就是 vue</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/1576329836998.png" alt="1576329836998"></p>
<h2 id="Complier"><a href="#Complier" class="headerlink" title="Complier"></a>Complier</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * Compile(解析器) 专门负责解析模板内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compile</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 接收vue中传进来的el 和 vue实例</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">constructor</span>(el, vm) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//判断传入的是dom对象还是选择器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//根节点对象</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.el = <span class="keyword">typeof</span> el === <span class="string">"string"</span> ? <span class="built_in">document</span>.querySelector(el) : el;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//vm实例</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.vm = vm;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.el) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">    * 文档碎片化</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">    */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 1. 把el中所有的子节点都放到内存中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> fragement = <span class="keyword">this</span>.nodeFragement(<span class="keyword">this</span>.el);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// console.dir(fragement);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 2. 在内存中编译文档碎片</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.compile(fragement);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 3. 把fragement 添加到dom中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.el.appendChild(fragement);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  * 核心方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 把el中所有的子节点都放到内存中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> nodeFragement(node) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 创建一个fragement  fragement 相当于预编译将渲染dom放在内存中进行</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> fragement = <span class="built_in">document</span>.createDocumentFragment();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 把el的子节点挨个添加到文档碎片中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> childNodes = node.childNodes;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.toArray(childNodes).forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 已经将所有节点都添加到文档碎片中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   fragement.appendChild(item);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> fragement;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 在内存中编译文档碎片</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> compile(fragement) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> childNodes = fragement.childNodes;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.toArray(childNodes).forEach(<span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 判断节点是文本节点还是元素节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// console.dir(node)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.isElementNode(node)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 如果是元素节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.compileElementNode(node);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.isTextNode(node)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 如果是文本节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.compileTextNode(node);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 判断节点内是否还有子节点 如果还有就递归排查</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (node.childNodes &amp;&amp; node.childNodes.length &gt; <span class="number">0</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.compile(node);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 编译元素节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> compileElementNode(node) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// console.log('编译元素节点');</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// console.dir(node);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 获取所有属性集合转化数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> attributes = node.attributes;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.toArray(attributes).forEach(<span class="function">(<span class="params">attribute</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// console.dir(attribute)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 属性名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> attributeName = attribute.name;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// console.log(attributeName);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 属性值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> attributeValue = attribute.value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 判断是否是指令</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.isDirective(attributeName)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> type = attributeName.slice(<span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//  判断是否是v-on指令</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isEventDirective(type)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="comment">//使用解析工具 使用解析工具能够更好的解耦</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     conpileUtils.eventConpile(node, <span class="keyword">this</span>.vm, attributeValue, type);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="comment">//使用解析工具能够更好的解耦</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     conpileUtils[type](node, <span class="keyword">this</span>.vm, attributeValue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 编译文本节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> compileTextNode(node) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// console.log('编译文本节点');</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 调用conpileUtils插值表达式解析器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  conpileUtils.mustache(node, <span class="keyword">this</span>.vm);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  * 工具方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 转化数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> toArray(arr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 将伪数组转化为数组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> [].slice.call(arr);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 判断是否元素节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> isElementNode(node) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// nodetype 属性 1元素节点 3文本节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> node.nodeType === <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 判断是否文本节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> isTextNode(node) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// nodetype 属性 1元素节点 3文本节点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> node.nodeType === <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//判断是不是v-开头</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> isDirective(attributeName) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> attributeName.startsWith(<span class="string">"v-"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 判断是不是on指令事件指令</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> isEventDirective(type) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> type.split(<span class="string">":"</span>)[<span class="number">0</span>] === <span class="string">"on"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * conpile解析工具 能够更好的解耦方便后期维护</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 把所有跟解析有关的工具就放到这里</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> conpileUtils = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 把下面的一坨分配到这个工具里</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   if (type ==='text') &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     // document.body.textContent</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     node.textContent = this.vm.$data[attributeValue]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   if (type ==='html') &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     // document.body.innerHTML</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     node.innerHTML = this.vm.$data[attributeValue]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   if (type ==='model') &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     // document.body.innerHTML</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//     node.value = this.vm.$data[attributeValue]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//   &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 解析普通指令</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// text</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// expr 就是data中绑定的属性名，也就是v-xxx=的值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> text(node, vm, expr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  node.textContent = <span class="keyword">this</span>.getVmValue(vm, expr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//当值改变时会调用watcher中的updata，updata会调用回调函数并把新旧值作为实参传入</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//使用了订阅者模式每次new Watcher的时候都会讲实例存到Dep.subs中 当值发生改变会统一调用实例的updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">new</span> Watcher(vm, expr, (newValue) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 拿到新值更新视图</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   node.textContent = newValue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// hmtl</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> html(node, vm, expr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  node.innerHTML = <span class="keyword">this</span>.getVmValue(vm, expr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//当值改变时会调用watcher中的updata，updata会调用回调函数并把新旧值作为实参传入</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//使用了订阅者模式每次new Watcher的时候都会讲实例存到Dep.subs中 当值发生改变会统一调用实例的updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">new</span> Watcher(vm, expr, (newValue) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 拿到新值更新视图</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   node.innerHTML = newValue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// model</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> model(node, vm, expr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  node.value = <span class="keyword">this</span>.getVmValue(vm, expr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 监听输入框的input事件 当发生改变时就让 vm.$data[expr] = 输入值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  node.addEventListener(<span class="string">"input"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 调用setVmValue 方法,对象类型也能设置</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   that.setVmValue(vm, expr, <span class="keyword">this</span>.value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//当值改变时会调用watcher中的updata，updata会调用回调函数并把新旧值作为实参传入</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//使用了订阅者模式每次new Watcher的时候都会讲实例存到Dep.subs中 当值发生改变会统一调用实例的updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">new</span> Watcher(vm, expr, (newValue) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 拿到新值更新视图</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   node.value = newValue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 解析事件指令</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> eventConpile(node, vm, expr, type) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 分割事件名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> eventName = type.split(<span class="string">":"</span>)[<span class="number">1</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 判断是否有methods并且有内部处理的方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> mothod = vm.$methods &amp;&amp; vm.$methods[expr];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 如果有事件名，并且在methods中声明的处理方法再执行下面的操作</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 要不然bind就会报错 bind只能给函数调用</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (eventName &amp;&amp; mothod) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 给当前节点注册事件，使用vue实例的事件，并且将this指向vue实例</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   node.addEventListener(eventName, vm.$methods[expr].bind(vm));</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 解析文本节点插值表达式，小胡子语法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> mustache(node, vm) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 获取节点的文本内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> text = node.textContent;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// console.log(text);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 创建一个正则验证 并且将匹配正则的内容分组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> reg = <span class="regexp">/\&#123;\&#123;(.+)\&#125;\&#125;/</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (reg.test(text)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// RegExp.$1可以获取分组的第一组内容</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">let</span> key = <span class="built_in">RegExp</span>.$<span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 配备正则的内容替换为data中的数据</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 在插值表达式中的数据就是data中的属性名所以紫瑶把key传入getVmValue即可</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   node.textContent = text.replace(reg, <span class="keyword">this</span>.getVmValue(vm, key));</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">//当值改变时会调用watcher中的updata，updata会调用回调函数并把新旧值作为实参传入</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">//使用了订阅者模式每次new Watcher的时候都会讲实例存到Dep.subs中 当值发生改变会统一调用实例的updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">new</span> Watcher(vm, key, (newValue) =&gt; &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 拿到新值更新视图</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    node.textContent = text.replace(reg, newValue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 设计一个方法用于解析data中的普通数据类型和复杂数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> getVmValue(vm, expr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> data = vm.$data;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  expr.split(<span class="string">"."</span>).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 在这里如果是单纯字符串就只会遍历一次</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 如果是对象就会遍历两次第一次data会变成key</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 第二次data就会等于每一项的值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   data = data[key];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> data;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> setVmValue(vm, expr, value) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> data = vm.$data;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> arr = expr.split(<span class="string">"."</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  arr.forEach(<span class="function">(<span class="params">key, index</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 当item不是arr中最后一个的时候</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// debugger</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">if</span> (index &lt; arr.length - <span class="number">1</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 让data变成最后需要设置的对象</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    data = data[key];</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 是最后一个的时候就是需要设置的属性了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    data[key] = value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<h2 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">constructor</span>(data) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.data = data;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.walk(data);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  * 核心方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 遍历data把每个属性或属性中的属性都添加劫持</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> walk(data) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 如果没有data或者data不是一个对象就return， 不需要劫持</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (!data || <span class="keyword">typeof</span> data !== <span class="string">"object"</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">return</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 遍历属性</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">Object</span>.keys(data).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.defineReactive(data, key, data[key]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 优化:如果data中的数据时对象那就直接用自己在递归劫持一遍</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 如果就是简单数据类型,进来后会直接return掉</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.walk(data[key]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 用来劫持的方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> defineReactive(data, key, value) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 在每个属性中创建一个dep用来监听数据改变</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> dep = <span class="keyword">new</span> Dep();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   configurable: <span class="literal">true</span>, <span class="comment">//当且仅当该属性为 true 时，该属性描述符才能够被改变</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   enumerable: <span class="literal">true</span>, <span class="comment">//当且仅当该属性的为true时，该属性才才能够被遍历（就是被枚举）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">get</span>() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 如果有Dep.target中不是null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 就把Dep.target(watcher)添加到当前的Dep实例的订阅者列表中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    Dep.target &amp;&amp; dep.addSub(Dep.target);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>属性被访问了`</span>, value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">set</span>(newValue) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>属性被设置了`</span>, newValue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    value = newValue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//优化:如果新值是个对象就用walk在劫持一遍</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//不是那也不用担心，方法就直接被return了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    that.walk(newValue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//当值发生改变调用watcher的updata方法,催动视图更新</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">//这里使用Dep的通知方法，通知每个订阅者（每个watcher实例）调用自己的updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    dep.notify();</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 创建一个Watcher 用于关联Observer和Compile</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Watcher</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// vm就是vue实例，expr是data中的key，cd是需要执行的回调函数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">constructor</span>(vm, expr, cd) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.vm = vm;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.expr = expr;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.cd = cd;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 把当前的watcher 实例存到 Dep.target中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  Dep.target = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// getVmValue 会进到observe中的get中 所以在get中就可以访问到 Dep.target</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 把旧值(初始值)存起来, 在updata中用来对比</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.oldValue = <span class="keyword">this</span>.getVmValue(vm, expr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 进到get中存储完当前watcher实例后，清空Dep.target方便下次存储</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  Dep.target = <span class="literal">null</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  * 数据更新调用updata方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">  */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> upData() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> oldValue = <span class="keyword">this</span>.oldValue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * 关于这里为什么是新值,因为调用这个方法就说明数据已经更新了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * 这里传进来的vm就是更新后的vm了,所以调用getVmValue就拿到新值了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> newValue = <span class="keyword">this</span>.getVmValue(<span class="keyword">this</span>.vm, <span class="keyword">this</span>.expr);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 如果新值和旧值不相对，就调用cd 回调函数将newValue和oldValue传进去</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (newValue !== oldValue) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">this</span>.cd(newValue, oldValue);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 设计一个方法用于解析data中的普通数据类型和复杂数据类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 将complie中的方法复制过来用</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> getVmValue(vm, expr) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> data = vm.$data;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  expr.split(<span class="string">"."</span>).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 在这里如果是单纯字符串就只会遍历一次</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 如果是对象就会遍历两次第一次data会变成key</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 第二次data就会等于每一项的值</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   data = data[key];</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> data;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 订阅者、发布者模式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 创建一个Dep对象用于管理这个订阅者也就是每个watcher实例</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 并且在改变后通知每个订阅者</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dep</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">constructor</span>() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 用于储存所有订阅者</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.subs = [];</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 新增订阅者方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> addSub(watcher) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 新增订阅者放到数组中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.subs.push(watcher);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">// 通知所有的订阅者更新</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> notify() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.subs.forEach(<span class="function">(<span class="params">sub</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 调用upData方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   sub.upData();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="发布-订阅者模式"><a href="#发布-订阅者模式" class="headerlink" title="发布-订阅者模式"></a>发布-订阅者模式</h2><ul>
<li>发布-订阅者模式，也叫观察者模式</li>
<li>它定义了一种一对多的依赖关系，即当一个对象的状态发生改变的时候，所有依赖于它的对象都会得到通知并自动更新，解决了主体对象与观察者之间功能的耦合。</li>
<li>例子：微信公众号<ul>
<li>订阅者：只需要要订阅微信公众号</li>
<li>发布者(公众号):发布新文章的时候，推送给所有订阅者</li>
<li>优点：<ul>
<li>解耦合</li>
<li>订阅者不用每次去查看公众号是否有新的文章</li>
<li>发布者不用关心谁订阅了它，只要给所有订阅者推送即可</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Dep 中使用的就是发布-订阅者模式</p>
</blockquote>
<h2 id="html"><a href="#html" class="headerlink" title="html"></a>html</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-text</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;car.brand&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-html</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"msg"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"clickFn"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/watcher.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/observe.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/compile.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    el: <span class="string">"#app"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    data: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     msg: <span class="string">"hello vue111"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     car: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      brand: <span class="string">"宝马"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    methods: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     clickFn() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="comment">// 在vue的methods中this应该指向当前实例</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="keyword">this</span>.msg = <span class="string">"哈哈"</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="keyword">this</span>.car.brand = <span class="string">"奔驰"</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>parseInt+toString实现各个进制的转换</title>
    <url>/js/parseInt+toString%E5%AE%9E%E7%8E%B0%E5%90%84%E4%B8%AA%E8%BF%9B%E5%88%B6%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<blockquote>
<p>parseInt:将任意进制的数字转化为十进制</p>
<p>toString:将十进制的数字转化为任意进制</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">8</span>);   <span class="comment">//八进制转十进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">16</span>);   <span class="comment">//十六进制转十进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num).toString(<span class="number">8</span>)  <span class="comment">//十进制转八进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num).toString(<span class="number">16</span>)   <span class="comment">//十进制转十六进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">2</span>).toString(<span class="number">8</span>)   <span class="comment">//二进制转八进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">2</span>).toString(<span class="number">16</span>)  <span class="comment">//二进制转十六进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">8</span>).toString(<span class="number">2</span>)   <span class="comment">//八进制转二进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">8</span>).toString(<span class="number">16</span>)  <span class="comment">//八进制转十六进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">16</span>).toString(<span class="number">2</span>)  <span class="comment">//十六进制转二进制</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(num,<span class="number">16</span>).toString(<span class="number">8</span>)  <span class="comment">//十六进制转八进制</span></span></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>以 0X、0x 开头的表示为十六进制。 0xf //15</li>
<li>以 0、0O、0o 开头的表示为八进制。0o12 //10</li>
<li>以 0B、0b 开头的表示为二进制格式。 0b11//3</li>
</ul>
</blockquote>
<p>以上在js中可直接使用，可自动转化为对应的10进制</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>npm 下包问题</title>
    <url>/Nodejs/npm-%E4%B8%8B%E5%8C%85%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h2 id="node-下包的过程"><a href="#node-下包的过程" class="headerlink" title="node 下包的过程"></a>node 下包的过程</h2><p>首先说下node  下包的过程 ：</p>
<ul>
<li><p>node下包首先会在线上找对应本地node版本和操作系统的包  </p>
</li>
<li><p>有的无需系统支持就直接下 </p>
</li>
<li><p>有的需要根据系统下对应的tar.gz包 用到node-pre-gyp，如果找不到对应的node版本号和系统的包，node会下载源码进行编译</p>
</li>
<li><p>node编译使用node-gyp ,而node-gyp 在不同的操作系统下需要不同的支持工具 ，win是python和 Visual Studio 2017（15），在linux下需要Python， make,  和GCC  ，这里有详细的描述  <a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noopener">https://github.com/nodejs/node-gyp</a></p>
</li>
</ul>
<p>node不同版本影响到是否能直接下对应的包所以装包前可以先看下<a href="https://developer.aliyun.com/mirror/NPM?from=tnpm" target="_blank" rel="noopener">https://developer.aliyun.com/mirror/NPM?from=tnpm</a> 淘宝镜像上有没有对应node版本的包</p>
<blockquote>
<p>以这个为例<code>node-v72-win32-x64.tar.gz</code>代表node的NODE_MODULE_VERSION 版本号是72 的windows64位的包，NODE_MODULE_VERSION 对应的node版本可以在<a href="https://nodejs.org/zh-cn/download/releases/" target="_blank" rel="noopener">https://nodejs.org/zh-cn/download/releases/</a> node官网查询</p>
</blockquote>
<p>cnpm 安装：<a href="https://developer.aliyun.com/mirror/NPM?from=tnpm" target="_blank" rel="noopener">https://developer.aliyun.com/mirror/NPM?from=tnpm</a></p>
<p>设置npm 下包地址 ： <a href="https://blog.csdn.net/weixin_40920953/article/details/86547291" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40920953/article/details/86547291</a></p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>Nodejs</tag>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue3学习理解</title>
    <url>/vue/Vue3%E5%AD%A6%E4%B9%A0%E7%90%86%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="vue3-新特性"><a href="#vue3-新特性" class="headerlink" title="vue3 新特性"></a>vue3 新特性</h1><blockquote>
<p>整理的比较好的文档：<a href="https://www.jianshu.com/p/1fd73091e2e4" target="_blank" rel="noopener">https://www.jianshu.com/p/1fd73091e2e4</a></p>
</blockquote>
<p>直接看代码可以直接看 <a href="#demo" title=" Vue3 + TypeScript ">实践demo</a></p>
<h2 id="组合式-API"><a href="#组合式-API" class="headerlink" title="组合式 API"></a>组合式 API</h2><p>vue3 中加入了组合式 ，这个功能的作用是将单个vue组件的，逻辑部分也能自由拆分组合，更深层次的实现解耦和高复用性</p>
<p>vue2 如果单个vue文件逻辑部分过大 ，我们往往 需要单独用一个js文件或ts文件存放 逻辑（函数）并且为了使用 vue 组件上的响应式属性不得不将 vue 实例传进这个函数中，总有一种怪怪的感觉；</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vue2  单独存放逻辑的文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params">vue,xx</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    vue.yy = xx ;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ....</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="响应式的改变"><a href="#响应式的改变" class="headerlink" title="响应式的改变"></a>响应式的改变</h2><blockquote>
<p>响应式转换是“深层”的——它影响所有嵌套 property。在基于 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">ES2015 Proxy</a> 的实现中，返回的 proxy 是<strong>不</strong>等于原始对象的。建议只使用响应式 proxy，避免依赖原始对象。</p>
</blockquote>
<ul>
<li>ref  可以用于创建所有数据类型的响应式数据 需要.value 访问 （对象类型数据配合reactive使用）</li>
<li>reactive 只能用于创建对象数据类型的相应式数据 不需要.value 就直接可以访问 深度响应</li>
<li>toRefs  用于给prop添加响应数据，需要.value 访问</li>
</ul>
<h3 id="基础api"><a href="#基础api" class="headerlink" title="基础api"></a>基础api</h3><h4 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a>reactive</h4><p>返回对象的响应式副本</p>
<p>使用: </p>
<blockquote>
<p>可以直接给对象添加任何属性都是响应式的 ，但不能直接赋值对象</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = reactive(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"zhangshan"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    age: <span class="number">18</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 有效</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">person.sex = <span class="string">"男"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 无效</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">person = &#123;...person,...&#123;<span class="attr">sex</span> :  <span class="string">"男"</span>&#125;&#125;</span></pre></td></tr></table></figure>

<h4 id="isReactive"><a href="#isReactive" class="headerlink" title="isReactive"></a>isReactive</h4><p>检查对象是否是reactive 创建的响应式 proxy。</p>
<h4 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h4><p>除了只读以外跟reactive一样，但只读也代表了响应式没有意义了</p>
<h4 id="isReadonly"><a href="#isReadonly" class="headerlink" title="isReadonly"></a>isReadonly</h4><p>检查对象是否是由readonly 创建的只读 prox</p>
<h4 id="shallowReactive和shallowReadonly"><a href="#shallowReactive和shallowReadonly" class="headerlink" title="shallowReactive和shallowReadonly"></a>shallowReactive和shallowReadonly</h4><p>与上面的差别就是指对第一层属性响应，再深度的则不响应</p>
<h4 id="isProxy"><a href="#isProxy" class="headerlink" title="isProxy"></a>isProxy</h4><p>检查对象是否是由reactive 或 readonly 创建的 proxy。</p>
<h3 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h3><h4 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h4><blockquote>
<p>接受一个内部值并返回一个响应式且可变的 ref 对象。ref 对象具有指向内部值的单个 property <code>.value</code>。</p>
<p>也就是相当于解决了reactive 只能作用对象类型，和只能添加属性不能直接修改对象的不足</p>
<p>对象类型数据配合reactive使用</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> count = ref(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(count.value) <span class="comment">// 0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">count.value++</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(count.value) <span class="comment">// 1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 对象类型</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = ref(reactive(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"zhangshan"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    age: <span class="number">18</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;));</span></pre></td></tr><tr><td class="code"><pre><span class="line">person.value = reactive(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"lisi"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    age: <span class="number">28</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;)</span></pre></td></tr></table></figure>

<h4 id="unref"><a href="#unref" class="headerlink" title="unref"></a>unref</h4><p>返回使用ref响应数据的value （不是原始数据）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">const</span> flag = ref(reactive(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    number:<span class="number">0</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name:<span class="string">'flag'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;));</span></pre></td></tr><tr><td class="code"><pre><span class="line">flag.value.number++;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(unref(flag),<span class="string">'unref(flag) === flag.value'</span>,unref(flag) === flag.value); <span class="comment">// 1 true</span></span></pre></td></tr></table></figure>



<h3 id="setup（组合式的核心）"><a href="#setup（组合式的核心）" class="headerlink" title="setup（组合式的核心）"></a>setup（组合式的核心）</h3><h4 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h4><blockquote>
<p>个人理解 :setup 相当于一个盒子  （组合式的核心） ，将<code>methods</code>、<code>watch</code>、<code>computed</code>、<code>data</code>的数据都在这里进行组合</p>
<p>而<code>methods</code>、<code>watch</code>、<code>computed</code>、<code>data</code> 的数据，可以分别用不同的js文件生成，再导入到vue当文件组件中，或setup所在文件中</p>
</blockquote>
<blockquote>
<p>在Vue3中，定义 <code>methods</code>、<code>watch</code>、<code>computed</code>、<code>data</code>数据 等都放在了 <code>setup()</code> 函数中 ，(实现了逻辑的拆分)</p>
<p><a href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html#setup-%E7%BB%84%E4%BB%B6%E9%80%89%E9%A1%B9" target="_blank" rel="noopener">官网地址</a></p>
</blockquote>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>setup方法接收两个参数 ：</p>
<ul>
<li>prop</li>
<li>context 上下文对象也就是 this （当前vue实例）</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, watch, toRefs, computed &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  components: &#123; RepositoriesFilters, RepositoriesSortBy, RepositoriesList &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    user: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type: <span class="built_in">String</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      required: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  setup(props) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     <span class="comment">// 使用 `toRefs` 创建对 props 中的 `user` property 的响应式引用</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> &#123; user &#125; = toRefs(props)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> repositories = ref([])</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(props) <span class="comment">// &#123; user: '' &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> &#123;&#125; <span class="comment">// 这里返回的任何内容都可以用于组件的其余部分</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 组件的“其余部分”</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>更多用法详见：<a href="###setup.ts">setup.ts</a></p>
<h3 id="setup语法糖-lt-scritp-setup-gt"><a href="#setup语法糖-lt-scritp-setup-gt" class="headerlink" title="setup语法糖&lt;scritp setup&gt;"></a>setup语法糖<code>&lt;scritp setup&gt;</code></h3><p>可以使用<code>&lt;script setup&gt;</code> 标签 代替  setup（）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  setup() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> count = ref(<span class="number">0</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">const</span> inc = <span class="function"><span class="params">()</span> =&gt;</span> count.value++</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      count,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      inc,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>以上代码可以写成下面的代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;button @click&#x3D;&quot;inc&quot;&gt;&#123;&#123; count &#125;&#125;&lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  import &#123; ref &#125; from &#39;vue&#39;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  export const count &#x3D; ref(0)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  export const inc &#x3D; () &#x3D;&gt; count.value++</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;script&gt;</span></pre></td></tr></table></figure>

<h4 id="使用限制："><a href="#使用限制：" class="headerlink" title="使用限制："></a>使用限制：</h4><blockquote>
<p>由于模块执行语义的不同，内部代码<code>&lt;script setup&gt;</code>依赖于SFC的上下文。当移至外部<code>.js</code>或<code>.ts</code>文件中时，可能会给开发人员和工具带来混乱。因此，<strong><code>&lt;script setup&gt;</code></strong>不能与该<code>src</code>属性一起使用。</p>
</blockquote>
<p><strong>个人感觉比较麻烦 还不如正常的使用setup</strong></p>
<h2 id="Global-API-全局-API"><a href="#Global-API-全局-API" class="headerlink" title="Global API 全局 API"></a>Global API 全局 API</h2><h3 id="createApp-创建整个应用的实例"><a href="#createApp-创建整个应用的实例" class="headerlink" title="createApp 创建整个应用的实例"></a><code>createApp</code> 创建整个应用的实例</h3><blockquote>
<p>3.x添加<code>createApp</code> 方法用来创建应用的根 防止数据间的相互污染   <a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%85%A8%E5%B1%80-api-createapp" target="_blank" rel="noopener">官方文档地址</a></p>
</blockquote>
<p>应用实例暴露当前全局 API 的子集，经验法则是，任何全局改变 Vue 行为的 API 现在都会移动到应用实例上，以下是当前全局 API 及其相应实例 API 的表：</p>
<table>
<thead>
<tr>
<th>2.x 全局 API</th>
<th>3.x 实例 API (<code>app</code>)</th>
</tr>
</thead>
<tbody><tr>
<td>Vue.config</td>
<td>app.config</td>
</tr>
<tr>
<td>Vue.config.productionTip</td>
<td><em>removed</em> (<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#config-productiontip-removed" target="_blank" rel="noopener">见下方</a>)</td>
</tr>
<tr>
<td>Vue.config.ignoredElements</td>
<td>app.config.isCustomElement (<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#config-ignoredelements-is-now-config-iscustomelement" target="_blank" rel="noopener">见下方</a>)</td>
</tr>
<tr>
<td>Vue.component</td>
<td>app.component</td>
</tr>
<tr>
<td>Vue.directive</td>
<td>app.directive</td>
</tr>
<tr>
<td>Vue.mixin</td>
<td>app.mixin</td>
</tr>
<tr>
<td>Vue.use</td>
<td>app.use (<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#a-note-for-plugin-authors" target="_blank" rel="noopener">见下方</a>)</td>
</tr>
<tr>
<td>Vue.prototype</td>
<td>app.config.globalProperties (<a href="https://v3.cn.vuejs.org/guide/migration/global-api.html#vue-prototype-replaced-by-config-globalproperties" target="_blank" rel="noopener">见下方</a>)</td>
</tr>
</tbody></table>
<p>所有其他不全局改变行为的全局 API 现在被命名为 exports，文档见<a href="https://v3.cn.vuejs.org/guide/migration/global-api-treeshaking.html" target="_blank" rel="noopener">全局 API Treeshaking</a>。</p>
<h3 id="全局-API-Treeshaking-将一部分-xxx-和-指令-按需导入使用"><a href="#全局-API-Treeshaking-将一部分-xxx-和-指令-按需导入使用" class="headerlink" title="全局 API Treeshaking  将一部分$xxx 和 指令 按需导入使用"></a>全局 API Treeshaking  将一部分$xxx 和 指令 按需导入使用</h3><blockquote>
<p>Vue.nextTick() 将废弃 使用 导入方式如下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 一些和DOM有关的东西</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>

<p>使用 render 语法中 可以使用如下 api 按需导入</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h, Transition, withDirectives, vShow &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> h(Transition, [withDirectives(h(<span class="string">'div'</span>, <span class="string">'hello'</span>), [[vShow, <span class="keyword">this</span>.ok]])])</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>



<h2 id="teleport-指定标签父节点"><a href="#teleport-指定标签父节点" class="headerlink" title="teleport 指定标签父节点"></a>teleport 指定标签父节点</h2><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>teleport 可以将组件生成的dom节点 ，转移到其他dom下作为其子节点</p>
<p>让我们修改 <code>modal-button</code> 以使用 <code>&lt;teleport&gt;</code>，并告诉 Vue “<strong>Teleport</strong> 这个 HTML <strong>到</strong>该‘<strong>body</strong>’标签”。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">app.component(&#39;modal-button&#39;, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  template: &#96;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;button @click&#x3D;&quot;modalOpen &#x3D; true&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        Open full screen modal! (With teleport!)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;teleport to&#x3D;&quot;body&quot;&gt;								&#x2F;&#x2F; teleport 的 to属性就是作为哪个dom的字节的</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;div v-if&#x3D;&quot;modalOpen&quot; class&#x3D;&quot;modal&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          I&#39;m a teleported modal! </span></pre></td></tr><tr><td class="code"><pre><span class="line">          (My parent is &quot;body&quot;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &lt;button @click&#x3D;&quot;modalOpen &#x3D; false&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            Close</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;teleport&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#96;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  data() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    return &#123; </span></pre></td></tr><tr><td class="code"><pre><span class="line">      modalOpen: false</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>

<h4 id="Props："><a href="#Props：" class="headerlink" title="Props："></a>Props：</h4><ul>
<li><code>to</code> - <code>string</code>。需要 prop，必须是有效的查询选择器（独一无二的类名或id或属性）或 <code>HTMLElement</code> (如果在浏览器环境中使用)。指定将在其中移动 <code>&lt;teleport&gt;</code> 内容的目标元素</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 正确 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">"#some-id"</span> /&gt;</span>				</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">".some-class"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">"[data-teleport]"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 错误 --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">"h1"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">"some-string"</span> /&gt;</span></span></pre></td></tr></table></figure>

<ul>
<li><code>disabled</code> - <code>boolean</code>。此可选属性可用于禁用 <code>&lt;teleport&gt;</code> 的功能，这意味着其插槽内容将不会移动到任何位置，而是在您在周围父组件中指定了 <code>&lt;teleport&gt;</code> 的位置渲染。</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">"#popup"</span> <span class="attr">:disabled</span>=<span class="string">"displayVideoInline"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">"./my-movie.mp4"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">teleport</span>&gt;</span></span></pre></td></tr></table></figure>

<p>请注意，这将移动实际的 DOM 节点，而不是被销毁和重新创建，并且它还将保持任何组件实例的活动状态。所有有状态的 HTML 元素 (即播放的视频) 都将保持其状态。</p>
<h2 id="片段（支持多根节点）"><a href="#片段（支持多根节点）" class="headerlink" title="片段（支持多根节点）"></a>片段（支持多根节点）</h2><p>Vue 3 现在正式支持了多根节点的组件，也就是片段！</p>
<p>在 3.x 中，组件可以包含多个根节点！但是，这要求开发者显式定义 attribute 应该分布在哪里。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Layout.vue --&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span>...<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">main</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">main</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span>...<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></pre></td></tr></table></figure>

<blockquote>
<p>因为2.x只有一个根节点 $attrs 就会绑定到根节点上，现在3.x会有多个根节点，所以需要定义$attrs需要绑定到到哪个节点上</p>
</blockquote>
<h2 id="v-model-的改变"><a href="#v-model-的改变" class="headerlink" title="v-model 的改变"></a><code>v-model</code> 的改变</h2><p>2.x 使用input + value 实现v-model , 3.x 里使用使用 <code>modelValue</code>（  自己定义字段名与update:后面的字段一致即可 ，默认值是<code>modelValue</code>） 作为 prop 和 <code>update:modelValue</code> 作为事件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.component(<span class="string">'my-component'</span>, &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    title: <span class="built_in">String</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  emits: [<span class="string">'update:title'</span>],</span></pre></td></tr><tr><td class="code"><pre><span class="line">  template: </span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="string">`  &lt;input </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      type="text"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      :value="title"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">      @input="$emit('update:title', $event.target.value)"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">  `</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)</span></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">v-model:title</span>=<span class="string">"bookTitle"</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span></pre></td></tr></table></figure>

<blockquote>
<p>注意点：v-model 后面需要加对应的update后的的字段名  习惯于2.x语法后 前几次会忘记加</p>
</blockquote>
<p>并且可以使用多个v-model 只需要在v-model后面加上对应的prop字段名即可</p>
<h3 id="v-model-修饰符"><a href="#v-model-修饰符" class="headerlink" title="v-model 修饰符"></a><code>v-model</code> 修饰符</h3><p>在2.x中v-model的修饰符有.trim<code>、</code>.number<code>和</code>.lazy， </p>
<p>在3.x中我们可以自定义修饰符，比如 <code>v-model:title.capitalize=&quot;bar&quot;</code> </p>
<p> 在子组件中 prop中 <code>titleModifiers</code>中可以接收到 <code>capitalize：ture</code>  再做对应处理后</p>
<p>prop中修饰符的属性名为 ： <code>arg + &quot;Modifiers&quot;</code>：（绑定value字段名 + “Modifiers”）</p>
<p>父组件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">v-model:title.capitalize</span>=<span class="string">"inputValue"</span> /&gt;</span></span></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">:value</span>=<span class="string">"title"</span> @<span class="attr">input</span>=<span class="string">"handleCapitalize"</span> /&gt;</span></span></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//prop</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    title: <span class="built_in">String</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    titleModifiers: &#123; <span class="comment">//使用title + Modifiers 获取修饰符对象 &#123; capitalize:ture &#125; </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">type</span>: <span class="built_in">Object</span>,			</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> (&#123;&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// mothods</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">handleCapitalize(event) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">let</span> value = event.target.value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.titleModifiers.capitalize) &#123; <span class="comment">// capitalize:ture</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    value = value.toLocaleUpperCase();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">"update:title"</span>, value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p> 如果<code>v-modle</code>使用默认值 <code>modelValue</code>   时，prop修饰符对象使用 <code>modelModifiers</code> 作为属性名</p>
</blockquote>
<h2 id="单文件组件style中使用script中变量-实验性"><a href="#单文件组件style中使用script中变量-实验性" class="headerlink" title="单文件组件style中使用script中变量(实验性)"></a>单文件组件style中使用script中变量(实验性)</h2><blockquote>
<p><code>3.x</code> 单文件组件中style中可是使用当前<code>vue</code>实例的data数据</p>
<p>最新提议 <a href="https://github.com/vuejs/rfcs/pull/231" target="_blank" rel="noopener">https://github.com/vuejs/rfcs/pull/231</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;div class&#x3D;&quot;text&quot;&gt;hello&lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  export default &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    data() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      return &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        color: &#39;red&#39;,						  &#x2F;&#x2F; data中的变量在style中都可以使用 使用v-bind （11月10日最新提议）</span></pre></td></tr><tr><td class="code"><pre><span class="line">        font: &#123;								  &#x2F;&#x2F; 之前的提议是 var(--变量名)</span></pre></td></tr><tr><td class="code"><pre><span class="line">          size: &#39;2em&#39;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  .text &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    color: v-bind(color);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#x2F;* 使用对象.属性 包在&#39;&#39;引号中 *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    font-size: v-bind(&#39;font.size&#39;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure>



<h2 id="单文件组件样式作用域的变化"><a href="#单文件组件样式作用域的变化" class="headerlink" title="单文件组件样式作用域的变化"></a>单文件组件样式作用域的变化</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* deep (css选择器)  *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">::v-deep(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;*可以在（）里写,  在sass less scss 等预编译器中可以写在 &#123;&#125; 中*&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">::v-deep() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    .foo&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;    </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* 简写 *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">:deep(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* 作用于插槽  给 slot 加对应 class&#x3D;&quot;foo&quot; 就可以作用到插槽上*&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">::v-slotted(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* 简写 *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">:slotted(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* 在 scoped 中作用全局的样式 功能就 跟不加scoped一样 感觉有点脱裤子放屁的感觉 *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">::v-global(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;* 简写 *&#x2F;</span></pre></td></tr><tr><td class="code"><pre><span class="line">:global(.foo) &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure>



<h2 id="tip-名词含义"><a href="#tip-名词含义" class="headerlink" title="tip 名词含义"></a>tip 名词含义</h2><ul>
<li><code>SFC</code>  -  单文件组件</li>
</ul>
<h1 id="demo-Vue3-TypeScript"><a href="#demo-Vue3-TypeScript" class="headerlink" title="demo ( Vue3 + TypeScript )"></a>demo ( Vue3 + TypeScript )</h1><blockquote>
<p>直接使用vue-cil初始化vue3项目 </p>
</blockquote>
<h3 id="Home-vue"><a href="#Home-vue" class="headerlink" title="Home.vue"></a>Home.vue</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;div class&#x3D;&quot;home&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;img alt&#x3D;&quot;Vue logo&quot; src&#x3D;&quot;..&#x2F;assets&#x2F;logo.png&quot; &#x2F;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;HelloWorld v-model:title.capitalize&#x3D;&quot;inputValue&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;p class&#x3D;&quot;default-solt&quot;&gt;这里是默认插槽&lt;&#x2F;p&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;HelloWorld&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;script lang&#x3D;&quot;ts&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">import &#123; ref, defineComponent &#125; from &quot;vue&quot;; &#x2F;&#x2F; 使用defineComponent创建vue实例</span></pre></td></tr><tr><td class="code"><pre><span class="line">import HelloWorld from &quot;@&#x2F;components&#x2F;HelloWorld.vue&quot;; &#x2F;&#x2F; @ is an alias to &#x2F;src</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">export default defineComponent(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: &quot;Home&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  components: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    HelloWorld</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  created() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(&quot;created&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  beforeCreate() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(&quot;beforeCreate&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  setup() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(&quot;setup 在 created 之前&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    const inputValue &#x3D; ref(&quot;&quot;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    return &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      inputValue</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 等价于下面</span></pre></td></tr><tr><td class="code"><pre><span class="line">:deep(.skill) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  color:skyblue ;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">:deep() &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  .skill &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    color: skyblue;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 等价于不加 scoped</span></pre></td></tr><tr><td class="code"><pre><span class="line">:global(.modal) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &amp; &gt; div &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    color: skyblue !important;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure>

<h3 id="HelloWorld-vue"><a href="#HelloWorld-vue" class="headerlink" title="HelloWorld.vue"></a>HelloWorld.vue</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;div class&#x3D;&quot;hello&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;!-- 展示数据 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;div&gt;鼠标x轴:&#123;&#123; x &#125;&#125;&lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;div&gt;鼠标y轴:&#123;&#123; y &#125;&#125;&lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;span&gt;&#123;&#123; count &#125;&#125;&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;span&gt;双倍：&#123;&#123; doubelCount &#125;&#125;&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;button @click&#x3D;&quot;count++&quot;&gt;Increment count&lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;p&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;input type&#x3D;&quot;text&quot; :value&#x3D;&quot;title&quot; @input&#x3D;&quot;handleCapitalize&quot; &#x2F;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;p&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;p class&#x3D;&quot;person&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;span&gt;姓名：&#123;&#123; person.name &#125;&#125;&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;span&gt;年龄：&#123;&#123; person.age &#125;&#125;&lt;&#x2F;span&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;p&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;p class&#x3D;&quot;skill&quot;&gt;技能：敲代码&lt;&#x2F;p&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;!-- 打开dialog按钮 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;button @click&#x3D;&quot;modalOpen &#x3D; true&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        Open full screen modal! (With teleport!)</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;!-- dialog --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;teleport to&#x3D;&quot;body&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;div v-show&#x3D;&quot;modalOpen&quot; class&#x3D;&quot;modal&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &lt;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            I&#39;m a teleported modal! (My parent is &quot;body&quot;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &lt;button @click&#x3D;&quot;modalOpen &#x3D; false&quot;&gt;Close&lt;&#x2F;button&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &lt;&#x2F;teleport&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;!-- 默认插槽 --&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &lt;slot class&#x3D;&quot;default-solt&quot;&gt;&lt;&#x2F;slot&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &lt;&#x2F;div&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;template&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;script lang&#x3D;&quot;ts&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">import &#123; setup &#125; from &quot;@&#x2F;components&#x2F;setup&quot;; &#x2F;&#x2F; 直接导入 setup</span></pre></td></tr><tr><td class="code"><pre><span class="line">import &#123; defineComponent &#125; from &quot;vue&quot;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">export default defineComponent(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  name: &quot;HelloWorld&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  emits: [&quot;update:title&quot;],					&#x2F;&#x2F; 显式的定义使用了哪些emits</span></pre></td></tr><tr><td class="code"><pre><span class="line">  props: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    title: String,							&#x2F;&#x2F; v-model绑定值</span></pre></td></tr><tr><td class="code"><pre><span class="line">    titleModifiers: &#123;						&#x2F;&#x2F; v-model绑定值对应的修饰符对象</span></pre></td></tr><tr><td class="code"><pre><span class="line">      type: Object,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      default: () &#x3D;&gt; (&#123;&#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  setup</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;script&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 使用script中的变量 color</span></pre></td></tr><tr><td class="code"><pre><span class="line">.person &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  color: v-bind(color);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 默认插槽加样式：无效</span></pre></td></tr><tr><td class="code"><pre><span class="line">.default-solt&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  color: slateblue !important;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 默认插槽加样式：有效</span></pre></td></tr><tr><td class="code"><pre><span class="line">:slotted(.default-solt) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  color: slateblue !important;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; dialog的样式</span></pre></td></tr><tr><td class="code"><pre><span class="line">.modal &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  position: absolute;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  top: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  right: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  bottom: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  left: 0;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  background-color: rgba(0, 0, 0, 0.5);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  display: flex;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  flex-direction: column;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  align-items: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  justify-content: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">.modal div &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  display: flex;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  flex-direction: column;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  align-items: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  justify-content: center;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  background-color: white;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  width: 300px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  height: 300px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  padding: 5px;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure>

<h3 id="setup-ts"><a href="#setup-ts" class="headerlink" title="setup.ts"></a>setup.ts</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ref,          <span class="comment">// 用于简单数据类型  需要.value 访问</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  reactive,     <span class="comment">// 用于复杂数据类型 不需要.value 就直接可以方法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  toRefs,       <span class="comment">// 用于给prop添加响应数据，需要.value 访问</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  watch,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  computed,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  onMounted,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  onUnmounted</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">from</span> <span class="string">"vue"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setup = <span class="function">(<span class="params">props: <span class="built_in">any</span>, context: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Bowen: setup -&gt; props, context"</span>, props, context);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// prop</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> &#123; titleModifiers &#125; = toRefs(props);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// data</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> x = ref(<span class="number">0</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> y = ref(<span class="number">0</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> modalOpen = ref(<span class="literal">false</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> count = ref(<span class="number">0</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> color = ref(<span class="string">"red"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> person = reactive(&#123;       </span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"Bowen"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    age: <span class="number">18</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// computed</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> doubelCount = computed(<span class="function"><span class="params">()</span> =&gt;</span> count.value * <span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// watch</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  watch(count, <span class="function"><span class="params">val</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Bowen: setup -&gt; val"</span>, val);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// methods</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 判断 v-model 是否有 capitalize 标识符  转换大写</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> handleCapitalize = <span class="function">(<span class="params">event: InputEvent</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">let</span> value = (event.target <span class="keyword">as</span> HTMLInputElement).value;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (titleModifiers.value.capitalize) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      value = value.toLocaleUpperCase();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    context.emit(<span class="string">"update:title"</span>, value);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 获取鼠标定位</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">const</span> getMousePosition = <span class="function">(<span class="params">e: MouseEvent</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    x.value = e.pageX;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    y.value = e.pageY;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//============================================================================</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 生命周期</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">"mousemove"</span>, getMousePosition);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">document</span>.removeEventListener(<span class="string">"mousemove"</span>, getMousePosition);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    x,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    y,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    modalOpen,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    count,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    color,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    person,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    doubelCount,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    handleCapitalize</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> setup;</span></pre></td></tr></table></figure>

<h1 id="vue3组件库"><a href="#vue3组件库" class="headerlink" title="vue3组件库"></a>vue3组件库</h1><h2 id="element-puls"><a href="#element-puls" class="headerlink" title="element-puls"></a>element-puls</h2><p>elementUI官方bata版 <a href="https://github.com/element-plus/element-plus" target="_blank" rel="noopener">https://github.com/element-plus/element-plus</a></p>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack入门</title>
    <url>/webpack/webpack%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="webpack-入门"><a href="#webpack-入门" class="headerlink" title="webpack 入门"></a>webpack 入门</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>webpack 是一个模块打包器，它本身主要打包 JavaScript 模块，结合它的生态中的一些 loader 可以实现对很多其他资源的打包，例如 less、sass、图片、es6转es5、.vue 等等文件资源都可以。</p>
<p>使用 webpack，我们最终就能实现类似于 VueCLI 这个工具提供给我们的功能：</p>
<ul>
<li>打包 JavaScript</li>
<li>打包 css</li>
<li>打包 图片</li>
<li>打包 less</li>
<li>打包 .vue 资源</li>
<li>….</li>
<li>开发阶段的 Web 服务</li>
<li>代码热更新</li>
<li>打包部署命令</li>
<li>。。。。</li>
</ul>
<p>我们之所以能使用到 VueCLI 这么方便的工具，一切都归功于 webpack。</p>
<p>webpack 出来之前，还有一些别的构建工具：</p>
<ul>
<li><strong>grunt</strong></li>
<li><strong>gulp</strong></li>
<li>百度的 fis</li>
<li>PARCEL</li>
<li>rollup</li>
<li>……</li>
</ul>
<p>现在 webpack 已经被各大主流前端框架作为自己的脚手架工具的基层，例如：</p>
<ul>
<li>Vue：Vue CLI</li>
<li>React：crate-react-app</li>
<li>Angular：angular-cli</li>
<li>。。。。</li>
</ul>
<p>为什么要学习 webpack？</p>
<p>如果你需要定制这些脚手架工具，那么最好了解一点儿 webpack 相关的内容，例如对项目进行打包优化，配置开发工具模式，。。。。一些更高级的使用方式。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122114402722.png" alt="image-20191122114402722"></p>
<p>打包 -&gt; 打包结果 -&gt; 浏览器就可以识别运行。 </p>
<ul>
<li>官网：<a href="https://webpack.js.org/" target="_blank" rel="noopener">https://webpack.js.org/</a><ul>
<li>官方教程：<a href="https://webpack.js.org/guides/" target="_blank" rel="noopener">https://webpack.js.org/guides/</a></li>
<li>官方 API 参考文档：<a href="https://webpack.js.org/api/" target="_blank" rel="noopener">https://webpack.js.org/api/</a></li>
<li>官方的中文文档链接： <a href="https://webpack.docschina.org/" target="_blank" rel="noopener">https://webpack.docschina.org/</a> </li>
</ul>
</li>
<li>GitHub：<a href="https://github.com/webpack/webpack" target="_blank" rel="noopener">https://github.com/webpack/webpack</a></li>
</ul>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><blockquote>
<p>目标：体验 webpack 的使用</p>
</blockquote>
<p>一、准备</p>
<p>1、创建 <code>demo1</code> 练习项目</p>
<p>2、创建 <code>index.js</code></p>
<blockquote>
<p>现在必须叫 <code>index.js</code>，之后可以通过配置文件修改</p>
</blockquote>
<p>3、创建 <code>foo.js</code></p>
<p>4、创建 <code>index.html</code></p>
<p>二、安装并配置 webpack 到项目中</p>
<p>1、创建 <code>package.json</code> 文件（保存安装包的依赖信息）</p>
<p>2、安装 webpack 到项目的开发依赖中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># yarn add --dev webpack webpack-cli 或者 yarn add -D webpack webpack-cli</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># npm install -D webpack webpack-cli</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install --save-dev webpack webpack-cli</span></pre></td></tr></table></figure>

<blockquote>
<p>建议把开发工具打包相关的包的依赖信息保存到 <code>devDependencies</code> 中，其实就是一个归类，都安装包到项目中，有利于阅读，更清晰。</p>
</blockquote>
<p>3、将 package.json 的 <code>scripts</code> 中新增</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122121632366.png" alt="image-20191122121632366"></p>
<p>三、打包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run build</span></pre></td></tr></table></figure>

<blockquote>
<p>npm 就会找到 package.json 中的 <code>build</code> 配置项，运行 webpak 构建打包。</p>
</blockquote>
<p>正确的话你应该可以看到：</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">$ npm run build</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; demo1@<span class="number">1.0</span><span class="number">.0</span> build C:\Users\LPZ\Desktop\FE88\webpack-demos\demo1</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; webpack</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">Hash: <span class="number">893</span>a9c400f1f92ab6974</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">Version</span>: webpack <span class="number">4.41</span><span class="number">.2</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="type">Time</span>: <span class="number">96</span>ms</span></pre></td></tr><tr><td class="code"><pre><span class="line">Built at: <span class="number">2019</span><span class="number">-11</span><span class="number">-22</span> <span class="number">12</span>:<span class="number">19</span>:<span class="number">00</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  Asset       Size  Chunks             Chunk Names</span></pre></td></tr><tr><td class="code"><pre><span class="line">main.js  <span class="number">976</span> bytes       <span class="number">0</span>  [emitted]  main</span></pre></td></tr><tr><td class="code"><pre><span class="line">Entrypoint main = main.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">[<span class="number">0</span>] ./src/<span class="keyword">index</span>.js + <span class="number">1</span> modules <span class="number">95</span> bytes &#123;<span class="number">0</span>&#125; [built]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    | ./src/<span class="keyword">index</span>.js <span class="number">34</span> bytes [built]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    | ./src/foo.js <span class="number">61</span> bytes [built]</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">WARNING</span> <span class="keyword">in</span> <span class="keyword">configuration</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">The <span class="string">'mode'</span> <span class="keyword">option</span> has <span class="keyword">not</span> been <span class="keyword">set</span>, webpack will fallback <span class="keyword">to</span> <span class="string">'production'</span> <span class="keyword">for</span> this <span class="keyword">value</span>. <span class="keyword">Set</span> <span class="string">'mode'</span> <span class="keyword">option</span> <span class="keyword">to</span> <span class="string">'development'</span> <span class="keyword">or</span> <span class="string">'production'</span> <span class="keyword">to</span> <span class="keyword">enable</span> defaults <span class="keyword">for</span> <span class="keyword">each</span> environment.</span></pre></td></tr><tr><td class="code"><pre><span class="line">You can <span class="keyword">also</span> <span class="keyword">set</span> it <span class="keyword">to</span> <span class="string">'none'</span> <span class="keyword">to</span> <span class="keyword">disable</span> <span class="keyword">any</span> <span class="keyword">default</span> behavior. Learn more: https://webpack.js.org/<span class="keyword">configuration</span>/mode/</span></pre></td></tr></table></figure>

<p>webpack 默认会找到 <code>src/index.js</code> 作为打包的入口，然后从入口分析所有的依赖：</p>
<ul>
<li>a 依赖了 b</li>
<li>b 依赖了 c</li>
<li>c 依赖 d</li>
<li>。。。。</li>
<li>所有依赖的文件</li>
</ul>
<p>将它们编译构建处理，最终生成一个默认名字叫 <code>main.js</code> 文件写入 <code>dist</code> 目录。</p>
<p>四、加载执行</p>
<p>在你 HTML 文件中加载打包的结果 <code>dist/main.js</code>，访问测试。</p>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>webpack 打包的入口和出口具有默认规则，如果想要自定义，或者其他一些更高级功能配置，那么我们就需要使用它的配置文件了。</p>
<p>1、在项目根目录创建 <code>webpack.config.js</code> 并写入</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * webpack 配置文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 该文件必须导出一个对象</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 对象中声明 webpack 的配置项</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 注意：webpack 是基于 Node.js 开发运行的一个构件工具，它的打包运行的时候会来执行这个文件得到导出的配置对象</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * 所以你要知道：这里使用的都是 Node.js 中的代码相关语法</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * 入口配置</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * 出口配置</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  output: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// __dirname 可以动态的获取当前文件所属目录的绝对路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// path 是 Node 中一个专门处理路径的一个模块</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 它的 join 方法转么用来拼接路径，</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    path: path.join(__dirname, <span class="string">'./dist'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// path: 'C:\\Users\\LPZ\\Desktop\\FE88\\webpack-demos\\demo1\\dist', // 打包的结果目录，默认是 dist，必须是一个绝对路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// path: './dist/', // 打包的结果目录，默认是 dist，必须是一个绝对路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    filename: <span class="string">'bundle.js'</span> <span class="comment">// 打包的结果文件名，默认叫 main.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>2、然后修改 <code>package.json</code> 文件中的 <code>build</code> 配置项（非必须）</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122124307295.png" alt="image-20191122124307295"></p>
<blockquote>
<p>webpack 会自动加载执行名字叫 <code>webpack.config.js</code> 的配置文件，如果你使用了别的名字，那么就在这里自定义.</p>
</blockquote>
<p>3、打包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run build</span></pre></td></tr></table></figure>



<h2 id="关于-npm-scripts"><a href="#关于-npm-scripts" class="headerlink" title="关于 npm scripts"></a>关于 npm scripts</h2><p>推荐阅读：<a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="noopener">阮一峰 - npm scripts 使用指南</a></p>
<p>我们安装到项目中的 webpack，手动的方式需要这样来使用：</p>
<h2 id="打包模式-mode"><a href="#打包模式-mode" class="headerlink" title="打包模式 mode"></a>打包模式 mode</h2><blockquote>
<p>官方文档： <a href="https://webpack.js.org/configuration/mode/" target="_blank" rel="noopener">https://webpack.js.org/configuration/mode/</a> </p>
</blockquote>
<p>mode 用来配置打包模式，有两种模式可选：</p>
<ul>
<li>development 开发模式<ul>
<li>更快的编译速度</li>
</ul>
</li>
<li>production 生产模式<ul>
<li>相比开发模式构建速度慢，拥有更好的编译结果</li>
<li>例如代码压缩</li>
</ul>
</li>
</ul>
<p>建议开发过程使用开发模式，发布上线使用生产模式。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122155129511.png" alt="image-20191122155129511"></p>
<h2 id="打包-CSS"><a href="#打包-CSS" class="headerlink" title="打包 CSS"></a>打包 CSS</h2><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev style-loader css-loader</span></pre></td></tr></table></figure>

<p>2、修改打包配置文件</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122152632937.png" alt="image-20191122152632937"></p>
<p>3、打包测试</p>
<h2 id="打包图片"><a href="#打包图片" class="headerlink" title="打包图片"></a>打包图片</h2><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev file-loader</span></pre></td></tr></table></figure>

<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122153520233.png" alt="image-20191122153520233"></p>
<p>3、打包配置</p>
<h2 id="设置-HtmlWebpackPlugin"><a href="#设置-HtmlWebpackPlugin" class="headerlink" title="设置 HtmlWebpackPlugin"></a>设置 HtmlWebpackPlugin</h2><p>为了解决打包之后的路径问题，我们也必须把 HTML 文件也打包到 dist 目录中，然后运行 dist 中的 HTML 文件，这才是正确的方式。</p>
<p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev html-webpack-plugin</span></pre></td></tr></table></figure>



<p>2、配置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">+ <span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">+   plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">+     <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">+       title: <span class="string">'管理输出'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">+     &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">+   ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr></table></figure>

<blockquote>
<p>关于 HTMLwebpackplugin 更多内容，请参考： <a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">https://github.com/jantimon/html-webpack-plugin</a> </p>
</blockquote>
<p>3、打包测试</p>
<h2 id="自动清除-dist-目录"><a href="#自动清除-dist-目录" class="headerlink" title="自动清除 dist 目录"></a>自动清除 dist 目录</h2><p>建议每次打包之前把 dist 目录删除，每次都生成最新的干干净净的内容。</p>
<p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev clean-webpack-plugin</span></pre></td></tr></table></figure>

<p>2、配置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">  plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin(),</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>



<h2 id="打包字体文件"><a href="#打包字体文件" class="headerlink" title="打包字体文件"></a>打包字体文件</h2><p>还是使用 file-loader，只需要增加一个配置规则即可：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122162620802.png" alt="image-20191122162620802"></p>
<h2 id="打包-Less"><a href="#打包-Less" class="headerlink" title="打包 Less"></a>打包 Less</h2><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装过的就不用重新安装了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">npm install less less-loader style-loader css-loader --save-dev</span></pre></td></tr></table></figure>

<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122163446652.png" alt="image-20191122163446652"></p>
<p>3、打包测试</p>
<h2 id="ES6-转-ES5"><a href="#ES6-转-ES5" class="headerlink" title="ES6 转 ES5"></a>ES6 转 ES5</h2><p>为了让代码中的 ES6 能运行在低版本浏览器，我们需要把 ES6 转为 ES5 向下兼容。</p>
<p>Babel 是一个专门将 ES6 转 ES5 的编译工具。</p>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -D babel-loader @babel/core @babel/preset-env webpack</span></pre></td></tr></table></figure>



<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191122165529066.png" alt="image-20191122165529066"></p>
<p>3、打包测试</p>
<p>它只能把基本的语法转换兼容处理，例如：</p>
<ul>
<li>const</li>
<li>let</li>
<li>箭头函数</li>
<li>解构赋值</li>
<li>。。。</li>
</ul>
<p>当时它不会处理一些 API 方法，例如：</p>
<ul>
<li>字符串的 includes 方法</li>
<li>数组的<ul>
<li>find</li>
<li>findIndex</li>
<li>includes</li>
<li>。。。。</li>
</ul>
</li>
</ul>
<h3 id="API-兼容处理"><a href="#API-兼容处理" class="headerlink" title="API 兼容处理"></a>API 兼容处理</h3><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save @babel/polyfill</span></pre></td></tr></table></figure>



<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124090523101.png" alt="image-20191124090523101"></p>
<p>3、打包测试</p>
<h3 id="开启缓存"><a href="#开启缓存" class="headerlink" title="开启缓存"></a>开启缓存</h3><p>当代码文件比较多的时候，babel 打包非常耗时，我们建议开启缓存用以提高打包的效率。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124091122427.png" alt="image-20191124091122427"></p>
<h2 id="增加-source-maps"><a href="#增加-source-maps" class="headerlink" title="增加 source maps"></a>增加 source maps</h2><blockquote>
<p>建议阅读：<a href="https://blog.teamtreehouse.com/introduction-source-maps" target="_blank" rel="noopener">An Introduction to Source Maps</a></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124093220937.png" alt="image-20191124093220937"></p>
<h2 id="使用-watch-监视模式"><a href="#使用-watch-监视模式" class="headerlink" title="使用 watch 监视模式"></a>使用 watch 监视模式</h2><p>在 package.json 文件中新增一个 scripts 脚本：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124095723565.png" alt="image-20191124095723565"></p>
<h2 id="使用-webpack-dev-server"><a href="#使用-webpack-dev-server" class="headerlink" title="使用 webpack-dev-server"></a>使用 webpack-dev-server</h2><ul>
<li>开启一个 Web 服务器</li>
<li>监视打包</li>
<li>自动刷新浏览器</li>
<li>。。。。</li>
</ul>
<p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev webpack-dev-server</span></pre></td></tr></table></figure>



<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124100620633.png" alt="image-20191124100620633"></p>
<blockquote>
<p>在 <code>webpack.config.js</code> 中新增的配置项</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124100646425.png" alt="image-20191124100646425"></p>
<blockquote>
<p>在 <code>package.json</code> 文件中新增 NPM Scripts 脚本</p>
</blockquote>
<p>3、打包测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run serve</span></pre></td></tr></table></figure>

<h2 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h2><p>webpack-dev-server 默认是刷新整个页面实现更新。我们有一种更好的方式：热更新，可以在不刷新页面的情况下更新内容变化，效率更高。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124101715767.png" alt="image-20191124101715767"></p>
<blockquote>
<p>在 webpack 配置文件中</p>
</blockquote>
<blockquote>
<p>提示：如果修改了配置文件，必须重启打包才能生效。</p>
</blockquote>
<h2 id="打包-Vue"><a href="#打包-Vue" class="headerlink" title="打包 Vue"></a>打包 Vue</h2><p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -D vue-loader vue-template-compiler</span></pre></td></tr></table></figure>



<p>2、配置</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124104029319.png" alt="image-20191124104029319"></p>
<p>3、打包测试</p>
<h2 id="配置可以省略的后缀名"><a href="#配置可以省略的后缀名" class="headerlink" title="配置可以省略的后缀名"></a>配置可以省略的后缀名</h2><p>webpack 默认只支持省略：</p>
<ul>
<li>.wasm</li>
<li>.mjs</li>
<li>.js</li>
<li>.json</li>
</ul>
<p>等文件的后缀名。</p>
<p>如果想要让其支持其它的可省略的后缀名，需要单独配置。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124110450652.png" alt="image-20191124110450652"></p>
<h2 id="配置路径别名"><a href="#配置路径别名" class="headerlink" title="配置路径别名"></a>配置路径别名</h2><p>在 Vue CLI 项目中，使用过一个路径别名：<code>@</code>，它表示 <code>src</code> 的路径。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124111510567.png" alt="image-20191124111510567"></p>
<h2 id="使用-ESLint"><a href="#使用-ESLint" class="headerlink" title="使用 ESLint"></a>使用 ESLint</h2><p>ESLint 专门用于 JavaScript 代码格式校验工具。</p>
<ul>
<li>作者：<ul>
<li>《JavaScript 高级程序设计》</li>
<li>《深入理解 ECMAScript 6》</li>
<li>ESLint</li>
<li>。。。</li>
</ul>
</li>
</ul>
<p>1、安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install eslint eslint-loader --save-dev</span></pre></td></tr></table></figure>



<p>2、配置 webpack 配置文件</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20191124115208034.png" alt="image-20191124115208034"></p>
<blockquote>
<p>在 webpack 配置文件的 module.rules 中新增</p>
</blockquote>
<p>3、配置生成 eslint 配置文件</p>
<p>在终端下执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 如果你是 macOS 后者 Linux 系统，则使用 ./node_modules/.bin/eslint.cmd --init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">.\node_modules\.bin\eslint.cmd --init</span></pre></td></tr></table></figure>

<p>然后就是在终端中根据向导完成配置：</p>
<figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd --init</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to use ESLint?</span></pre></td></tr><tr><td class="code"><pre><span class="line">  To<span class="built_in"> check </span>syntax only</span></pre></td></tr><tr><td class="code"><pre><span class="line">  To<span class="built_in"> check </span>syntax<span class="built_in"> and </span>find problems</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; To<span class="built_in"> check </span>syntax, find problems,<span class="built_in"> and </span>enforce code style</span></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd --init</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like <span class="keyword">to</span> use ESLint? <span class="keyword">To</span> check syntax, <span class="builtin-name">find</span> problems, <span class="keyword">and</span> enforce code style</span></pre></td></tr><tr><td class="code"><pre><span class="line">? What<span class="built_in"> type </span>of modules does your project use?</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; JavaScript modules (import/export)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  CommonJS (require/exports)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  None of these</span></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd --init</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like <span class="keyword">to</span> use ESLint? <span class="keyword">To</span> check syntax, <span class="builtin-name">find</span> problems, <span class="keyword">and</span> enforce code style</span></pre></td></tr><tr><td class="code"><pre><span class="line">? What<span class="built_in"> type </span>of modules does your project use? JavaScript modules (import/export)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your project use?</span></pre></td></tr><tr><td class="code"><pre><span class="line">  React</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">  None of these</span></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd --init</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like <span class="keyword">to</span> use ESLint? <span class="keyword">To</span> check syntax, <span class="builtin-name">find</span> problems, <span class="keyword">and</span> enforce code style</span></pre></td></tr><tr><td class="code"><pre><span class="line">? What<span class="built_in"> type </span>of modules does your project use? JavaScript modules (import/export)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your project use? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your project use TypeScript? (y/N) n</span></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd <span class="comment">--init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to <span class="keyword">use</span> ESLint? <span class="keyword">To</span> <span class="keyword">check</span> syntax, find problems, <span class="keyword">and</span> enforce code <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">type</span> <span class="keyword">of</span> modules does your <span class="keyword">project</span> <span class="keyword">use</span>? JavaScript modules (<span class="keyword">import</span>/<span class="keyword">export</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your <span class="keyword">project</span> <span class="keyword">use</span>? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your <span class="keyword">project</span> <span class="keyword">use</span> TypeScript? <span class="keyword">No</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? <span class="keyword">Where</span> does your code run? (Press &lt;<span class="keyword">space</span>&gt; <span class="keyword">to</span> <span class="keyword">select</span>, &lt;a&gt; <span class="keyword">to</span> toggle <span class="keyword">all</span>, &lt;i&gt; <span class="keyword">to</span> invert selection)</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt;(*) Browser</span></pre></td></tr><tr><td class="code"><pre><span class="line"> ( ) Node</span></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd <span class="comment">--init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to <span class="keyword">use</span> ESLint? <span class="keyword">To</span> <span class="keyword">check</span> syntax, find problems, <span class="keyword">and</span> enforce code <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">type</span> <span class="keyword">of</span> modules does your <span class="keyword">project</span> <span class="keyword">use</span>? JavaScript modules (<span class="keyword">import</span>/<span class="keyword">export</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your <span class="keyword">project</span> <span class="keyword">use</span>? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your <span class="keyword">project</span> <span class="keyword">use</span> TypeScript? <span class="keyword">No</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? <span class="keyword">Where</span> does your code run? Browser</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">define</span> a <span class="keyword">style</span> <span class="keyword">for</span> your <span class="keyword">project</span>?</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; <span class="keyword">Use</span> a popular <span class="keyword">style</span> guide</span></pre></td></tr><tr><td class="code"><pre><span class="line">  Answer questions about your <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  Inspect your JavaScript <span class="keyword">file</span>(s)</span></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd <span class="comment">--init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to <span class="keyword">use</span> ESLint? <span class="keyword">To</span> <span class="keyword">check</span> syntax, find problems, <span class="keyword">and</span> enforce code <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">type</span> <span class="keyword">of</span> modules does your <span class="keyword">project</span> <span class="keyword">use</span>? JavaScript modules (<span class="keyword">import</span>/<span class="keyword">export</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your <span class="keyword">project</span> <span class="keyword">use</span>? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your <span class="keyword">project</span> <span class="keyword">use</span> TypeScript? <span class="keyword">No</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? <span class="keyword">Where</span> does your code run? Browser</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">define</span> a <span class="keyword">style</span> <span class="keyword">for</span> your <span class="keyword">project</span>? <span class="keyword">Use</span> a popular <span class="keyword">style</span> guide</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which <span class="keyword">style</span> guide <span class="keyword">do</span> you want <span class="keyword">to</span> follow?</span></pre></td></tr><tr><td class="code"><pre><span class="line">  Airbnb: https://github.com/airbnb/javascript</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; Standard: https://github.com/standard/standard</span></pre></td></tr><tr><td class="code"><pre><span class="line">  Google: https://github.com/google/eslint-config-google</span></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd <span class="comment">--init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to <span class="keyword">use</span> ESLint? <span class="keyword">To</span> <span class="keyword">check</span> syntax, find problems, <span class="keyword">and</span> enforce code <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">type</span> <span class="keyword">of</span> modules does your <span class="keyword">project</span> <span class="keyword">use</span>? JavaScript modules (<span class="keyword">import</span>/<span class="keyword">export</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your <span class="keyword">project</span> <span class="keyword">use</span>? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your <span class="keyword">project</span> <span class="keyword">use</span> TypeScript? <span class="keyword">No</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? <span class="keyword">Where</span> does your code run? Browser</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">define</span> a <span class="keyword">style</span> <span class="keyword">for</span> your <span class="keyword">project</span>? <span class="keyword">Use</span> a popular <span class="keyword">style</span> guide</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which <span class="keyword">style</span> guide <span class="keyword">do</span> you want <span class="keyword">to</span> follow? Standard: https://github.com/standard/standard</span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">format</span> <span class="keyword">do</span> you want your config <span class="keyword">file</span> <span class="keyword">to</span> be <span class="keyword">in</span>?</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; JavaScript</span></pre></td></tr><tr><td class="code"><pre><span class="line">  YAML</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">JSON</span></span></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ .\node_modules\.bin\eslint.cmd <span class="comment">--init</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you like to <span class="keyword">use</span> ESLint? <span class="keyword">To</span> <span class="keyword">check</span> syntax, find problems, <span class="keyword">and</span> enforce code <span class="keyword">style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">type</span> <span class="keyword">of</span> modules does your <span class="keyword">project</span> <span class="keyword">use</span>? JavaScript modules (<span class="keyword">import</span>/<span class="keyword">export</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which framework does your <span class="keyword">project</span> <span class="keyword">use</span>? Vue.js</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Does your <span class="keyword">project</span> <span class="keyword">use</span> TypeScript? <span class="keyword">No</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">? <span class="keyword">Where</span> does your code run? Browser</span></pre></td></tr><tr><td class="code"><pre><span class="line">? How would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">define</span> a <span class="keyword">style</span> <span class="keyword">for</span> your <span class="keyword">project</span>? <span class="keyword">Use</span> a popular <span class="keyword">style</span> guide</span></pre></td></tr><tr><td class="code"><pre><span class="line">? Which <span class="keyword">style</span> guide <span class="keyword">do</span> you want <span class="keyword">to</span> follow? Standard: https://github.com/standard/standard</span></pre></td></tr><tr><td class="code"><pre><span class="line">? What <span class="keyword">format</span> <span class="keyword">do</span> you want your config <span class="keyword">file</span> <span class="keyword">to</span> be <span class="keyword">in</span>? JavaScript</span></pre></td></tr><tr><td class="code"><pre><span class="line">Checking peerDependencies <span class="keyword">of</span> eslint-config-standard@latest</span></pre></td></tr><tr><td class="code"><pre><span class="line">The config that you<span class="string">'ve selected requires the following dependencies:</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">eslint-plugin-vue@latest eslint-config-standard@latest eslint@&gt;=6.2.2 eslint-plugin-import@&gt;=2.18.0 eslint-plugin-node@&gt;=9.1.0 eslint-plugin-promise@&gt;=4.2.1 eslint-plugin-standard@&gt;=4.0.0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">? Would you like to install them now with npm? (Y/n) y</span></span></pre></td></tr></table></figure>

<h3 id="自定义配置校验规则"><a href="#自定义配置校验规则" class="headerlink" title="自定义配置校验规则"></a>自定义配置校验规则</h3><p>ESLint 附带有大量的规则。你可以使用注释或配置文件修改你项目中要使用的规则。要改变一个规则设置，你必须将规则 ID 设置为下列值之一：</p>
<ul>
<li><code>&quot;off&quot;</code> 或 <code>0</code> - 关闭规则</li>
<li><code>&quot;warn&quot;</code> 或 <code>1</code> - 开启规则，使用警告级别的错误：<code>warn</code> (不会导致程序退出)</li>
<li><code>&quot;error&quot;</code> 或 <code>2</code> - 开启规则，使用错误级别的错误：<code>error</code> (当被触发的时候，程序会退出)</li>
</ul>
<p>详细的规则说明请查阅： <a href="https://eslint.bootcss.com/docs/rules/" target="_blank" rel="noopener">https://eslint.bootcss.com/docs/rules/</a> 。</p>
<p>也可以在代码中使用注释临时控制代码格式校验：</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">/* eslint eqeqeq: <span class="string">"off"</span>, curly: <span class="string">"error"</span> */</span></pre></td></tr></table></figure>

<p> 在这个例子里，<a href="https://eslint.bootcss.com/docs/user-guide/rules/eqeqeq" target="_blank" rel="noopener"><code>eqeqeq</code></a> 规则被关闭，<a href="https://eslint.bootcss.com/docs/user-guide/rules/curly" target="_blank" rel="noopener"><code>curly</code></a> 规则被打开，定义为错误级别。你也可以使用对应的数字定义规则严重程度： </p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">/*</span> <span class="attr">eslint eqeqeq:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">curly:</span> <span class="number">2</span> <span class="string">*/</span></span></pre></td></tr></table></figure>

<p>更多配置，建议参考： <a href="https://eslint.bootcss.com/docs/user-guide/configuring/" target="_blank" rel="noopener">https://eslint.bootcss.com/docs/user-guide/configuring/</a> 。</p>
<h2 id="在-Vue-CLI-创建的项目中配置-webpack"><a href="#在-Vue-CLI-创建的项目中配置-webpack" class="headerlink" title="在 Vue CLI 创建的项目中配置 webpack"></a>在 Vue CLI 创建的项目中配置 webpack</h2><p>优化。</p>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
        <tag>webpack-cil</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack学习</title>
    <url>/Webpack/webpack%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="webpack-基础知识"><a href="#webpack-基础知识" class="headerlink" title="webpack 基础知识"></a>webpack 基础知识</h2><h3 id="需要用到的包介绍"><a href="#需要用到的包介绍" class="headerlink" title="需要用到的包介绍"></a>需要用到的包介绍</h3><ul>
<li>webpack  - webpack 的核心包</li>
<li>webpack-cli - webpack 的命令行工具</li>
<li>webpack-dev-server - webpack 的开发服务器 （热更新）</li>
</ul>
<h3 id="webpack-cil-命令参考"><a href="#webpack-cil-命令参考" class="headerlink" title="webpack-cil 命令参考"></a>webpack-cil 命令参考</h3><p><a href="https://webpack.js.org/api/cli/" target="_blank" rel="noopener">https://webpack.js.org/api/cli/</a></p>
<h3 id="webpack-的打包过程"><a href="#webpack-的打包过程" class="headerlink" title="webpack 的打包过程"></a>webpack 的打包过程</h3><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/web%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.png" alt></p>
<h3 id="webpack初体验"><a href="#webpack初体验" class="headerlink" title="webpack初体验"></a>webpack初体验</h3><ul>
<li>webpack将ES6的模块化编译成浏览器能够识别的模块化</li>
<li>webpack默认只能打包js 和json文件</li>
<li>生产环境和开发环境的区别 ，开发环境是经过压缩的代码</li>
</ul>
<p>使用命令行设置打包入口出口和mode</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">webpack --entry  ./src/index.js -o ./dist --mode=development <span class="comment">#开发模式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">webpack --entry  ./src/index.js -o ./dist --mode=production <span class="comment">#生产模式</span></span></pre></td></tr></table></figure>

<h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><blockquote>
<p>指示 webpack 来干那些活 当运行 webpack 指令时 会加载里面的配置</p>
</blockquote>
<h2 id="打包样式资源"><a href="#打包样式资源" class="headerlink" title="打包样式资源"></a>打包样式资源</h2><h4 id="下载插件"><a href="#下载插件" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i css-loader style-loader less-loader less -D</span></pre></td></tr></table></figure>

<h4 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h4><h5 id="普通css文件"><a href="#普通css文件" class="headerlink" title="普通css文件"></a>普通css文件</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">"path"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//入口</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  entry: <span class="string">"./src/index.js"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//出口</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  output: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    filename: <span class="string">"bundle.js"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    path: resolve(__dirname, <span class="string">"dist"</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">//模式 development 、 production</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  mode: <span class="string">"development"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// loader</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.css$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 执行顺序由右到左</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// plugins 插件 （数组）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  plugins: []</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js 中引入样式 webpack 会通过import加载css 再通过 css-loader -&gt;style-loader 转换为style标签放在head中</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./index.css"</span></span></pre></td></tr></table></figure>

<h5 id="引入less-或sass-样式处理文件"><a href="#引入less-或sass-样式处理文件" class="headerlink" title="引入less 或sass 样式处理文件"></a>引入less 或sass 样式处理文件</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// rules 中 添加 less  或 sass 的处理规则</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    test:<span class="regexp">/\.less$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    use:[</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">//转化为style</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"style-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 处理css</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"css-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 转化为css</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"less-loader"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;</span></pre></td></tr></table></figure>

<h4 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h4><p>less 和 sass 不光要下对应的loader 还需要 less 或 sass 包  </p>
<p>ps：node-sass 安装起来比较麻烦 可以参照 <a href="https://www.cnblogs.com/zhishaofei/p/12712937.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhishaofei/p/12712937.html</a></p>
<h2 id="打包HTML资源"><a href="#打包HTML资源" class="headerlink" title="打包HTML资源"></a>打包HTML资源</h2><h4 id="下载插件-1"><a href="#下载插件-1" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev html-webpack-plugin</span></pre></td></tr></table></figure>

<p>tip: html-webpack-plugin 和 html-loader 的不同</p>
<ul>
<li>html-loader  是用来解析入口文件中关联的html中的image图片的引入</li>
<li>html-webpack-plugin  是用来自动生成最后dist目录下的index.html  (并自动导入打包好的js)</li>
</ul>
<p>html-webpack-plugin  插件的更多配置见官网 ：<a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">https://github.com/jantimon/html-webpack-plugin</a></p>
<h4 id="修改配置-1"><a href="#修改配置-1" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125;  = <span class="built_in">require</span>(<span class="string">'path'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    entry:<span class="string">'./src/index.js'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    output:&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        filename:<span class="string">'bundle.js'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        path:resolve(__dirname,<span class="string">'dist'</span>)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    mode:<span class="string">'development'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">module</span>:&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        rules:[]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    plugins:[</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// HtmlWebpackPlugin 会自动在output目录下生成index.html</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 并自动引入打包好的 bundle.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="comment">// 以./src/index.html 为模板 生成最后打包好的html</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            template:<span class="string">'./src/index.html'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>



<h2 id="打包图片资源"><a href="#打包图片资源" class="headerlink" title="打包图片资源"></a>打包图片资源</h2><h4 id="下载插件-2"><a href="#下载插件-2" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev html-loader url-loader file-loader</span></pre></td></tr></table></figure>

<h4 id="修改配置-2"><a href="#修改配置-2" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">"path"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  entry: <span class="string">"./src/index.js"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  output: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    filename: <span class="string">"bunle.js"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    path: resolve(__dirname, <span class="string">"dist"</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">    publicPath: <span class="string">''</span>, <span class="comment">// webpack5 中html中导入image需要设置publicPath （升级html-webpack-plugin 到 5.xx可以不用）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  mode: <span class="string">"development"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.less$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>, <span class="string">"less-loader"</span>]</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 解析图标 将小图标直接转base64 url-loader 依赖 file-loader 需要一起下载</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.(jpg|png|gif)$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        use: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            loader: <span class="string">"url-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="comment">// 小于8kb的以base64位插入 data:image/jpeg;base64,/9j</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="comment">// 大于8kb的以改为hash值为名称的原文件插入 </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">              limit: <span class="number">8</span> * <span class="number">1024</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">              esModule: <span class="literal">false</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 处理html文件的img图片（负责引入img，从而能被url-loader进行处理）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.html$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        use: <span class="string">"html-loader"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      template: <span class="string">"./index.html"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>



<h2 id="打包其他资源（字体等）"><a href="#打包其他资源（字体等）" class="headerlink" title="打包其他资源（字体等）"></a>打包其他资源（字体等）</h2><h4 id="修改配置-3"><a href="#修改配置-3" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 处理其他资源</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  exclude: <span class="regexp">/\.(html|js|css|less|jpg|png|gif)/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  loader: <span class="string">'file-loader'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">'[hash:10].[ext]'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    outputPath: <span class="string">'font'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>



<h2 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h2><h4 id="下载插件-3"><a href="#下载插件-3" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i webpack-dev-server -D</span></pre></td></tr></table></figure>

<h4 id="修改配置-4"><a href="#修改配置-4" class="headerlink" title="修改配置"></a>修改配置</h4><p>webpack.config.js 中添加</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 开发服务器 devServer：用来自动化（自动编译，自动打开浏览器，自动刷新浏览器~~）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 特点：只会在内存中编译打包，不会有任何输出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">devServer: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 项目构建后路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    contentBase: resolve(__dirname, <span class="string">'build'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 启动gzip压缩</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    compress: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 端口号</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    port: <span class="number">3000</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 自动打开浏览器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    open: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>

<p><strong>调用服务使用命令</strong> </p>
<p>如全局安装wabpack直接: <code>webpack serve</code></p>
<p>没有全局安装webpack :<code>npx webpack serve</code></p>
<p>启动服务后不会生成固定文件 devserver会在内存中进行编译</p>
<h4 id="使用express作为开发服务器配置"><a href="#使用express作为开发服务器配置" class="headerlink" title="使用express作为开发服务器配置"></a>使用express作为开发服务器配置</h4><p><a href="https://webpack.docschina.org/guides/development/#using-webpack-dev-middleware" target="_blank" rel="noopener">https://webpack.docschina.org/guides/development/#using-webpack-dev-middleware</a></p>
<h2 id="提取css文件为单独资源"><a href="#提取css文件为单独资源" class="headerlink" title="提取css文件为单独资源"></a>提取css文件为单独资源</h2><blockquote>
<p>用上面的方法打包出来的 css 都在js文件中  感觉加载时会闪一下  所以单独提炼出css (使用link标签)</p>
</blockquote>
<h4 id="下载插件-4"><a href="#下载插件-4" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev mini-css-extract-plugin</span></pre></td></tr></table></figure>

<h4 id="修改配置-5"><a href="#修改配置-5" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       test: <span class="regexp">/\.css$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">       use: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="comment">// 这个loader取代style-loader。作用：提取js中的css成单独文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">         MiniCssExtractPlugin.loader,</span></pre></td></tr><tr><td class="code"><pre><span class="line">         <span class="string">"css-loader"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">       ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ]</span></pre></td></tr><tr><td class="code"><pre><span class="line"> &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line"> plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     template: <span class="string">"./src/index.html"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;),</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="comment">// 对输出的css文件进行重命名</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     filename: <span class="string">"css/index.css"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;),</span></pre></td></tr><tr><td class="code"><pre><span class="line"> ]</span></pre></td></tr></table></figure>

<h2 id="css兼容性处理"><a href="#css兼容性处理" class="headerlink" title="css兼容性处理"></a>css兼容性处理</h2><p> 基于：<a href="https://www.postcss.com.cn/" target="_blank" rel="noopener">postcss</a></p>
<p>postcss 相当于一个启动器，里面可以装各种 插件 如 postcss-preset-env（预设环境） 和 autoprefixer(自动前缀)</p>
<h4 id="下载插件-5"><a href="#下载插件-5" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev postcss-loader postcss-preset-env</span></pre></td></tr></table></figure>

<ul>
<li>postcss-loader ：</li>
</ul>
<blockquote>
<p>在所有css | sass | less  loader前使用   作用： 使用 postcss 来解析 css</p>
</blockquote>
<ul>
<li>postcss-preset-env :</li>
</ul>
<blockquote>
<p>帮你将最新的 CSS 语法转换成大多数浏览器都能理解的语法，并根据你的目标浏览器或运行时环境来确定你需要的 polyfillss （postcss-preset-env 为 postcss 的 预设环境）</p>
</blockquote>
<h4 id="修改配置-6"><a href="#修改配置-6" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    test: <span class="regexp">/\.css$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    use: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      MiniCssExtractPlugin.loader,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"css-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">/*</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        css兼容性处理：postcss --&gt; postcss-loader -postcsspreset-env</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        帮postcss找到package.json中browserslist里面的配置，通过配置加载指定的css兼容性样式</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        "browserslist": &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          // 开发环境 --&gt; 设置node环境变量：process.env.NODE_ENV = development</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          "development": [</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "last 1 chrome version",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "last 1 firefox version",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "last 1 safari version"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          ],</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          // 生产环境：默认是看生产环境</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          "production": [</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "&gt;0.2%",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "not dead",</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            "not op_mini all"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          ]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">      */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 使用loader的默认配置</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 'postcss-loader',</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 修改loader的配置</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        loader: <span class="string">"postcss-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          postcssOptions: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">              [</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="string">"postcss-preset-env"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  <span class="comment">// Options</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">              ],</span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="comment">// 或者 require("postcss-preset-env")()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">]</span></pre></td></tr></table></figure>

<h4 id="browserslist"><a href="#browserslist" class="headerlink" title="browserslist"></a>browserslist</h4><p>具体配置说明 <a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener">https://github.com/browserslist/browserslist</a></p>
<p>在 package.json 中配置 browserslist 或添加 .browserslistrc文件</p>
<p>具体的环境是根据 process.env.NODE_ENV 确定， 所以需要设置 process.env.NODE_ENV ，只设置 mode: ‘production’ 不好使</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"browserslist": &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "development": [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      "last 1 chrome version",//兼容最近的谷歌浏览器</span></pre></td></tr><tr><td class="code"><pre><span class="line">      "last 1 firefox version",</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"last 1 safari version"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    ],</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "production": [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      "&gt;0.01%",//兼容&gt;0.01%</span></pre></td></tr><tr><td class="code"><pre><span class="line">      "not dead",//不用管弃用的浏览器</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">"not op_mini all"</span><span class="comment">//不用op</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>

<h2 id="压缩css"><a href="#压缩css" class="headerlink" title="压缩css"></a>压缩css</h2><p>webpack v4 使用 optimize-css-assets-webpack-plugin</p>
<p>对于webpack v5或更高版本，请改用css-minimizer-webpack-plugin。</p>
<h4 id="下载插件-6"><a href="#下载插件-6" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev css-minimizer-webpack-plugin</span></pre></td></tr></table></figure>

<h4 id="修改配置-7"><a href="#修改配置-7" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CssMinimizerPlugin = <span class="built_in">require</span>(<span class="string">'css-minimizer-webpack-plugin'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span> :...,</span></pre></td></tr><tr><td class="code"><pre><span class="line">plugins:...,</span></pre></td></tr><tr><td class="code"><pre><span class="line">optimization: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    minimize: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    minimizer: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// For webpack@5 you can use the `...` syntax to extend existing minimizers (i.e. `terser-webpack-plugin`), uncomment the next line</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// `...`,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">new</span> CssMinimizerPlugin(),</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ],</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr></table></figure>

<h2 id="js语法检查"><a href="#js语法检查" class="headerlink" title="js语法检查"></a>js语法检查</h2><h4 id="下载插件-7"><a href="#下载插件-7" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev eslint-loader eslint eslint-config-airbnb-base eslint-plugin-import</span></pre></td></tr></table></figure>

<ul>
<li><p>eslint-loader 已经弃用  请使用 eslint-webpack-plugin</p>
</li>
<li><p>eslint-config-airbnb-base ：airbnb标准的所以规则 需要<code>eslint</code>和<code>eslint-plugin-import</code>。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev eslint-webpack-plugin</span></pre></td></tr></table></figure>

<h4 id="修改配置-8"><a href="#修改配置-8" class="headerlink" title="修改配置"></a>修改配置</h4><h5 id="eslint-loader-（已经弃用）"><a href="#eslint-loader-（已经弃用）" class="headerlink" title="eslint-loader （已经弃用）"></a>eslint-loader （已经弃用）</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">/*</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">        语法检查： eslint-loader  eslint</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          注意：只检查自己写的源代码，第三方的库是不用检查的</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">          设置检查规则：</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            package.json中eslintConfig中设置~</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">              "eslintConfig": &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">                "extends": "airbnb-base"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">              &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">            airbnb --&gt; eslint-config-airbnb-base  eslint-plugin-import eslint</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">      */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.js$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        loader: <span class="string">'eslint-loader'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">// 自动修复eslint的错误</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          fix: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr></table></figure>

<h5 id="eslint-webpack-plugin"><a href="#eslint-webpack-plugin" class="headerlink" title="eslint-webpack-plugin"></a>eslint-webpack-plugin</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ESLintPlugin = <span class="built_in">require</span>(<span class="string">'eslint-webpack-plugin'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  plugins: [<span class="keyword">new</span> ESLintPlugin(options)],</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<h5 id="eslint-的配置"><a href="#eslint-的配置" class="headerlink" title="eslint 的配置"></a>eslint 的配置</h5><p> 在 package.json 中的<code>&quot;eslintConfig&quot;</code>   或者 <code>.eslintrc.js</code>  中修改 eslint 的配置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">extends: <span class="string">"airbnb-base"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">env: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  browser: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">rules: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"no-console"</span>: process.env.NODE_ENV === <span class="string">"development"</span> ? <span class="string">"off"</span> : <span class="string">"warn"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<blockquote>
<p>eslint 全配置：<a href="https://eslint.bootcss.com/docs/user-guide/configuring#extending-configuration-files" target="_blank" rel="noopener">https://eslint.bootcss.com/docs/user-guide/configuring#extending-configuration-files</a></p>
</blockquote>
<h2 id="js兼容性处理"><a href="#js兼容性处理" class="headerlink" title="js兼容性处理"></a>js兼容性处理</h2><h4 id="下载插件-8"><a href="#下载插件-8" class="headerlink" title="下载插件"></a>下载插件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save-dev  babel babel-loader @babel/core @babel/preset-env @babel/polyfill core-js</span></pre></td></tr></table></figure>

<ul>
<li><p>@babel/preset-env  babel预设环境</p>
</li>
<li><p>@babel/polyfill   所有的转换包集合 Babel 7.4.0开始，不赞成使用此软件包</p>
</li>
<li><p>core-js  是babel-polyfill 的底层依赖 可以配合useBuiltIns 选项实现按需加载</p>
</li>
</ul>
<h4 id="修改配置-9"><a href="#修改配置-9" class="headerlink" title="修改配置"></a>修改配置</h4><p>有两种方式配置babel</p>
<ul>
<li>在webpack.config.js中配置</li>
<li>在babel.config.js中配置</li>
</ul>
<h5 id="在webpack-config-js中配置"><a href="#在webpack-config-js中配置" class="headerlink" title="在webpack.config.js中配置"></a>在webpack.config.js中配置</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        test: <span class="regexp">/\.js$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        loader: <span class="string">'babel-loader'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          rootMode: <span class="string">"upward"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          <span class="comment">// 预设：指示babel做怎么样的兼容性处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">          presets: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">            [</span></pre></td></tr><tr><td class="code"><pre><span class="line">              <span class="string">'@babel/preset-env'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">              &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 按需加载</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                useBuiltIns: <span class="string">'usage'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 指定core-js版本</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                corejs: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  version: <span class="number">3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                <span class="comment">// 指定兼容性做到哪个版本浏览器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                targets: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  chrome: <span class="string">'60'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  firefox: <span class="string">'60'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  ie: <span class="string">'9'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  safari: <span class="string">'10'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">                  edge: <span class="string">'17'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">                &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">              &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">          ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr></table></figure>

<h5 id="在babel-config-js中配置"><a href="#在babel-config-js中配置" class="headerlink" title="在babel.config.js中配置"></a>在babel.config.js中配置</h5><p>或者将配置放到项目根目录的babel.config.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      test: <span class="regexp">/\.js$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      exclude: <span class="regexp">/node_modules/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      loader: <span class="string">'babel-loader'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        rootMode: <span class="string">"upward"</span>,  <span class="comment">// 需要配置 rootMode: "upward" 意思是向上查找 找到 babel.config.[json | js]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

<p>babel.config.js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// 预设：指示 babel 做怎么样的兼容性处理</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  presets: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    [</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="string">'@babel/preset-env'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 按需加载</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        useBuiltIns: <span class="string">'usage'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 指定core-js版本</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        corejs: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          version: <span class="number">3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 指定兼容性做到哪个版本浏览器</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        targets: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          chrome: <span class="string">'60'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          firefox: <span class="string">'60'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          ie: <span class="string">'9'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          safari: <span class="string">'10'</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          edge: <span class="string">'17'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr></table></figure>

<h2 id="js压缩和html压缩"><a href="#js压缩和html压缩" class="headerlink" title="js压缩和html压缩"></a>js压缩和html压缩</h2><h4 id="修改配置-10"><a href="#修改配置-10" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 生产环境下会自动压缩js代码 和 html代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">mode: <span class="string">'production'</span></span></pre></td></tr></table></figure>

<p> 也可以自定义压缩配置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    template: <span class="string">"./src/index.html"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 当webpack的默认mode值为'production' 自动设置 minify: true </span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 全部配置查看：https://www.npmjs.com/package/html-webpack-plugin#minification</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 压缩html代码</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    minify: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 移除空格</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      collapseWhitespace: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">// 移除注释</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      removeComments: <span class="literal">true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;)</span></pre></td></tr><tr><td class="code"><pre><span class="line">]</span></pre></td></tr></table></figure>



<h2 id="webpack性能优化"><a href="#webpack性能优化" class="headerlink" title="webpack性能优化"></a>webpack性能优化</h2><ul>
<li>开发环境性能优化</li>
<li>生产环境性能优化</li>
</ul>
<h3 id="开发环境性能优化"><a href="#开发环境性能优化" class="headerlink" title="开发环境性能优化"></a>开发环境性能优化</h3><ul>
<li>优化打包构建速度<ul>
<li>HMR</li>
</ul>
</li>
<li>优化代码调试<ul>
<li>source-map</li>
</ul>
</li>
</ul>
<h3 id="生产环境性能优化"><a href="#生产环境性能优化" class="headerlink" title="生产环境性能优化"></a>生产环境性能优化</h3><ul>
<li>优化打包构建速度<ul>
<li>oneOf</li>
<li>babel缓存</li>
<li>多进程打包</li>
<li>externals</li>
<li>dll</li>
</ul>
</li>
<li>优化代码运行的性能<ul>
<li>缓存(hash-chunkhash-contenthash)</li>
<li>tree shaking</li>
<li>code split</li>
<li>懒加载/预加载</li>
<li>pwa</li>
</ul>
</li>
</ul>
<h2 id="HMR"><a href="#HMR" class="headerlink" title="HMR"></a>HMR</h2><h3 id="tip"><a href="#tip" class="headerlink" title="tip:"></a>tip:</h3><p>webpack 5 需要使用 npm i <a href="mailto:webpack-dev-server@4.0.0-beta.0" target="_blank" rel="noopener">webpack-dev-server@4.0.0-beta.0</a></p>
<p> 但是目前4.0.0-beta.0还不完善 文档没有更新 热模块重载不好使</p>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p> hot module replacement 热模块替换 / 模块热替换</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>一个模块发生变化，只会重新打包这一个模块（而不是打包所有模块）<br>      极大提升构建速度</p>
<ul>
<li><p>样式文件：可以使用HMR功能：因为style-loader内部实现了~</p>
<ul>
<li>js文件：默认不能使用HMR功能 –&gt; 需要修改js代码，添加支持HMR功能的代码<br>注意：HMR功能对js的处理，只能处理非入口js文件的其他文件。</li>
<li>html文件: 默认不能使用HMR功能.同时会导致问题：html文件不能热更新了~ （不用做HMR功能）<br>解决：修改entry入口，将html文件引入</li>
</ul>
</li>
</ul>
<h3 id="各大框架的-loader-内部支持了-HMR"><a href="#各大框架的-loader-内部支持了-HMR" class="headerlink" title="各大框架的 loader 内部支持了 HMR"></a>各大框架的 loader 内部支持了 HMR</h3><ul>
<li>React Hot Loader: 实时调整 react 组件。</li>
<li>Vue Loader: 此 loader 支持 vue 组件的 HMR，提供开箱即用体验。</li>
<li>Elm Hot webpack Loader: 支持 Elm 编程语言的 HMR。</li>
<li>Angular HMR: 没有必要使用 loader！直接修改 NgModule 主文件就够了</li>
</ul>
<h4 id="修改配置-11"><a href="#修改配置-11" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 4.0 开启热更新</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">devServer: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    contentBase: resolve(__dirname, <span class="string">'dist'</span>),</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 开启HMR功能</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 当修改了webpack配置，新配置要想生效，必须重新webpack服务</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    hot: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    compress: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    port: <span class="number">3000</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    open: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr></table></figure>

<h2 id="source-map"><a href="#source-map" class="headerlink" title="source-map"></a>source-map</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">source-map: 一种 提供源代码到构建后代码映射 技术 （如果构建后代码出错了，通过映射可以追踪源代码错误）</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    [inline-|hidden-|<span class="built_in">eval</span>-][nosources-][cheap-[<span class="built_in">module</span>-]]source-map</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    source-map：外部</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息 和 源代码的错误位置</span></pre></td></tr><tr><td class="code"><pre><span class="line">    inline-source-map：内联</span></pre></td></tr><tr><td class="code"><pre><span class="line">      只生成一个内联source-map</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息 和 源代码的错误位置</span></pre></td></tr><tr><td class="code"><pre><span class="line">    hidden-source-map：外部</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码错误原因，但是没有错误位置</span></pre></td></tr><tr><td class="code"><pre><span class="line">      不能追踪源代码错误，只能提示到构建后代码的错误位置</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">eval</span>-source-map：内联</span></pre></td></tr><tr><td class="code"><pre><span class="line">      每一个文件都生成对应的source-map，都在<span class="built_in">eval</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息 和 源代码的错误位置</span></pre></td></tr><tr><td class="code"><pre><span class="line">    nosources-source-map：外部</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息, 但是没有任何源代码信息</span></pre></td></tr><tr><td class="code"><pre><span class="line">    cheap-source-map：外部</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息 和 源代码的错误位置 </span></pre></td></tr><tr><td class="code"><pre><span class="line">      只能精确的行</span></pre></td></tr><tr><td class="code"><pre><span class="line">    cheap-<span class="built_in">module</span>-source-map：外部</span></pre></td></tr><tr><td class="code"><pre><span class="line">      错误代码准确信息 和 源代码的错误位置 </span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="built_in">module</span>会将loader的source map加入</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    内联 和 外部的区别：<span class="number">1.</span> 外部生成了文件，内联没有 <span class="number">2.</span> 内联构建速度更快</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    开发环境：速度快，调试更友好</span></pre></td></tr><tr><td class="code"><pre><span class="line">      速度快(<span class="built_in">eval</span>&gt;inline&gt;cheap&gt;...)</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">eval</span>-cheap-souce-map</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">eval</span>-source-map</span></pre></td></tr><tr><td class="code"><pre><span class="line">      调试更友好  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        souce-map</span></pre></td></tr><tr><td class="code"><pre><span class="line">        cheap-<span class="built_in">module</span>-souce-map</span></pre></td></tr><tr><td class="code"><pre><span class="line">        cheap-souce-map</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">      --&gt; <span class="built_in">eval</span>-source-map  / <span class="built_in">eval</span>-cheap-<span class="built_in">module</span>-souce-map</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    生产环境：源代码要不要隐藏? 调试要不要更友好</span></pre></td></tr><tr><td class="code"><pre><span class="line">      内联会让代码体积变大，所以在生产环境不用内联</span></pre></td></tr><tr><td class="code"><pre><span class="line">      nosources-source-map 全部隐藏</span></pre></td></tr><tr><td class="code"><pre><span class="line">      hidden-source-map 只隐藏源代码，会提示构建后代码错误信息</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">      --&gt; source-map / cheap-<span class="built_in">module</span>-souce-map</span></pre></td></tr></table></figure>

<h4 id="修改配置-12"><a href="#修改配置-12" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 开发环境</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">devtool: <span class="string">'eval-source-map'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 生产环境</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">devtool: <span class="string">'source-map'</span>  <span class="comment">// 根据需求进行选择</span></span></pre></td></tr></table></figure>

<h2 id="oneOf"><a href="#oneOf" class="headerlink" title="oneOf"></a>oneOf</h2><p>oneOf：让一个文件只有一个loader处理 ，找打对应的loader就不往下遍历了。</p>
<h4 id="修改配置-13"><a href="#修改配置-13" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  rules: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 需要每个类型的文件都处理的loader 单独在oneOf外面</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="comment">//  oneOf 内部 一个 rule 只处理一个类型 找到对应类型的 rule 就不再继续往下遍历</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      oneOf: [</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">          test: <span class="regexp">/\.css$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">          use: styleCommonLodar</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">     	...</span></pre></td></tr><tr><td class="code"><pre><span class="line">      ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ]</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

<h4 id="优化效果"><a href="#优化效果" class="headerlink" title="优化效果"></a>优化效果</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#优化前</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">webpack 5.22.0 compiled with 1 warning <span class="keyword">in</span> 12820 ms</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">#优化后</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">webpack 5.22.0 compiled with 1 warning <span class="keyword">in</span> 9615 ms</span></pre></td></tr></table></figure>





<h2 id="babel缓存"><a href="#babel缓存" class="headerlink" title="babel缓存"></a>babel缓存</h2><p>缓存文件会放在 <code>node_modules\.cache\babel-loader</code>中，如果编译的不对删除这个文件再试</p>
<h4 id="修改配置-14"><a href="#修改配置-14" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  test: <span class="regexp">/\.js$/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  exclude: <span class="regexp">/node_modules/</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  loader: <span class="string">"babel-loader"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  options: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 开启babel缓存</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 第二次构建时，会读取之前的缓存</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 缓存文件会放在 node_modules\.cache\babel-loader中  如果编译的不对删除这个文件再试</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    cacheDirectory: <span class="literal">true</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    rootMode: <span class="string">"upward"</span> <span class="comment">// 需要配置 rootMode: "upward" 意思是向上查找 找到 babel.config.[json | js]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr></table></figure>

<h4 id="优化效果-1"><a href="#优化效果-1" class="headerlink" title="优化效果"></a>优化效果</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#优化前</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">webpack 5.22.0 compiled with 1 warning <span class="keyword">in</span> 11641 ms</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">#优化后 再次打包</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">webpack 5.22.0 compiled with 1 warning <span class="keyword">in</span> 8476 ms</span></pre></td></tr></table></figure>



<h2 id="tree-shaking-树摇"><a href="#tree-shaking-树摇" class="headerlink" title="tree shaking 树摇"></a>tree shaking 树摇</h2><p> tree shaking：去除无用代码</p>
<h4 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h4><ol>
<li><p>必须使用ES6模块化 </p>
</li>
<li><p>开启production环境</p>
</li>
</ol>
<h4 id="作用-1"><a href="#作用-1" class="headerlink" title="作用:"></a>作用:</h4><p>减少代码体积</p>
<h4 id="修改配置-15"><a href="#修改配置-15" class="headerlink" title="修改配置"></a>修改配置</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//webpack.config.js</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">mode:<span class="string">'production'</span></span></pre></td></tr></table></figure>

<h5 id="sideEffects"><a href="#sideEffects" class="headerlink" title="sideEffects"></a>sideEffects</h5><p>  在package.json中配置  sideEffects ：副作用 （导入了例如css less 等样式 ，代码上是没用到的 ，但是需要保留的 ）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"sideEffects"</span>: <span class="literal">false</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//所有代码都没有副作用（都可以进行tree shaking） 问题：可能会把css / @babel/polyfill （副作用）文件干掉</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">"sideEffects"</span>: [<span class="string">"*.css"</span>, <span class="string">"*.less"</span>,<span class="string">"*iconfont.js"</span> ] <span class="comment">//当需要保留的文件名放到数组中</span></span></pre></td></tr></table></figure>

<h4 id="官方结论"><a href="#官方结论" class="headerlink" title="官方结论"></a>官方结论</h4><p>因此，我们学到为了利用 <em>tree shaking</em> 的优势， 你必须…</p>
<ul>
<li>使用 ES2015 模块语法（即 <code>import</code> 和 <code>export</code>）。</li>
<li>确保没有编译器将您的 ES2015 模块语法转换为 CommonJS 的（顺带一提，这是现在常用的 @babel/preset-env 的默认行为，详细信息请参阅<a href="https://babeljs.io/docs/en/babel-preset-env#modules" target="_blank" rel="noopener">文档</a>）。</li>
<li>在项目的 <code>package.json</code> 文件中，添加 <code>&quot;sideEffects&quot;</code> 属性。</li>
<li>使用 <code>mode</code> 为 <code>&quot;production&quot;</code> 的配置项以启用<a href="https://webpack.docschina.org/concepts/mode/#usage" target="_blank" rel="noopener">更多优化项</a>，包括压缩代码与 tree shaking。</li>
</ul>
<p>你可以将应用程序想象成一棵树。绿色表示实际用到的 source code(源码) 和 library(库)，是树上活的树叶。灰色表示未引用代码，是秋天树上枯萎的树叶。为了除去死去的树叶，你必须摇动这棵树，使它们落下。</p>
<h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2><h3 id="生产环境配置官方文档"><a href="#生产环境配置官方文档" class="headerlink" title="生产环境配置官方文档"></a>生产环境配置官方文档</h3><p><a href="https://webpack.docschina.org/guides/production/" target="_blank" rel="noopener">https://webpack.docschina.org/guides/production/</a></p>
<h3 id="css压缩、提取"><a href="#css压缩、提取" class="headerlink" title="css压缩、提取"></a>css压缩、提取</h3><p><a href="https://webpack.docschina.org/plugins/mini-css-extract-plugin/#minimizing-for-production" target="_blank" rel="noopener">https://webpack.docschina.org/plugins/mini-css-extract-plugin/#minimizing-for-production</a></p>
<h2 id="每次打包清除打包文件"><a href="#每次打包清除打包文件" class="headerlink" title="每次打包清除打包文件"></a>每次打包清除打包文件</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">plugins:[</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin(),</span></pre></td></tr><tr><td class="code"><pre><span class="line">]</span></pre></td></tr></table></figure>



<h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><p>Error: Automatic publicPath is not supported in this browser</p>
<p>设置 output 中 publicPath: ‘’  为空字符串</p>
<h2 id="tip-：项目中的基础知识"><a href="#tip-：项目中的基础知识" class="headerlink" title="tip ：项目中的基础知识"></a>tip ：项目中的基础知识</h2><h3 id="node模块的搜索流程"><a href="#node模块的搜索流程" class="headerlink" title="node模块的搜索流程"></a>node模块的搜索流程</h3><blockquote>
<p>node在使用模块名来引入模块时,会首先在当前目录的node_modules中寻找是否有该模块<br>如果有则直接使用,如果没有则会一直向上一级目录的node_modules中寻找，直到磁盘的根目录</p>
</blockquote>
<h3 id="browserslistrc"><a href="#browserslistrc" class="headerlink" title=".browserslistrc"></a>.browserslistrc</h3><p>对应package.json 中的 browserslist   </p>
<p>postcss-preset-env 会找到 browserslist  作为兼容的基础</p>
<p>browserslist   配置  <a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener">https://github.com/browserslist/browserslist</a></p>
<h3 id="eslintrc-js"><a href="#eslintrc-js" class="headerlink" title=".eslintrc.js"></a>.eslintrc.js</h3><p>对应package.json 中的 eslintConfig  </p>
<p>eslint 配置  <a href="https://eslint.org/docs/developer-guide/nodejs-api#%E2%97%86-new-eslint-options" target="_blank" rel="noopener">https://eslint.org/docs/developer-guide/nodejs-api#%E2%97%86-new-eslint-options</a></p>
<h3 id="babel-config-js"><a href="#babel-config-js" class="headerlink" title="babel.config.js"></a>babel.config.js</h3><p>bable 的配置文件 对应 webpack.config.js 中 babel-loader 的 options</p>
<p>babel.config.js文件，可以使用不同的扩展名（<code>.js</code>，<code>.cjs</code>，<code>.mjs</code>)</p>
<p>bable的配置文件分为两种：</p>
<ul>
<li>babel.config.js 整个项目都用这个babel配置（项目范围的配置）</li>
<li>.babelrc.js  配置文件是否仅适用于项目的某个部分  （相对文件配置）</li>
</ul>
<p>具体配置：<a href="https://babeljs.io/docs/en/config-files" target="_blank" rel="noopener">https://babeljs.io/docs/en/config-files</a></p>
<h3 id="prettierrc-js"><a href="#prettierrc-js" class="headerlink" title=".prettierrc.js"></a>.prettierrc.js</h3><p> vscode 中的 prettier 插件 会优先已这个文件作为格式化的配置</p>
<p>配置同 prettier 插件 <a href="https://prettier.io/docs/en/options.html" target="_blank" rel="noopener">https://prettier.io/docs/en/options.html</a></p>
<h2 id="核心模块"><a href="#核心模块" class="headerlink" title="核心模块"></a>核心模块</h2><h3 id="postcss"><a href="#postcss" class="headerlink" title="postcss"></a>postcss</h3><blockquote>
<p>css 兼容性插件</p>
</blockquote>
<p> 配合webpack使用 ：postcss-loader  <a href="https://www.npmjs.com/package/postcss-loader" target="_blank" rel="noopener">https://www.npmjs.com/package/postcss-loader</a></p>
<h3 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h3><blockquote>
<p>语法检查校验插件</p>
</blockquote>
<p> 配合webpack使用 ：eslint-webpack-plugin  <a href="https://www.npmjs.com/package/eslint-webpack-plugin" target="_blank" rel="noopener">https://www.npmjs.com/package/eslint-webpack-plugin</a></p>
<h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><blockquote>
<p>js 兼容性插件</p>
</blockquote>
<p> 配合webpack使用 ： babel-loader <a href="https://www.npmjs.com/package/babel-loader" target="_blank" rel="noopener">https://www.npmjs.com/package/babel-loader</a></p>
]]></content>
      <categories>
        <category>Webpack</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
        <tag>webpakc-cli</tag>
      </tags>
  </entry>
  <entry>
    <title>正则学习笔记</title>
    <url>/%E6%AD%A3%E5%88%99/%E6%AD%A3%E5%88%99%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h1 id="正则学习笔记"><a href="#正则学习笔记" class="headerlink" title="正则学习笔记"></a>正则学习笔记</h1><h2 id="书写规则"><a href="#书写规则" class="headerlink" title="书写规则"></a>书写规则</h2><p>参考：<a href="https://www.w3school.com.cn/jsref/jsref_obj_regexp.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/jsref/jsref_obj_regexp.asp</a></p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200709190842389.png" alt="image-20200708184136181"></p>
<h2 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h2><p>元字符（Metacharacter）是拥有特殊含义的字符：</p>
<table>
<thead>
<tr>
<th align="left">元字符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_dot.asp" target="_blank" rel="noopener">.</a></td>
<td align="left">查找单个字符，除了换行和行结束符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_wordchar.asp" target="_blank" rel="noopener">\w</a></td>
<td align="left">查找单词字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_wordchar_non.asp" target="_blank" rel="noopener">\W</a></td>
<td align="left">查找非单词字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_digit.asp" target="_blank" rel="noopener">\d</a></td>
<td align="left">查找数字。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_digit_non.asp" target="_blank" rel="noopener">\D</a></td>
<td align="left">查找非数字字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_whitespace.asp" target="_blank" rel="noopener">\s</a></td>
<td align="left">查找空白字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_whitespace_non.asp" target="_blank" rel="noopener">\S</a></td>
<td align="left">查找非空白字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_begin.asp" target="_blank" rel="noopener">\b</a></td>
<td align="left">匹配单词边界。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_begin_not.asp" target="_blank" rel="noopener">\B</a></td>
<td align="left">匹配非单词边界。</td>
</tr>
<tr>
<td align="left">\0</td>
<td align="left">查找 NUL 字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_newline.asp" target="_blank" rel="noopener">\n</a></td>
<td align="left">查找换行符。</td>
</tr>
<tr>
<td align="left">\f</td>
<td align="left">查找换页符。</td>
</tr>
<tr>
<td align="left">\r</td>
<td align="left">查找回车符。</td>
</tr>
<tr>
<td align="left">\t</td>
<td align="left">查找制表符。</td>
</tr>
<tr>
<td align="left">\v</td>
<td align="left">查找垂直制表符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_octal.asp" target="_blank" rel="noopener">\xxx</a></td>
<td align="left">查找以八进制数 xxx 规定的字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_hex.asp" target="_blank" rel="noopener">\xdd</a></td>
<td align="left">查找以十六进制数 dd 规定的字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_unicode_hex.asp" target="_blank" rel="noopener">\uxxxx</a></td>
<td align="left">查找以十六进制数 xxxx 规定的 Unicode 字符。</td>
</tr>
</tbody></table>
<h2 id="量词"><a href="#量词" class="headerlink" title="量词"></a>量词</h2><table>
<thead>
<tr>
<th align="left">量词</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_onemore.asp" target="_blank" rel="noopener">n+</a></td>
<td align="left">匹配任何包含至少一个 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_zeromore.asp" target="_blank" rel="noopener">n*</a></td>
<td align="left">匹配任何包含零个或多个 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_zeroone.asp" target="_blank" rel="noopener">n?</a></td>
<td align="left">匹配任何包含零个或一个 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_nx.asp" target="_blank" rel="noopener">n{X}</a></td>
<td align="left">匹配包含 X 个 n 的序列的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_nxy.asp" target="_blank" rel="noopener">n{X,Y}</a></td>
<td align="left">匹配包含 X 至 Y 个 n 的序列的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_nxcomma.asp" target="_blank" rel="noopener">n{X,}</a></td>
<td align="left">匹配包含至少 X 个 n 的序列的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_ndollar.asp" target="_blank" rel="noopener">n$</a></td>
<td align="left">匹配任何结尾为 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_ncaret.asp" target="_blank" rel="noopener">^n</a></td>
<td align="left">匹配任何开头为 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_nfollow.asp" target="_blank" rel="noopener">?=n</a></td>
<td align="left">匹配任何其后紧接指定字符串 n 的字符串。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_nfollow_not.asp" target="_blank" rel="noopener">?!n</a></td>
<td align="left">匹配任何其后没有紧接指定字符串 n 的字符串。</td>
</tr>
</tbody></table>
<blockquote>
<p>量词的影响范围：量词只能默认影响前面一个字符或一个（）中的内容 要影响多个可以配置分组使用</p>
</blockquote>
<h2 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h2><table>
<thead>
<tr>
<th align="left">修饰符</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_i.asp" target="_blank" rel="noopener">i</a></td>
<td align="left">执行对大小写不敏感的匹配。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_g.asp" target="_blank" rel="noopener">g</a></td>
<td align="left">执行全局匹配（查找所有匹配而非在找到第一个匹配后停止）。</td>
</tr>
<tr>
<td align="left">m</td>
<td align="left">执行多行匹配。</td>
</tr>
</tbody></table>
<h2 id="范围匹配"><a href="#范围匹配" class="headerlink" title="范围匹配"></a>范围匹配</h2><p>方括号用于查找某个范围内的字符：</p>
<table>
<thead>
<tr>
<th align="left">表达式</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_charset.asp" target="_blank" rel="noopener">[abc]</a></td>
<td align="left">查找方括号之间的任何字符。</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_charset_not.asp" target="_blank" rel="noopener">[^abc]</a></td>
<td align="left">查找任何不在方括号之间的字符。</td>
</tr>
<tr>
<td align="left">[0-9]</td>
<td align="left">查找任何从 0 至 9 的数字。</td>
</tr>
<tr>
<td align="left">[a-z]</td>
<td align="left">查找任何从小写 a 到小写 z 的字符。</td>
</tr>
<tr>
<td align="left">[A-Z]</td>
<td align="left">查找任何从大写 A 到大写 Z 的字符。</td>
</tr>
<tr>
<td align="left">[A-z]</td>
<td align="left">查找任何从大写 A 到小写 z 的字符。</td>
</tr>
<tr>
<td align="left">[adgk]</td>
<td align="left">查找给定集合内的任何字符。</td>
</tr>
<tr>
<td align="left">[^adgk]</td>
<td align="left">查找给定集合外的任何字符。</td>
</tr>
<tr>
<td align="left">(red|blue|green)</td>
<td align="left">查找任何指定的选项。</td>
</tr>
</tbody></table>
<h2 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h2><p>/([A-z]\d)+/</p>
<h2 id="位置限制"><a href="#位置限制" class="headerlink" title="位置限制"></a>位置限制</h2><p>^ $</p>
<h2 id="范围排除"><a href="#范围排除" class="headerlink" title="范围排除"></a>范围排除</h2><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/image-20200708184136181.png" alt="image-20200709190842389"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">'afcabcaccadc'</span>.match(<span class="regexp">/a[^bfac]c/g</span>) 表示a c 之间排除bfac</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//["adc"]</span></span></pre></td></tr></table></figure>

<blockquote>
<p>[ ^ ] ^在中括号开始位置时表示排除[ ] 内的字符 注意：在中间就只代表^符号</p>
</blockquote>
<h2 id="多选匹配"><a href="#多选匹配" class="headerlink" title="多选匹配"></a>多选匹配</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">/[a-z]|[A-Z]+<span class="regexp">/g 匹配小写或大写字母</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="regexp">'AFAFsdfDsdfDFASDdsfDSFsdfFD'.match(/</span>[a-z]|[A-Z]+<span class="regexp">/g)</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="regexp">/</span><span class="regexp">/["AFAF", "s", "d", "f", "D", "s", "d", "f", "DFASD", "d", "s", "f", "DSF", "s", "d", "f", "FD"]</span></span></pre></td></tr></table></figure>

<blockquote>
<p>多选匹配分别配置各自的结果 并都返回</p>
</blockquote>
<h2 id="正则方法"><a href="#正则方法" class="headerlink" title="正则方法"></a>正则方法</h2><h3 id="1-test-方法"><a href="#1-test-方法" class="headerlink" title="1. test 方法"></a>1. test 方法</h3><p>返回 true 或 false 验证字符串中有没有符合要求</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">/^<span class="number">1</span>[<span class="number">3</span><span class="number">-9</span>]\d&#123;<span class="number">9</span>&#125;$/.test(<span class="string">"12333333"</span>); <span class="comment">//验证手机号码 false</span></span></pre></td></tr></table></figure>

<h3 id="2-exec-提取正则中符合要求的值"><a href="#2-exec-提取正则中符合要求的值" class="headerlink" title="2. exec 提取正则中符合要求的值"></a>2. exec 提取正则中符合要求的值</h3><p>跟<code>str</code>的 match 方法相似 只返回第一次配备的结果 并额外返回两个参数</p>
<p>index:当前匹配结果出现的位置</p>
<p>input：匹配的整个字符串本身</p>
<p><code>RegExp</code>对象属性<code>lastIndex</code>用来标记 exec 方法下次匹配的开始位置</p>
<h4 id="没有全局修饰符-g"><a href="#没有全局修饰符-g" class="headerlink" title="没有全局修饰符 g"></a>没有全局修饰符 g</h4><p><code>lastIndex</code>始终为 0，不会改变</p>
<h4 id="使用全局修饰符-g"><a href="#使用全局修饰符-g" class="headerlink" title="使用全局修饰符 g"></a>使用全局修饰符 g</h4><p>每次匹配之后，会将当前匹配结果后面的字符的所在位置作为<code>lastIndex</code>的值</p>
<p>如果匹配不到结果，<code>lastIndex</code>的值将重置为 0，并且返回结果为 null</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">"afcabcaccadc"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> re = <span class="regexp">/a[^bac]c/g</span>; <span class="comment">//有g的情况</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.lastIndex; <span class="comment">//0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.exec(str); <span class="comment">// ["afc", index: 9, input: "afcabcaccadc", groups: undefined]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.lastIndex; <span class="comment">//3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.exec(str); <span class="comment">//["adc", index: 9, input: "afcabcaccadc", groups: undefined]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.lastIndex; <span class="comment">//12</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.exec(str); <span class="comment">//null</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re.lastIndex; <span class="comment">//0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> re1 = <span class="regexp">/a[^bac]c/</span>; <span class="comment">//没有g的情况</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re1.lastIndex; <span class="comment">//0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re1.exec(str); <span class="comment">// ["afc", index: 9, input: "afcabcaccadc", groups: undefined]</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re1.lastIndex; <span class="comment">//0</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">re1.exec(str); <span class="comment">// ["afc", index: 9, input: "afcabcaccadc", groups: undefined]</span></span></pre></td></tr></table></figure>

<h2 id="字符串方法"><a href="#字符串方法" class="headerlink" title="字符串方法"></a>字符串方法</h2><h4 id="1-search"><a href="#1-search" class="headerlink" title="1. search"></a>1. search</h4><p>方法用于检索字符串中指定的子字符串，或检索与正则表达式相匹配的子字符串。<br>与 indexOf 方法类似，如果没有找到任何匹配的子串，则返回 -1。</p>
<h4 id="2-match"><a href="#2-match" class="headerlink" title="2. match"></a>2. match</h4><p>match() 方法可在字符串内检索指定的值，或找到一个或多个正则表达式的匹配。</p>
<p>该方法类似 indexOf() 和 lastIndexOf()，但是它返回指定的值，而不是字符串的位置。</p>
<p>语法</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">string</span>Object.match(searchvalue)</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">string</span>Object.match(regexp)</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">searchvalue</td>
<td align="left">必需。规定要检索的字符串值。</td>
</tr>
<tr>
<td align="left">regexp</td>
<td align="left">必需。规定要匹配的模式的 RegExp 对象。如果该参数不是 RegExp 对象，则需要首先把它传递给 RegExp 构造函数，将其转换为 RegExp 对象。</td>
</tr>
</tbody></table>
<p>返回值</p>
<p>存放匹配结果的数组。该数组的内容依赖于 regexp 是否具有全局标志 g。</p>
<p>说明</p>
<p>match() 方法将检索字符串 stringObject，以找到一个或多个与 regexp 匹配的文本。这个方法的行为在很大程度上有赖于 regexp 是否具有标志 g。</p>
<p>如果 regexp 没有标志 g，那么 match() 方法就只能在 stringObject 中执行一次匹配。如果没有找到任何匹配的文本， match() 将返回 null。否则，它将返回一个数组，其中存放了与它找到的匹配文本有关的信息。该数组的第 0 个元素存放的是匹配文本，而其余的元素存放的是与正则表达式的子表达式匹配的文本。除了这些常规的数组元素之外，返回的数组还含有两个对象属性。index 属性声明的是匹配文本的起始字符在 stringObject 中的位置，input 属性声明的是对 stringObject 的引用。</p>
<p>如果 regexp 具有标志 g，则 match() 方法将执行全局检索，找到 stringObject 中的所有匹配子字符串。若没有找到任何匹配的子串，则返回 null。如果找到了一个或多个匹配子串，则返回一个数组。不过全局匹配返回的数组的内容与前者大不相同，它的数组元素中存放的是 stringObject 中所有的匹配子串，而且也没有 index 属性或 input 属性。</p>
<p><strong>注意：</strong>在全局检索模式下，match() 即不提供与子表达式匹配的文本的信息，也不声明每个匹配子串的位置。如果您需要这些全局检索的信息，可以使用 RegExp.exec()。</p>
<h4 id="3-replace"><a href="#3-replace" class="headerlink" title="3. replace"></a>3. replace</h4><blockquote>
<ol>
<li>replace <code>stringObject.replace(regexp/substr,replacement)</code> replacement 可以直接写替代字符 也可以时一个函数，函数有四个参数, 函数的第一个参数是匹配到的字符串，如果有分组，接下来的参数就是匹配到的分组。然后是匹配到的字符串的位置，最后是被匹配的字符串。</li>
</ol>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">'"a", "b"'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fn: any = <span class="function">(<span class="params">a, b, c, d</span>) =&gt;</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="built_in">console</span>.log(<span class="string">"fn:any -&gt; a,b,c,d"</span>, a, b, c, d);</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="comment">//第一次 fn:any -&gt; a,b,c,d "a" a 0 "a", "b" 第二次fn:any -&gt; a,b,c,d "b" b 5 "a", "b"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="keyword">return</span> <span class="string">"'"</span> + b + <span class="string">"'"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="string">'"'</span> + name.replace(<span class="regexp">/"([^"]*)"/g</span>, fn) + <span class="string">'"'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"created -&gt; a"</span>, a); <span class="comment">//created -&gt; a "'a', 'b'"</span></span></pre></td></tr></table></figure>

<blockquote>
<p>replacement 中的 $ 字符具有特定的含义。如下表所示，它说明从模式匹配得到的字符串将用于替换。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">替换文本</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$1、$2、…、$99</td>
<td align="left">与 <code>regexp</code> 中的第 1 到第 99 个子表达式相匹配的文本。</td>
</tr>
<tr>
<td align="left">$&amp;</td>
<td align="left">与 <code>regexp</code> 相匹配的子串。</td>
</tr>
<tr>
<td align="left">$`</td>
<td align="left">位于匹配子串左侧的文本。</td>
</tr>
<tr>
<td align="left">$‘</td>
<td align="left">位于匹配子串右侧的文本。</td>
</tr>
<tr>
<td align="left">$$</td>
<td align="left">直接量符号。</td>
</tr>
</tbody></table>
<h4 id="4-split"><a href="#4-split" class="headerlink" title="4. split"></a>4. split</h4><p>split() 方法用于把一个字符串分割成字符串数组。</p>
<p>语法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">stringObject.split(separator, howmany);</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">separator</td>
<td align="left">必需。字符串或正则表达式，从该参数指定的地方分割 stringObject。</td>
</tr>
<tr>
<td align="left">howmany</td>
<td align="left">可选。该参数可指定返回的数组的最大长度。如果设置了该参数，返回的子串不会多于这个参数指定的数组。如果没有设置该参数，整个字符串都会被分割，不考虑它的长度。</td>
</tr>
</tbody></table>
<p><em>separator</em> 是包含子表达式的正则表达式，那么返回的数组中包括与这些子表达式匹配的字串（但不包括与整个正则表达式匹配的文本）</p>
<h2 id="单词边界和空白字符"><a href="#单词边界和空白字符" class="headerlink" title="单词边界和空白字符"></a>单词边界和空白字符</h2><h2 id="RegExp-对象属性"><a href="#RegExp-对象属性" class="headerlink" title="RegExp 对象属性"></a>RegExp 对象属性</h2><table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">描述</th>
<th align="left">FF</th>
<th align="left">IE</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_global.asp" target="_blank" rel="noopener">global</a></td>
<td align="left">RegExp 对象是否具有标志 g。</td>
<td align="left">1</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_regexp_ignorecase.asp" target="_blank" rel="noopener">ignoreCase</a></td>
<td align="left">RegExp 对象是否具有标志 i。</td>
<td align="left">1</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_lastindex_regexp.asp" target="_blank" rel="noopener">lastIndex</a></td>
<td align="left">一个整数，标示开始下一次匹配的字符位置。</td>
<td align="left">1</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_multiline_regexp.asp" target="_blank" rel="noopener">multiline</a></td>
<td align="left">RegExp 对象是否具有标志 m。</td>
<td align="left">1</td>
<td align="left">4</td>
</tr>
<tr>
<td align="left"><a href="https://www.w3school.com.cn/jsref/jsref_source_regexp.asp" target="_blank" rel="noopener">source</a></td>
<td align="left">正则表达式的源文本。</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<h2 id="应用练习"><a href="#应用练习" class="headerlink" title="应用练习"></a>应用练习</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass b"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass a"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass w"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"sClass"</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">  <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   /**</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @description: 根据类名获取元素</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @param &#123;type&#125; sClass 类名</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @param &#123;type&#125; container  查找范围</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    * @<span class="keyword">return</span>: 查到的元素 没有返回<span class="literal">null</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @author: Seven</span></pre></td></tr><tr><td class="code"><pre><span class="line">    */</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="keyword">let</span> getByClass = <span class="function">(<span class="params">sClass, container</span>) =&gt;</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="keyword">let</span> nodes = (container || <span class="built_in">document</span>).getElementsByTagName(<span class="string">"*"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="keyword">let</span> node = [].find.call(nodes, <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">     <span class="built_in">console</span>.dir(el);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">     <span class="keyword">let</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`\\b<span class="subst">$&#123;sClass&#125;</span>\\b`</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     if (el.className.search(re) != -1) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="keyword">return</span> el;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="keyword">return</span> node || <span class="literal">null</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="built_in">console</span>.log(<span class="string">"classnode"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="built_in">console</span>.dir(getByClass(<span class="string">"sClass"</span>));</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="keyword">let</span> data = [</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     title: <span class="string">"国内专利、商标申请双增长"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     content:</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="string">"国家知识产权局新闻发言人胡文辉介绍，今年上半年，我国国内三种类型专利申请219.5万件、商标申请417万件。国内专利"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     title: <span class="string">"国内专利、商标申请双增长"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     content:</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="string">"国家知识产权局新闻发言人胡文辉介绍，今年上半年，我国国内三种类型专利申请219.5万件、商标申请417万件。国内专利"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     title: <span class="string">"国内专利、商标申请双增长"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     content:</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="string">"国家知识产权局新闻发言人胡文辉介绍，今年上半年，我国国内三种类型专利申请219.5万件、商标申请417万件。国内专利"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     title: <span class="string">"国内专利、商标申请双增长"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">     content:</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">      <span class="string">"国家知识产权局新闻发言人胡文辉介绍，今年上半年，我国国内三种类型专利申请219.5万件、商标申请417万件。国内专利"</span>,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">   ];</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">   /**</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @description: 模板编译方法</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @param &#123;type&#125; temp 模板dom</span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @param &#123;type&#125; data 模板json</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    * @<span class="keyword">return</span>: 编译好的模板HTML</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    * @author: Seven</span></pre></td></tr><tr><td class="code"><pre><span class="line">    */</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="keyword">let</span> handleTemplate = <span class="function">(<span class="params">temp, datas</span>) =&gt;</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"handleTemplate -&gt; temp"</span>, temp);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="built_in">console</span>.dir(temp);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    <span class="keyword">let</span> html = <span class="string">""</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">    datas.forEach(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">     <span class="keyword">let</span> innerHTML = temp.innerHTML;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">     <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> data) &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">      if (data.hasOwnProperty(key)) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">       <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`&#123;&#123;<span class="subst">$&#123;key&#125;</span>&#125;&#125;`</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">       innerHTML = innerHTML.replace(reg, data[key]);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">     html += innerHTML;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">     <span class="built_in">console</span>.log(<span class="string">"handleTemplate -&gt; html"</span>, html);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">    <span class="keyword">return</span> html;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">   &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="javascript">   <span class="keyword">let</span> tempNode = <span class="built_in">document</span>.getElementById(<span class="string">"temp"</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="actionscript">   getByClass(<span class="string">"container"</span>).innerHTML = handleTemplate(tempNode, data);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/template"</span> <span class="attr">id</span>=<span class="string">"temp"</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123;title&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="template-variable">&#123;&#123;content&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">P</span>&gt;</span></span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure>

<h2 id="常用的正则"><a href="#常用的正则" class="headerlink" title="常用的正则"></a>常用的正则</h2><blockquote>
<p>vscode 匹配对： 后面的字符进行匹配</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">/:([^]+)$/  <span class="comment">//最少一次</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">/:([^]*)$/  <span class="comment">//不限次数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">/:([^]?)*<span class="regexp">/  /</span><span class="regexp">/后面没有字符的请求</span></span></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>正则</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>正则</tag>
      </tags>
  </entry>
  <entry>
    <title>[转载]node-pre-gyp以及node-gyp的源码简单解析（以安装sqlite3为例）</title>
    <url>/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/</url>
    <content><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/330468774" target="_blank" rel="noopener">文章原地址</a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>简单来说，node是跨平台的，那么对于任何的node模块理论也是应该是跨平台的。然而，有些node模块直接或间接使用原生C/C++代码，这些东西要跨平台，就需要使用源码根据实际的操作平台环境进行原生模块编译。SQLite3就是一个经典的原生模块，让我们以安装该模块为例，探索一下安装原生模块的流程。</p>
<h2 id="项目建立"><a href="#项目建立" class="headerlink" title="项目建立"></a>项目建立</h2><p>建立一个简单的node项目，我们开始安装<code>SQLite3</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ mkdir sqlite3-install-demo </span></pre></td></tr><tr><td class="code"><pre><span class="line">$ cd sqlite3-install-demo</span></pre></td></tr><tr><td class="code"><pre><span class="line">$ npm init</span></pre></td></tr><tr><td class="code"><pre><span class="line"># 初始化项目</span></pre></td></tr><tr><td class="code"><pre><span class="line">Press ^C at any time to quit.</span></pre></td></tr><tr><td class="code"><pre><span class="line">package name: (projects) sqlite3-install-demo</span></pre></td></tr><tr><td class="code"><pre><span class="line">version: (1.0.0)</span></pre></td></tr><tr><td class="code"><pre><span class="line">description:</span></pre></td></tr><tr><td class="code"><pre><span class="line">entry point: (index.js)</span></pre></td></tr><tr><td class="code"><pre><span class="line">test command:</span></pre></td></tr><tr><td class="code"><pre><span class="line">git repository:</span></pre></td></tr><tr><td class="code"><pre><span class="line">keywords:</span></pre></td></tr><tr><td class="code"><pre><span class="line">author:</span></pre></td></tr><tr><td class="code"><pre><span class="line">license: (ISC) MIT</span></pre></td></tr><tr><td class="code"><pre><span class="line">About to write to D:\Projects\package.json:</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;name&quot;: &quot;sqlite3-install-demo&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;description&quot;: &quot;&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;main&quot;: &quot;index.js&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;scripts&quot;: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;author&quot;: &quot;&quot;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &quot;license&quot;: &quot;MIT&quot;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h2 id="安装SQLite3"><a href="#安装SQLite3" class="headerlink" title="安装SQLite3"></a>安装<code>SQLite3</code></h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install -S sqlite3</span></pre></td></tr></table></figure>

<p>完成命令执行后，你会看到命令行界面出现了如下的几行<strong>重要</strong>的输出：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; sqlite3@5.0.0 install D:\Projects\sqlite3-install-demo\node_modules\sqlite3</span></pre></td></tr><tr><td class="code"><pre><span class="line">&gt; node-pre-gyp install --fallback-to-build</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">node-pre-gyp WARN Using request for node-pre-gyp https download</span></pre></td></tr><tr><td class="code"><pre><span class="line">...</span></pre></td></tr></table></figure>

<p>啪一下，很快啊！我们就迎来了第一个东西<code>node-pre-gyp</code>，但是提到了<code>node-pre-gyp</code>，我们不得不提及<code>node-gyp</code>，然后又不得不提及<code>gyp</code>。</p>
<h2 id="gyp与node-gyp与node-pre-gyp"><a href="#gyp与node-gyp与node-pre-gyp" class="headerlink" title="gyp与node-gyp与node-pre-gyp"></a>gyp与node-gyp与node-pre-gyp</h2><h2 id="什么是gyp？"><a href="#什么是gyp？" class="headerlink" title="什么是gyp？"></a>什么是gyp？</h2><p>gyp全称<code>Generate Your Projects</code>（构建你的项目）。wiki的解释如下，自行翻译：</p>
<blockquote>
<p>GYP (generate your projects) is a build automation tool. GYP was created by Google to generate native IDE project files (such as Visual Studio Code and Xcode) for building the Chromium web browser and is licensed as open source software using the BSD software license.</p>
</blockquote>
<p>重点在于，它是一套用于生成原生IDE项目文件的自动化构建工具，处理C/C++项目，同类型的有CMake、ninja等自动构建工具。</p>
<h2 id="什么是node-gyp？"><a href="#什么是node-gyp？" class="headerlink" title="什么是node-gyp？"></a>什么是node-gyp？</h2><p>直接给出<code>stackoverflow</code>高票回答：</p>
<blockquote>
<p><code>node-gyp</code> is a tool which compiles Node.js Addons. Node.js Addons are native Node.js Modules, written in C or C++, which therefore need to be compiled on your machine. After they are compiled with tools like node-gyp, their functionality can be accessed via <code>require()</code>, just as any other Node.js Module.</p>
</blockquote>
<p>简单来说，node是跨平台的，那么对于任何的node模块理论也是应该是跨平台的。然而，有些node模块直接或间接使用原生C/C++代码，这些东西要跨平台，就需要使用源码根据实际的操作平台环境进行原生模块编译。那么我们需要下载源码文件，通过node-gyp生成一定结构的代码项目让我们能够<code>require</code>引入（譬如，Windows下会生成<code>vcxproj</code>，再调用<code>MSBuild</code>进行编译，以生成Windows下的动态链接库，最后打包为一个原生node模块）。这个知乎回答的每一条可以看看：<a href="https://www.zhihu.com/question/36291768" target="_blank" rel="noopener">传送门</a>。</p>
<h2 id="什么是node-pre-gyp？"><a href="#什么是node-pre-gyp？" class="headerlink" title="什么是node-pre-gyp？"></a>什么是node-pre-gyp？</h2><p>上面<code>node-gyp</code>固然相当方便了，但是每一次安装node原生模块的时候，都需要根据平台（Windows、Linux、macOS以及对应的x86、x64、arm64等等）进行源码编译，这样做费时费力。为什么不一开始就针对这些平台编译好了做成二进制制品发布呢？反正一般来说主流的平台架构就那么一些（Windows、Linux、macOS）。所以<code>node-pre--gyp</code>就帮我们做了这件事。原生模块开发者将代码编译生成各个平台架构的二进制包直接发布到<code>node-pre-gyp</code>上，当我们的node项目安装原生模块时候。处理流程就是首先去<code>node-pre-gyp</code>上找有没有当前平台的组件包，有的话直接拉取使用，如果没有则进行原生编译。</p>
<p><code>node-pre-gyp</code>一些<strong>重要参数</strong>（不全）：</p>
<ul>
<li><code>-C/--directory</code>: run the command in this directory</li>
<li><code>--build-from-source</code>: build from source instead of using pre-built binary</li>
<li><code>--fallback-to-build</code>: fallback to building from source if pre-built binary is not available</li>
<li><code>--target=0.4.0</code>: Pass the target node or node-webkit version to compile against</li>
<li><code>--target_arch=ia32</code>: Pass the target arch and override the host <code>arch</code>. Valid values are ‘ia32’,’x64’, or <code>arm</code>.</li>
<li><code>--target_platform=win32</code>: Pass the target platform and override the host <code>platform</code>. Valid values are <code>linux</code>, <code>darwin</code>, <code>win32</code>, <code>sunos</code>, <code>freebsd</code>, <code>openbsd</code>, and <code>aix</code>.</li>
</ul>
<p>对于<code>--fallback-to-build</code>这个参数：如果二进制不可获取则直接从源码编译，即从<code>node-pre-gyp</code>又回到<code>node-gyp</code>。所以你才会在上文看到安装sqlite3的时候，会有<code>--fallback-to-build</code>。</p>
<p>于是乎，当我们进行node原生模块安装的时候，一般会有如下的流程：</p>
<ol>
<li>针对当前平台架构优先考虑<code>node-pre-gyp</code>方式进行安装，但是为了防止无法获取针对对应平台编译好的二进制包（网络原因、暂时没有对应平台的二进制包），进入第2步；</li>
<li>下载原生模块源码，然后使用<code>node-gyp</code>进行项目构建，得到与平台相关的源码项目文件（Windows则生成<code>vcxproj</code>项目，Linux下是<code>Makefile</code>）；在这个过程，<code>node-gyp</code>会使用<code>Python</code>进行自动化构建操作，这也是为什么有些朋友安装node原生模块的时候，会报错找不到<code>Python</code>。</li>
<li>调用平台对应的编译工具进行编译。在Windows的环境下，<code>node-gyp</code>会查找本地的<code>MSBuild/CL</code>等编译工具，而这些编译工具又一般在<code>Visual Studio</code>安装的时候，也一并安装在了机器上。这就是为什么有些朋友没有安装<code>Visual Studio</code>的时候，会报错。</li>
</ol>
<h2 id="探索SQLite3的安装流程"><a href="#探索SQLite3的安装流程" class="headerlink" title="探索SQLite3的安装流程"></a>探索SQLite3的安装流程</h2><h2 id="npm-install"><a href="#npm-install" class="headerlink" title="npm install"></a><code>npm install</code></h2><p>为什么我们安装<code>sqlite3</code>的时候，会调用<code>node-pre-gyp</code>命令呢？进入<code>项目目录/node_modules/sqlite3/</code>文件夹，让我们查看一下<code>package.json</code>中的<code>scripts</code>部分：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">  "repository": &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "type": "git",</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "url": "git://github.com/mapbox/node-sqlite3.git"</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  "scripts": &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "install": "node-pre-gyp install --fallback-to-build", // install</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "pack": "node-pre-gyp package",</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "pretest": "node test/support/createdb.js",</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "test": "mocha -R spec --timeout 480000"</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  "version": "5.0.0"</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>答案显而易见了，<code>install</code>脚本中执行了<code>node-pre-gyp install --fallback-to-build</code>命令。</p>
<p>这就不得不提到<code>npm</code>的安装流程是。当我们进行<code>npm install xxx</code>的时候，<code>npm</code>首先下载<code>xxx</code>的包。下载完成后，若<code>package.json</code>中的scripts中存在<code>install</code>属性，则会立刻调用。至于<code>scripts</code>中的其他固定脚本：<code>test</code>、<code>preinstall</code>、<code>postinstall</code>等等作用以及<code>scripts</code>的高级用法，请直接查阅<a href="https://link.zhihu.com/?target=https%3A//docs.npmjs.com/cli/v6/using-npm/scripts">scripts | npm Docs (npmjs.com)</a>。</p>
<p>所以本此<code>sqlite3</code><strong>前期</strong>安装的过程为：</p>
<ol>
<li><code>npm</code>下载在仓库中的<code>sqlite3</code>npm包；</li>
<li>执行<code>${your_projects}/node_modules/sqlite3/package.json</code>中的<code>install</code>脚本，即<code>node-pre-gyp install --fallback-to-build</code></li>
</ol>
<p>于是乎，安装进入到了一个新的环节：<code>node-pre-gyp install</code>。当然，若你没有全局安装<code>node-pre-gyp</code>，它会由<code>npm</code>帮你安装到<code>${your_projects}/node_modules/</code>中，并且通过<code>node-pre-gyp/package.json</code>中的<code>bin</code>元素，建立软连接到<code>${your_projects}/node_modules/.bin</code>中。这样，<code>node\npm</code>环境中就有了<code>node-pre-gyp</code>命令可以使用。至于<code>package.json#bin</code>的作用，详细参考官方文档<a href="https://link.zhihu.com/?target=https%3A//docs.npmjs.com/cli/v6/configuring-npm/package-json%23bin">package.json | npm Docs (npmjs.com)</a>。</p>
<h2 id="node-pre-gyp-install"><a href="#node-pre-gyp-install" class="headerlink" title="node-pre-gyp install"></a><code>node-pre-gyp install</code></h2><p><code>node-pre-gyp</code>在上述的安装流程中，已经能够被我们在CLI中所使用。查看<code>node_modules/node-pre-gyp/bin/node-pre-gyp</code>文件（下文都将省略<code>${your_projects}/</code>），用文本的形式打开。就是<code>node-pre-gyp</code>CLI的执行过程，脚本中的主要内容为最后一行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; start running the given commands!</span></pre></td></tr><tr><td class="code"><pre><span class="line">run();</span></pre></td></tr></table></figure>

<p>检查该函数的定义：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> command = prog.todo.shift();</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (!command) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// done!</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    completed = <span class="literal">true</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    log.info(<span class="string">'ok'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  prog.commands[command.name](command.args, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      log.error(command.name + <span class="string">' error'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      log.error(<span class="string">'stack'</span>, err.stack);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      errorMessage();</span></pre></td></tr><tr><td class="code"><pre><span class="line">      log.error(<span class="string">'not ok'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="built_in">console</span>.log(err.message);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">return</span> process.exit(<span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> args_array = [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (args_array.length) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, args_array);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// now run the next command in the queue</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    process.nextTick(run);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p><code>prog</code>是什么？该文件往上查看定义，原来是：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> node_pre_gyp = <span class="built_in">require</span>(<span class="string">'../'</span>); <span class="comment">// 上一个目录作为模块引入</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> log = <span class="built_in">require</span>(<span class="string">'npmlog'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> * Process and execute the selected commands.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> prog = <span class="keyword">new</span> node_pre_gyp.Run(); <span class="comment">// 来自于node_pre_gyp中的Run，而node_pre_gyp在上方</span></span></pre></td></tr></table></figure>

<p>继续检查上一个目录，发现并没又<code>indes.js</code>文件，熟悉<code>npm</code>的朋友应该知道要去看<code>package.json</code>中的<code>main</code>元素了：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "license": "BSD-3-Clause",</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "main": "./lib/node-pre-gyp.js", // 模块是这个文件</span></pre></td></tr><tr><td class="code"><pre><span class="line">    "name": "node-pre-gyp",</span></pre></td></tr><tr><td class="code"><pre><span class="line">...</span></pre></td></tr></table></figure>

<p>查阅<code>lib/node-pre-gyp.js</code>代码中的Run：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Run</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">var</span> self = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">this</span>.commands = &#123;&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">  commands.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">command</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    self.commands[command] = <span class="function"><span class="keyword">function</span> (<span class="params">argv, callback</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">      log.verbose(<span class="string">'command'</span>, command, argv);</span></pre></td></tr><tr><td class="code"><pre><span class="line">      <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">'./'</span> + command)(self, argv, callback); <span class="comment">// 这里是核心</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>核心功能就是引入当前所在目录下的模块进行执行。例如，本次调用的是<code>node-pre-gyp install</code>，则会<code>require(./install)</code>，检查一下<code>node-pre-gyp.js</code>目录下，果然存在该<code>js</code>文件。继续阅读<code>install.js</code>源码。里面有几个函数的定义。咱们先不看内容，把函数名列举出来，猜测一下作用：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 去下载平台编译好的二进制？</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">uri,opts,callback</span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 把下载好的二进制放到对应目录？</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">place_binary</span>(<span class="params">from,to,opts,callback</span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 进行构建。难道是没有下载，就调用node-gyp源码编译？</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 还有，node-pre-gyp又--fallback-to-build参数，也会调用这个？</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">do_build</span>(<span class="params">gyp,argv,callback</span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 打印回退出现的异常</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print_fallback_error</span>(<span class="params">err,opts,package_json</span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 安装，核心没跑了</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">gyp, argv, callback</span>) </span>&#123;...&#125;</span></pre></td></tr></table></figure>

<p>首先看<code>download</code>的调用点是在<code>place_binary</code>中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">place_binary</span>(<span class="params">from,to,opts,callback</span>) </span>&#123; <span class="comment">// place_binary函数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    download(<span class="keyword">from</span>,opts,<span class="function"><span class="keyword">function</span>(<span class="params">err,req</span>) </span>&#123; <span class="comment">// 调用了download</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">if</span> (!req) <span class="keyword">return</span> callback(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"empty req"</span>));</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>再看<code>place_binary</code>调用点是在<code>install</code>中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">gyp, argv, callback</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 省略部分...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> should_do_source_build = source_build === package_json.name || (source_build === <span class="literal">true</span> || source_build === <span class="string">'true'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">if</span> (should_do_source_build) &#123; <span class="comment">// 源码编译</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        log.info(<span class="string">'build'</span>,<span class="string">'requesting source compile'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">return</span> do_build(gyp,argv,callback);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 省略部分...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        mkdirp(to,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">if</span> (err) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                after_place(err);</span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">                place_binary(<span class="keyword">from</span>,to,opts,after_place); <span class="comment">// 调用点</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="comment">// 省略部分...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">// 省略部分...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>通过上述分析，整个大的处理流程如下：</p>
<ol>
<li>进入<code>install</code>函数</li>
<li>检查是否需要<code>build-from-source</code>。是则进，入<code>do_build</code>分支，进行源码编译；否则进入步骤3。</li>
<li>检查是否启用<code>--fallback-to-build</code>参数，设定是否启用标志位。</li>
<li>解析编译好的二进制文件的选项配置，譬如二进制文件存放地址，也就是通过请求下载对应二进制包的地址，以及各种各样参数。所以说，为什么下载很慢，我们后文会重点关注下载地址。</li>
</ol>
<h3 id="下载二进制包"><a href="#下载二进制包" class="headerlink" title="下载二进制包"></a>下载二进制包</h3><p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-42de3994e7c42468d24506ef1dbdbe49_720w-1607839552207.jpg" alt="img"></p>
<p>根据流程，接下来我们进一步检查<code>versioning.js</code>文件，找到其中的<code>evaluate</code>函数，分析最后的<code>hosted_tarball</code>路径：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-1e4a760a3783229810e2a437e1330f37_720w-1607839554321.png" alt="img"></p>
<p><code>hosted_tarball</code>路径主要分为两个部分：1、<code>hosted_path</code>；2、<code>package_name</code>。</p>
<h3 id="hosted-path"><a href="#hosted-path" class="headerlink" title="hosted_path"></a>hosted_path</h3><p>经过源码分析来源路径为：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-9e93a984b0f0aeac5d8154f0aa1b387c_720w-1607839785926.jpg" alt="img"></p>
<p>我们自底向上分析。</p>
<p><code>host</code>变量取决于从环境变量中检查名称为<code>&#39;npm_config_&#39; + opts.module_name + &#39;_binary_host_mirror&#39;</code>的环境变量。如果不存在，则使用<code>package_json.binary.host</code>。正常使用的时候，我们并不会设定环境变量，所以这里就进入<code>package_json.binary</code>进行获取。这个<code>package_json</code>是<code>evaluate</code>函数被调用时候传入的，在<code>node-pre-gyp/install.js</code>中能够看到：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-2f28af0a80578001c17e86077832bc52_720w-1607839556588.jpg" alt="img"></p>
<p>一开始分析的时候，看到这里，本人以为<code>package_json</code>就是<code>node-pre-gyp/package.json</code>，于是本人去检查该<code>json</code>发现很奇怪，并没有binary属性，更别提host了。一番思考才明白，<code>node-pre-gyp install</code>的运行时调用者是谁呀？不是应该是<code>sqlite3</code>吗？所以这个地方的<code>require(&#39;./package.json&#39;)</code>实际上是指代的是<code>sqlite3/package.json</code>。查看<code>sqlite3/package.json</code>，果然发现了对应的元素：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-9123803894e4e7ba0df2b7eebc3be8f9_720w-1607839558202.jpg" alt="img"></p>
<p>在<code>binary</code>属性中，我们还能看到<code>remote_path</code>也在其中。</p>
<p>至此，<code>hosted_path</code>我们完成了简单的分析，我们可以得出一个结论：</p>
<p><strong><code>node-pre-gyp</code>下载二进制文件的路径，优先来源于对应模块的镜像地址，该镜像地址通过配置<code>&#39;npm_config_&#39; + 模块名 + &#39;_binary_host_mirror&#39;</code>来实现自定义；在没有定义镜像地址的情况下，读取模块<code>package.json</code>中的binary属性信息。</strong></p>
<p>当然，读者可以根据具体情况再进一步分析源码。</p>
<h3 id="package-name"><a href="#package-name" class="headerlink" title="package_name"></a>package_name</h3><p>其实，对于<code>hosted_path</code>的分析，我们也容易分析<code>package_name</code>了。</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-66d92db546da24a98f6459e09d28611a_720w-1607839560356.jpg" alt="img"></p>
<p>自底向上分析，来自于<code>sqlite3/package.json</code>中<code>binary</code>属性中的<code>package_name</code>，内容见上图分析<code>host</code>。</p>
<h3 id="失败处理"><a href="#失败处理" class="headerlink" title="失败处理"></a>失败处理</h3><p><code>--fallback-to-build</code>参数表明了是否进行失败后下载源码进行编译，源码不再分析。</p>
<h3 id="从源码构建"><a href="#从源码构建" class="headerlink" title="从源码构建"></a>从源码构建</h3><h3 id="build-js"><a href="#build-js" class="headerlink" title="build.js"></a>build.js</h3><p>当我们提供了参数<code>--build-from-source</code>或是在下载编译好的二进制到本地出错的时提供了参数<code>--fallback-to-build</code>。node-pre-gyp将进入<code>do_build</code>模块，进行源码编译。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function do_build(gyp,argv,callback) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  var args &#x3D; [&#39;rebuild&#39;].concat(argv);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  gyp.todo.push( &#123; name: &#39;build&#39;, args: args &#125; );</span></pre></td></tr><tr><td class="code"><pre><span class="line">  process.nextTick(callback);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>代码中，<code>gyp</code>由调用install的时候，传入：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-62190c9f9976e3b3a7d7633d33129e85_720w-1607839562977.jpg" alt="img"></p>
<p>那么我们又将回到调用install的地方。实际上，gyp就是node-pre-gyp.js导出的模块：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-e940f9f30e0b68edeb98aa34709263e0_720w-1607839564901.jpg" alt="img"></p>
<p>也就是说在<code>do_build</code>中进行操作就是，放置了一个<code>build</code>任务在队列中。所以我们按照先前的分析，直接去看<code>build.js</code></p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-c60cc43b95c212ee80dff2bb461597a2_720w-1607839566493.jpg" alt="img"></p>
<p>看源码调用了当前模块中的<code>do_build</code>，且其中最核心的就是<code>compile</code>模块：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-2f5857952a2e181a620ca9183fd5e76d_720w-1607839567958.jpg" alt="img"></p>
<h3 id="util-compile-js"><a href="#util-compile-js" class="headerlink" title="util/compile.js"></a>util/compile.js</h3><p>进入compile模块，直接找到对应的<code>run_gyp</code>函数，代码很短，不难看出进行构建调用了<code>node-gyp</code></p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-97c9d95fdb3ea2d7c9e55a7311377fc3_720w-1607839569753.jpg" alt="img"></p>
<p>上述代码，会先考略<code>node-webkit</code>构建。但是我们核心的还是使用<code>node-gyp</code>，所以else中，会进行<code>node-gyp</code>的工具的检查工作。最后调用命令行执行<code>node-gyp</code>。于是，node原生模块的安装工作，进入了新的阶段：<code>node-gyp</code>。</p>
<h2 id="node-gyp-build"><a href="#node-gyp-build" class="headerlink" title="node-gyp build"></a><code>node-gyp build</code></h2><p>上文提到我们已经进入了<code>node-gyp</code>的范畴，会调用<code>node-gyp build</code>操作。当然，这个命令同样是在安装<code>node-gyp</code>依赖的时候已经完成了安装，并且进行<code>node_modules/.bin/</code>软连接操作。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="string">"bin"</span>: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">"node-gyp"</span>: <span class="string">"bin/node-gyp.js"</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">  ...</span></pre></td></tr></table></figure>

<p>我们进入该<code>js</code>进行分析</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-8b31e792c069648f4518bd2bf4de384c_720w-1607839571435.jpg" alt="img"></p>
<p>实际上，<code>node-gyp</code>这段的命令行代码，和<code>node-pre-gyp</code>非常相似！所以我们也不去深入分析调用命令行了。直接在lib文件夹下面的<code>build.js</code>。在该<code>js</code>中，核心的方法为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build</span> (<span class="params">gyp, argv, callback</span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    ...</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>在该方法中，还编写了几个<strong>内部函数</strong>，作为了功能的划分：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// function build (gyp, argv, callback) 内部函数</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * Load the "config.gypi" file that was generated during "configure".</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">loadConfigGypi</span> (<span class="params"></span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * On Windows, find the first build/*.sln file.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">findSolutionFile</span> (<span class="params"></span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * Uses node-which to locate the msbuild / make executable.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doWhich</span> (<span class="params"></span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * Search for the location of "msbuild.exe" file on Windows.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">findMsbuild</span> (<span class="params"></span>) </span>&#123;...&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * Actually spawn the process and compile the module.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doBuild</span> (<span class="params"></span>) </span>&#123;...&#125;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">/**</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   * Invoked after the make/msbuild command exits.</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">   */</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">onExit</span> (<span class="params">code, signal</span>) </span>&#123;...&#125;</span></pre></td></tr></table></figure>

<p>不得不说，<code>build</code>写的真心不错，看起来很舒服。这里为了方便读者快速阅读，我整理这些函数的调用图：</p>
<p><img src="/Nodejs/%E8%BD%AC%E8%BD%BD-node-pre-gyp%E4%BB%A5%E5%8F%8Anode-gyp%E7%9A%84%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%EF%BC%88%E4%BB%A5%E5%AE%89%E8%A3%85sqlite3%E4%B8%BA%E4%BE%8B%EF%BC%89/v2-bf94b9960c86eaf29b542f860b3d4ab1_720w-1607839573628.jpg" alt="img"></p>
<p>整个调用流程图个人认为足够进行安装的时候的一场分析了。至于每个内部函数的功能，有空继续更新本文吧。</p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>path.resolve()的使用</title>
    <url>/Nodejs/path-resolve-%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h2 id="路径解析：path-resolve-from-…-to"><a href="#路径解析：path-resolve-from-…-to" class="headerlink" title="路径解析：path.resolve([from …], to)"></a>路径解析：path.resolve([from …], to)</h2><p>学习webpack 遇到path.resolve 但文档读完一遍很懵圈；</p>
<p>网上搜到一篇比较有用的文章 <a href="https://blog.csdn.net/kikyou_csdn/article/details/83150538" target="_blank" rel="noopener">https://blog.csdn.net/kikyou_csdn/article/details/83150538</a></p>
<p>同时也给出了join 连接路径和resolve 路径解析的不同 ：<a href="https://www.cnblogs.com/moqiutao/p/8523955.html" target="_blank" rel="noopener">https://www.cnblogs.com/moqiutao/p/8523955.html</a></p>
<p>这篇文章中有个比较好理解的观点就是  把 resolve  想象成 cd 命令。这样就容易理解了：</p>
<p>path.resolve()方法可以将多个路径解析为一个规范化的绝对路径。其处理方式类似于对这些路径逐一进行cd操作，与cd操作不同的是，这引起路径可以是文件，并且可不必实际存在（resolve()方法不会利用底层的文件系统判断路径是否存在，而只是进行路径字符串操作）。例如：</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">path</span><span class="selector-class">.resolve</span>(<span class="string">'foo/bar'</span>, <span class="string">'/tmp/file/'</span>, <span class="string">'..'</span>, <span class="string">'a/../subfile'</span>)</span></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> foo/bar</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/tmp/file/</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">..</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> a/<span class="string">../subfile</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">pwd</span></span></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">path.<span class="built_in">resolve</span>(<span class="string">'/foo/bar'</span>, <span class="string">'./baz'</span>) </span></pre></td></tr><tr><td class="code"><pre><span class="line">// 输出结果为 </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">'/foo/bar/baz'</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line">path.<span class="built_in">resolve</span>(<span class="string">'/foo/bar'</span>, <span class="string">'/tmp/file/'</span>) </span></pre></td></tr><tr><td class="code"><pre><span class="line">// 输出结果为 </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">'/tmp/file'</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">path.<span class="built_in">resolve</span>(<span class="string">'wwwroot'</span>, <span class="string">'static_files/png/'</span>, <span class="string">'../gif/image.gif'</span>) </span></pre></td></tr><tr><td class="code"><pre><span class="line">// 当前的工作路径是 /home/itbilu/node，则输出结果为 </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">'/home/itbilu/node/wwwroot/static_files/gif/image.gif'</span></span></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>./ 和目录名前面什么都不加代表当前目录下执行cd</p>
</li>
<li><p>/ 表示根目录下执行cd</p>
</li>
<li><p>所以要判断最后出来的是根目录还是当前工作目录看第一个参数的目录名前面是/ 还是 ./和什么都没加</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
        <tag>node</tag>
        <tag>path</tag>
      </tags>
  </entry>
  <entry>
    <title>linux 常用命令</title>
    <url>/Linux/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h2 id="退出和进入root权限"><a href="#退出和进入root权限" class="headerlink" title="退出和进入root权限"></a>退出和进入root权限</h2><p>进入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo -s</span></pre></td></tr></table></figure>

<p>退出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ su [用户名]</span></pre></td></tr></table></figure>

<h2 id="Ubuntu-下几种软件安装的方法"><a href="#Ubuntu-下几种软件安装的方法" class="headerlink" title="Ubuntu 下几种软件安装的方法"></a>Ubuntu 下几种软件安装的方法</h2><h2 id="tar命令的用法"><a href="#tar命令的用法" class="headerlink" title="tar命令的用法"></a>tar命令的用法</h2><p>参考 <a href="https://blog.csdn.net/kkw1992/article/details/80000653" target="_blank" rel="noopener">https://blog.csdn.net/kkw1992/article/details/80000653</a></p>
<p>linux下最常用的打包程序就是tar了，使用tar程序打出来的包我们常称为tar包，tar包文件的命令通常都是以.tar结尾的。生成tar包后，就可以用其它的程序来进行压缩。</p>
<p><strong>1．命令格式：</strong></p>
<p><code>tar [必要参数][选择参数][文件]</code></p>
<p><strong>2．命令功能：</strong></p>
<p>用来压缩和解压文件。tar本身不具有压缩功能。他是调用压缩功能实现的 </p>
<p><strong>3．命令参数：</strong></p>
<p>必要参数有如下：</p>
<p>-A 新增压缩文件到已存在的压缩</p>
<p>-B 设置区块大小</p>
<p>-c 建立新的压缩文件</p>
<p>-d 记录文件的差别</p>
<p>-r 添加文件到已经压缩的文件</p>
<p>-u 添加改变了和现有的文件到已经存在的压缩文件</p>
<p>-x 从压缩的文件中提取文件</p>
<p>-t 显示压缩文件的内容</p>
<p>-z 支持gzip解压文件</p>
<p>-j 支持bzip2解压文件</p>
<p>-Z 支持compress解压文件</p>
<p>-v 显示操作过程</p>
<p>-l 文件系统边界设置</p>
<p>-k 保留原有文件不覆盖</p>
<p>-m 保留文件不被覆盖</p>
<p>-W 确认压缩文件的正确性</p>
<p>可选参数如下：</p>
<p>-b 设置区块数目</p>
<p>-C 切换到指定目录</p>
<p>-f 指定压缩文件</p>
<p>–help 显示帮助信息</p>
<p>–version 显示版本信息</p>
<p><strong>4．常见解压/压缩命令</strong></p>
<p>tar<br>解包：tar xvf FileName.tar<br>打包：tar cvf FileName.tar DirName</p>
<p>（注：tar是打包，不是压缩！）</p>
<p>.gz<br>解压1：gunzip FileName.gz<br>解压2：gzip -d FileName.gz<br>压缩：gzip FileName</p>
<p>.tar.gz 和 .tgz<br>解压：tar zxvf FileName.tar.gz<br>压缩：tar zcvf FileName.tar.gz DirName<br>.bz2<br>解压1：bzip2 -d FileName.bz2<br>解压2：bunzip2 FileName.bz2<br>压缩： bzip2 -z FileName</p>
<p>.tar.bz2<br>解压：tar jxvf FileName.tar.bz2<br>压缩：tar jcvf FileName.tar.bz2 DirName<br>.bz<br>解压1：bzip2 -d FileName.bz<br>解压2：bunzip2 FileName.bz<br>压缩：未知</p>
<p>.tar.bz<br>解压：tar jxvf FileName.tar.bz<br>压缩：未知<br>.Z<br>解压：uncompress FileName.Z<br>压缩：compress FileName</p>
<p>.tar.Z<br>解压：tar Zxvf FileName.tar.Z<br>压缩：tar Zcvf FileName.tar.Z DirName</p>
<p>.zip<br>解压：unzip FileName.zip<br>压缩：zip FileName.zip DirName<br>.rar<br>解压：rar x FileName.rar<br>压缩：rar a FileName.rar DirName </p>
<h2 id="Linux常用命令大全（非常全！！！）"><a href="#Linux常用命令大全（非常全！！！）" class="headerlink" title="Linux常用命令大全（非常全！！！）"></a><strong>Linux常用命令大全（非常全！！！）</strong></h2><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a><strong>系统信息</strong></h3><p>arch 显示机器的处理器架构<br>uname -m 显示机器的处理器架构<br>uname -r 显示正在使用的内核版本<br>dmidecode -q 显示硬件系统部件 - (SMBIOS / DMI)<br>hdparm -i /dev/hda 罗列一个磁盘的架构特性<br>hdparm -tT /dev/sda 在磁盘上执行测试性读取操作<br>cat /proc/cpuinfo 显示CPU info的信息<br>cat /proc/interrupts 显示中断<br>cat /proc/meminfo 校验内存使用<br>cat /proc/swaps 显示哪些swap被使用<br>cat /proc/version 显示内核的版本<br>cat /proc/net/dev 显示网络适配器及统计<br>cat /proc/mounts 显示已加载的文件系统<br>lspci -tv 罗列 PCI 设备<br>lsusb -tv 显示 USB 设备<br>date 显示系统日期<br>cal 2007 显示2007年的日历表<br>date 041217002007.00 设置日期和时间 - 月日时分年.秒<br>clock -w 将时间修改保存到 BIOS </p>
<h3 id="关机-系统的关机、重启以及登出"><a href="#关机-系统的关机、重启以及登出" class="headerlink" title="关机 (系统的关机、重启以及登出 )"></a><strong>关机 (系统的关机、重启以及登出 )</strong></h3><p>shutdown -h now 关闭系统<br>init 0 关闭系统<br>telinit 0 关闭系统<br>shutdown -h hours:minutes &amp; 按预定时间关闭系统<br>shutdown -c 取消按预定时间关闭系统<br>shutdown -r now 重启<br>reboot 重启<br>logout 注销 </p>
<h3 id="文件和目录"><a href="#文件和目录" class="headerlink" title="文件和目录"></a><strong>文件和目录</strong></h3><p>cd /home 进入 ‘/ home’ 目录’<br>cd .. 返回上一级目录<br>cd ../.. 返回上两级目录<br>cd 进入个人的主目录<br>cd ~user1 进入个人的主目录<br>cd - 返回上次所在的目录<br>pwd 显示工作路径<br>ls 查看目录中的文件<br>ls -F 查看目录中的文件<br>ls -l 显示文件和目录的详细资料<br>ls -a 显示隐藏文件<br>ls <em>[0-9]</em> 显示包含数字的文件名和目录名<br>tree 显示文件和目录由根目录开始的树形结构<br>lstree 显示文件和目录由根目录开始的树形结构<br>mkdir dir1 创建一个叫做 ‘dir1’ 的目录’<br>mkdir dir1 dir2 同时创建两个目录<br>mkdir -p /tmp/dir1/dir2 创建一个目录树<br>rm -f file1 删除一个叫做 ‘file1’ 的文件’<br>rmdir dir1 删除一个叫做 ‘dir1’ 的目录’<br>rm -rf dir1 删除一个叫做 ‘dir1’ 的目录并同时删除其内容<br>rm -rf dir1 dir2 同时删除两个目录及它们的内容<br>mv dir1 new_dir 重命名/移动 一个目录<br>cp file1 file2 复制一个文件<br>cp dir/* . 复制一个目录下的所有文件到当前工作目录<br>cp -a /tmp/dir1 . 复制一个目录到当前工作目录<br>cp -a dir1 dir2 复制一个目录<br>ln -s file1 lnk1 创建一个指向文件或目录的软链接<br>ln file1 lnk1 创建一个指向文件或目录的物理链接<br>touch -t 0712250000 file1 修改一个文件或目录的时间戳 - (YYMMDDhhmm)<br>file file1 outputs the mime type of the file as text<br>iconv -l 列出已知的编码<br>iconv -f fromEncoding -t toEncoding inputFile &gt; outputFile creates a new from the given input file by assuming it is encoded in fromEncoding and converting it to toEncoding.<br>find . -maxdepth 1 -name *.jpg -print -exec convert “{}” -resize 80x60 “thumbs/{}” ; batch resize files in the current directory and send them to a thumbnails directory (requires convert from Imagemagick) </p>
<h3 id="文件搜索"><a href="#文件搜索" class="headerlink" title="文件搜索"></a><strong>文件搜索</strong></h3><p>find / -name file1 从 ‘/‘ 开始进入根文件系统搜索文件和目录<br>find / -user user1 搜索属于用户 ‘user1’ 的文件和目录<br>find /home/user1 -name *.bin 在目录 ‘/ home/user1’ 中搜索带有’.bin’ 结尾的文件<br>find /usr/bin -type f -atime +100 搜索在过去100天内未被使用过的执行文件<br>find /usr/bin -type f -mtime -10 搜索在10天内被创建或者修改过的文件<br>find / -name *.rpm -exec chmod 755 ‘{}’ ; 搜索以 ‘.rpm’ 结尾的文件并定义其权限<br>find / -xdev -name *.rpm 搜索以 ‘.rpm’ 结尾的文件，忽略光驱、捷盘等可移动设备<br>locate *.ps 寻找以 ‘.ps’ 结尾的文件 - 先运行 ‘updatedb’ 命令<br>whereis halt 显示一个二进制文件、源码或man的位置<br>which halt 显示一个二进制文件或可执行文件的完整路径 </p>
<h3 id="挂载一个文件系统"><a href="#挂载一个文件系统" class="headerlink" title="挂载一个文件系统"></a><strong>挂载一个文件系统</strong></h3><p>mount /dev/hda2 /mnt/hda2 挂载一个叫做hda2的盘 - 确定目录 ‘/ mnt/hda2’ 已经存在<br>umount /dev/hda2 卸载一个叫做hda2的盘 - 先从挂载点 ‘/ mnt/hda2’ 退出<br>fuser -km /mnt/hda2 当设备繁忙时强制卸载<br>umount -n /mnt/hda2 运行卸载操作而不写入 /etc/mtab 文件- 当文件为只读或当磁盘写满时非常有用<br>mount /dev/fd0 /mnt/floppy 挂载一个软盘<br>mount /dev/cdrom /mnt/cdrom 挂载一个cdrom或dvdrom<br>mount /dev/hdc /mnt/cdrecorder 挂载一个cdrw或dvdrom<br>mount /dev/hdb /mnt/cdrecorder 挂载一个cdrw或dvdrom<br>mount -o loop file.iso /mnt/cdrom 挂载一个文件或ISO镜像文件<br>mount -t vfat /dev/hda5 /mnt/hda5 挂载一个Windows FAT32文件系统<br>mount /dev/sda1 /mnt/usbdisk 挂载一个usb 捷盘或闪存设备<br>mount -t smbfs -o username=user,password=pass //WinClient/share /mnt/share 挂载一个windows网络共享 </p>
<h3 id="磁盘空间"><a href="#磁盘空间" class="headerlink" title="磁盘空间"></a><strong>磁盘空间</strong></h3><p>df -h 显示已经挂载的分区列表<br>ls -lSr |more 以尺寸大小排列文件和目录<br>du -sh dir1 估算目录 ‘dir1’ 已经使用的磁盘空间’<br>du -sk * | sort -rn 以容量大小为依据依次显示文件和目录的大小<br>rpm -q -a –qf ‘%10{SIZE}t%{NAME}n’ | sort -k1,1n 以大小为依据依次显示已安装的rpm包所使用的空间 (fedora, redhat类系统)<br>dpkg-query -W -f=’${Installed-Size;10}t${Package}n’ | sort -k1,1n 以大小为依据显示已安装的deb包所使用的空间 (ubuntu, debian类系统) </p>
<h3 id="用户和群组"><a href="#用户和群组" class="headerlink" title="用户和群组"></a><strong>用户和群组</strong></h3><p>groupadd group_name 创建一个新用户组<br>groupdel group_name 删除一个用户组<br>groupmod -n new_group_name old_group_name 重命名一个用户组<br>useradd -c “Name Surname “ -g admin -d /home/user1 -s /bin/bash user1 创建一个属于 “admin” 用户组的用户<br>useradd user1 创建一个新用户<br>userdel -r user1 删除一个用户 ( ‘-r’ 排除主目录)<br>usermod -c “User FTP” -g system -d /ftp/user1 -s /bin/nologin user1 修改用户属性<br>passwd 修改口令<br>passwd user1 修改一个用户的口令 (只允许root执行)<br>chage -E 2005-12-31 user1 设置用户口令的失效期限<br>pwck 检查 ‘/etc/passwd’ 的文件格式和语法修正以及存在的用户<br>grpck 检查 ‘/etc/passwd’ 的文件格式和语法修正以及存在的群组<br>newgrp group_name 登陆进一个新的群组以改变新创建文件的预设群组 </p>
<h3 id="文件的权限-使用-“-”-设置权限，使用-“-“-用于取消"><a href="#文件的权限-使用-“-”-设置权限，使用-“-“-用于取消" class="headerlink" title="文件的权限 - 使用 “+” 设置权限，使用 “-“ 用于取消"></a><strong>文件的权限 - 使用 “+” 设置权限，使用 “-“ 用于取消</strong></h3><p>ls -lh 显示权限<br>ls /tmp | pr -T5 -W$COLUMNS 将终端划分成5栏显示<br>chmod ugo+rwx directory1 设置目录的所有人(u)、群组(g)以及其他人(o)以读（r ）、写(w)和执行(x)的权限<br>chmod go-rwx directory1 删除群组(g)与其他人(o)对目录的读写执行权限<br>chown user1 file1 改变一个文件的所有人属性<br>chown -R user1 directory1 改变一个目录的所有人属性并同时改变改目录下所有文件的属性<br>chgrp group1 file1 改变文件的群组<br>chown user1:group1 file1 改变一个文件的所有人和群组属性<br>find / -perm -u+s 罗列一个系统中所有使用了SUID控制的文件<br>chmod u+s /bin/file1 设置一个二进制文件的 SUID 位 - 运行该文件的用户也被赋予和所有者同样的权限<br>chmod u-s /bin/file1 禁用一个二进制文件的 SUID位<br>chmod g+s /home/public 设置一个目录的SGID 位 - 类似SUID ，不过这是针对目录的<br>chmod g-s /home/public 禁用一个目录的 SGID 位<br>chmod o+t /home/public 设置一个文件的 STIKY 位 - 只允许合法所有人删除文件<br>chmod o-t /home/public 禁用一个目录的 STIKY 位 </p>
<h3 id="文件的特殊属性-使用-“-”-设置权限，使用-“-“-用于取消"><a href="#文件的特殊属性-使用-“-”-设置权限，使用-“-“-用于取消" class="headerlink" title="文件的特殊属性 - 使用 “+” 设置权限，使用 “-“ 用于取消"></a><strong>文件的特殊属性 - 使用 “+” 设置权限，使用 “-“ 用于取消</strong></h3><p>chattr +a file1 只允许以追加方式读写文件<br>chattr +c file1 允许这个文件能被内核自动压缩/解压<br>chattr +d file1 在进行文件系统备份时，dump程序将忽略这个文件<br>chattr +i file1 设置成不可变的文件，不能被删除、修改、重命名或者链接<br>chattr +s file1 允许一个文件被安全地删除<br>chattr +S file1 一旦应用程序对这个文件执行了写操作，使系统立刻把修改的结果写到磁盘<br>chattr +u file1 若文件被删除，系统会允许你在以后恢复这个被删除的文件<br>lsattr 显示特殊的属性 </p>
<h3 id="打包和压缩文件"><a href="#打包和压缩文件" class="headerlink" title="打包和压缩文件"></a><strong>打包和压缩文件</strong></h3><p>bunzip2 file1.bz2 解压一个叫做 ‘file1.bz2’的文件<br>bzip2 file1 压缩一个叫做 ‘file1’ 的文件<br>gunzip file1.gz 解压一个叫做 ‘file1.gz’的文件<br>gzip file1 压缩一个叫做 ‘file1’的文件<br>gzip -9 file1 最大程度压缩<br>rar a file1.rar test_file 创建一个叫做 ‘file1.rar’ 的包<br>rar a file1.rar file1 file2 dir1 同时压缩 ‘file1’, ‘file2’ 以及目录 ‘dir1’<br>unrar x file1.rar 解压rar包<br>tar -cvf archive.tar file1 创建一个非压缩的 tarball<br>tar -cvf archive.tar file1 file2 dir1 创建一个包含了 ‘file1’, ‘file2’ 以及 ‘dir1’的档案文件<br>tar -tf archive.tar 显示一个包中的内容<br>tar -xvf archive.tar 释放一个包<br>tar -xvf archive.tar -C /tmp 将压缩包释放到 /tmp目录下<br>tar -cvfj archive.tar.bz2 dir1 创建一个bzip2格式的压缩包<br>tar -jxvf archive.tar.bz2 解压一个bzip2格式的压缩包<br>tar -cvfz archive.tar.gz dir1 创建一个gzip格式的压缩包<br>tar -zxvf archive.tar.gz 解压一个gzip格式的压缩包<br>zip file1.zip file1 创建一个zip格式的压缩包<br>zip -r file1.zip file1 file2 dir1 将几个文件和目录同时压缩成一个zip格式的压缩包<br>unzip file1.zip 解压一个zip格式压缩包 </p>
<h3 id="RPM-包-（Fedora-Redhat及类似系统）"><a href="#RPM-包-（Fedora-Redhat及类似系统）" class="headerlink" title="RPM 包 - （Fedora, Redhat及类似系统）"></a><strong>RPM 包 - （Fedora, Redhat及类似系统）</strong></h3><p>rpm -ivh package.rpm 安装一个rpm包<br>rpm -ivh –nodeeps package.rpm 安装一个rpm包而忽略依赖关系警告<br>rpm -U package.rpm 更新一个rpm包但不改变其配置文件<br>rpm -F package.rpm 更新一个确定已经安装的rpm包<br>rpm -e package_name.rpm 删除一个rpm包<br>rpm -qa 显示系统中所有已经安装的rpm包<br>rpm -qa | grep httpd 显示所有名称中包含 “httpd” 字样的rpm包<br>rpm -qi package_name 获取一个已安装包的特殊信息<br>rpm -qg “System Environment/Daemons” 显示一个组件的rpm包<br>rpm -ql package_name 显示一个已经安装的rpm包提供的文件列表<br>rpm -qc package_name 显示一个已经安装的rpm包提供的配置文件列表<br>rpm -q package_name –whatrequires 显示与一个rpm包存在依赖关系的列表<br>rpm -q package_name –whatprovides 显示一个rpm包所占的体积<br>rpm -q package_name –scripts 显示在安装/删除期间所执行的脚本l<br>rpm -q package_name –changelog 显示一个rpm包的修改历史<br>rpm -qf /etc/httpd/conf/httpd.conf 确认所给的文件由哪个rpm包所提供<br>rpm -qp package.rpm -l 显示由一个尚未安装的rpm包提供的文件列表<br>rpm –import /media/cdrom/RPM-GPG-KEY 导入公钥数字证书<br>rpm –checksig package.rpm 确认一个rpm包的完整性<br>rpm -qa gpg-pubkey 确认已安装的所有rpm包的完整性<br>rpm -V package_name 检查文件尺寸、 许可、类型、所有者、群组、MD5检查以及最后修改时间<br>rpm -Va 检查系统中所有已安装的rpm包- 小心使用<br>rpm -Vp package.rpm 确认一个rpm包还未安装<br>rpm2cpio package.rpm | cpio –extract –make-directories <em>bin</em> 从一个rpm包运行可执行文件<br>rpm -ivh /usr/src/redhat/RPMS/<code>arch</code>/package.rpm 从一个rpm源码安装一个构建好的包<br>rpmbuild –rebuild package_name.src.rpm 从一个rpm源码构建一个 rpm 包 </p>
<h3 id="YUM-软件包升级器-（Fedora-RedHat及类似系统）"><a href="#YUM-软件包升级器-（Fedora-RedHat及类似系统）" class="headerlink" title="YUM 软件包升级器 - （Fedora, RedHat及类似系统）"></a><strong>YUM 软件包升级器 - （Fedora, RedHat及类似系统）</strong></h3><p>yum install package_name 下载并安装一个rpm包<br>yum localinstall package_name.rpm 将安装一个rpm包，使用你自己的软件仓库为你解决所有依赖关系<br>yum update package_name.rpm 更新当前系统中所有安装的rpm包<br>yum update package_name 更新一个rpm包<br>yum remove package_name 删除一个rpm包<br>yum list 列出当前系统中安装的所有包<br>yum search package_name 在rpm仓库中搜寻软件包<br>yum clean packages 清理rpm缓存删除下载的包<br>yum clean headers 删除所有头文件<br>yum clean all 删除所有缓存的包和头文件 </p>
<h3 id="DEB-包-Debian-Ubuntu-以及类似系统"><a href="#DEB-包-Debian-Ubuntu-以及类似系统" class="headerlink" title="DEB 包 (Debian, Ubuntu 以及类似系统)"></a><strong>DEB 包 (Debian, Ubuntu 以及类似系统)</strong></h3><p>dpkg -i package.deb 安装/更新一个 deb 包<br>dpkg -r package_name 从系统删除一个 deb 包<br>dpkg -l 显示系统中所有已经安装的 deb 包<br>dpkg -l | grep httpd 显示所有名称中包含 “httpd” 字样的deb包<br>dpkg -s package_name 获得已经安装在系统中一个特殊包的信息<br>dpkg -L package_name 显示系统中已经安装的一个deb包所提供的文件列表<br>dpkg –contents package.deb 显示尚未安装的一个包所提供的文件列表<br>dpkg -S /bin/ping 确认所给的文件由哪个deb包提供 </p>
<h3 id="APT-软件工具-Debian-Ubuntu-以及类似系统"><a href="#APT-软件工具-Debian-Ubuntu-以及类似系统" class="headerlink" title="APT 软件工具 (Debian, Ubuntu 以及类似系统)"></a><strong>APT 软件工具 (Debian, Ubuntu 以及类似系统)</strong></h3><p>apt-get install package_name 安装/更新一个 deb 包<br>apt-cdrom install package_name 从光盘安装/更新一个 deb 包<br>apt-get update 升级列表中的软件包<br>apt-get upgrade 升级所有已安装的软件<br>apt-get remove package_name 从系统删除一个deb包<br>apt-get check 确认依赖的软件仓库正确<br>apt-get clean 从下载的软件包中清理缓存<br>apt-cache search searched-package 返回包含所要搜索字符串的软件包名称 </p>
<h3 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a><strong>查看文件内容</strong></h3><p>cat file1 从第一个字节开始正向查看文件的内容<br>tac file1 从最后一行开始反向查看一个文件的内容<br>more file1 查看一个长文件的内容<br>less file1 类似于 ‘more’ 命令，但是它允许在文件中和正向操作一样的反向操作<br>head -2 file1 查看一个文件的前两行<br>tail -2 file1 查看一个文件的最后两行<br>tail -f /var/log/messages 实时查看被添加到一个文件中的内容 </p>
<h3 id="文本处理"><a href="#文本处理" class="headerlink" title="文本处理"></a><strong>文本处理</strong></h3><p>cat file1 file2 … | command &lt;&gt; file1_in.txt_or_file1_out.txt general syntax for text manipulation using PIPE, STDIN and STDOUT<br>cat file1 | command( sed, grep, awk, grep, etc…) &gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个新文件中<br>cat file1 | command( sed, grep, awk, grep, etc…) &gt;&gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个已有的文件中<br>grep Aug /var/log/messages 在文件 ‘/var/log/messages’中查找关键词”Aug”<br>grep ^Aug /var/log/messages 在文件 ‘/var/log/messages’中查找以”Aug”开始的词汇<br>grep [0-9] /var/log/messages 选择 ‘/var/log/messages’ 文件中所有包含数字的行<br>grep Aug -R /var/log/* 在目录 ‘/var/log’ 及随后的目录中搜索字符串”Aug”<br>sed ‘s/stringa1/stringa2/g’ example.txt 将example.txt文件中的 “string1” 替换成 “string2”<br>sed ‘/^$/d’ example.txt 从example.txt文件中删除所有空白行<br>sed ‘/ <em>#/d; /^$/d’ example.txt 从example.txt文件中删除所有注释和空白行<br>echo ‘esempio’ | tr ‘[:lower:]’ ‘[:upper:]’ 合并上下单元格内容<br>sed -e ‘1d’ result.txt 从文件example.txt 中排除第一行<br>sed -n ‘/stringa1/p’ 查看只包含词汇 “string1”的行<br>sed -e ‘s/ *$//‘ example.txt 删除每一行最后的空白字符<br>sed -e ‘s/stringa1//g’ example.txt 从文档中只删除词汇 “string1” 并保留剩余全部<br>sed -n ‘1,5p;5q’ example.txt 查看从第一行到第5行内容<br>sed -n ‘5p;5q’ example.txt 查看第5行<br>sed -e ‘s/00</em>/0/g’ example.txt 用单个零替换多个零<br>cat -n file1 标示文件的行数<br>cat example.txt | awk ‘NR%2==1’ 删除example.txt文件中的所有偶数行<br>echo a b c | awk ‘{print $1}’ 查看一行第一栏<br>echo a b c | awk ‘{print $1,$3}’ 查看一行的第一和第三栏<br>paste file1 file2 合并两个文件或两栏的内容<br>paste -d ‘+’ file1 file2 合并两个文件或两栏的内容，中间用”+”区分<br>sort file1 file2 排序两个文件的内容<br>sort file1 file2 | uniq 取出两个文件的并集(重复的行只保留一份)<br>sort file1 file2 | uniq -u 删除交集，留下其他的行<br>sort file1 file2 | uniq -d 取出两个文件的交集(只留下同时存在于两个文件中的文件)<br>comm -1 file1 file2 比较两个文件的内容只删除 ‘file1’ 所包含的内容<br>comm -2 file1 file2 比较两个文件的内容只删除 ‘file2’ 所包含的内容<br>comm -3 file1 file2 比较两个文件的内容只删除两个文件共有的部分 </p>
<h3 id="字符设置和文件格式转换"><a href="#字符设置和文件格式转换" class="headerlink" title="字符设置和文件格式转换"></a><strong>字符设置和文件格式转换</strong></h3><p>dos2unix filedos.txt fileunix.txt 将一个文本文件的格式从MSDOS转换成UNIX<br>unix2dos fileunix.txt filedos.txt 将一个文本文件的格式从UNIX转换成MSDOS<br>recode ..HTML &lt; page.txt &gt; page.html 将一个文本文件转换成html<br>recode -l | more 显示所有允许的转换格式 </p>
<h3 id="文件系统分析"><a href="#文件系统分析" class="headerlink" title="文件系统分析"></a><strong>文件系统分析</strong></h3><p>badblocks -v /dev/hda1 检查磁盘hda1上的坏磁块<br>fsck /dev/hda1 修复/检查hda1磁盘上linux文件系统的完整性<br>fsck.ext2 /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性<br>e2fsck /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性<br>e2fsck -j /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性<br>fsck.ext3 /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性<br>fsck.vfat /dev/hda1 修复/检查hda1磁盘上fat文件系统的完整性<br>fsck.msdos /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性<br>dosfsck /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性 </p>
<h3 id="初始化一个文件系统"><a href="#初始化一个文件系统" class="headerlink" title="初始化一个文件系统"></a><strong>初始化一个文件系统</strong></h3><p>mkfs /dev/hda1 在hda1分区创建一个文件系统<br>mke2fs /dev/hda1 在hda1分区创建一个linux ext2的文件系统<br>mke2fs -j /dev/hda1 在hda1分区创建一个linux ext3(日志型)的文件系统<br>mkfs -t vfat 32 -F /dev/hda1 创建一个 FAT32 文件系统<br>fdformat -n /dev/fd0 格式化一个软盘<br>mkswap /dev/hda3 创建一个swap文件系统 </p>
<h3 id="SWAP文件系统"><a href="#SWAP文件系统" class="headerlink" title="SWAP文件系统"></a><strong>SWAP文件系统</strong></h3><p>mkswap /dev/hda3 创建一个swap文件系统<br>swapon /dev/hda3 启用一个新的swap文件系统<br>swapon /dev/hda2 /dev/hdb3 启用两个swap分区 </p>
<h3 id="备份"><a href="#备份" class="headerlink" title="备份"></a><strong>备份</strong></h3><p>dump -0aj -f /tmp/home0.bak /home 制作一个 ‘/home’ 目录的完整备份<br>dump -1aj -f /tmp/home0.bak /home 制作一个 ‘/home’ 目录的交互式备份<br>restore -if /tmp/home0.bak 还原一个交互式备份<br>rsync -rogpav –delete /home /tmp 同步两边的目录<br>rsync -rogpav -e ssh –delete /home ip_address:/tmp 通过SSH通道rsync<br>rsync -az -e ssh –delete ip_addr:/home/public /home/local 通过ssh和压缩将一个远程目录同步到本地目录<br>rsync -az -e ssh –delete /home/local ip_addr:/home/public 通过ssh和压缩将本地目录同步到远程目录<br>dd bs=1M if=/dev/hda | gzip | ssh user@ip_addr ‘dd of=hda.gz’ 通过ssh在远程主机上执行一次备份本地磁盘的操作<br>dd if=/dev/sda of=/tmp/file1 备份磁盘内容到一个文件<br>tar -Puf backup.tar /home/user 执行一次对 ‘/home/user’ 目录的交互式备份操作<br>( cd /tmp/local/ &amp;&amp; tar c . ) | ssh -C user@ip_addr ‘cd /home/share/ &amp;&amp; tar x -p’ 通过ssh在远程目录中复制一个目录内容<br>( tar c /home ) | ssh -C user@ip_addr ‘cd /home/backup-home &amp;&amp; tar x -p’ 通过ssh在远程目录中复制一个本地目录<br>tar cf - . | (cd /tmp/backup ; tar xf - ) 本地将一个目录复制到另一个地方，保留原有权限及链接<br>find /home/user1 -name ‘<em>.txt’ | xargs cp -av –target-directory=/home/backup/ –parents 从一个目录查找并复制所有以 ‘.txt’ 结尾的文件到另一个目录<br>find /var/log -name ‘</em>.log’ | tar cv –files-from=- | bzip2 &gt; log.tar.bz2 查找所有以 ‘.log’ 结尾的文件并做成一个bzip包<br>dd if=/dev/hda of=/dev/fd0 bs=512 count=1 做一个将 MBR (Master Boot Record)内容复制到软盘的动作<br>dd if=/dev/fd0 of=/dev/hda bs=512 count=1 从已经保存到软盘的备份中恢复MBR内容 </p>
<h3 id="光盘"><a href="#光盘" class="headerlink" title="光盘"></a><strong>光盘</strong></h3><p>cdrecord -v gracetime=2 dev=/dev/cdrom -eject blank=fast -force 清空一个可复写的光盘内容<br>mkisofs /dev/cdrom &gt; cd.iso 在磁盘上创建一个光盘的iso镜像文件<br>mkisofs /dev/cdrom | gzip &gt; cd_iso.gz 在磁盘上创建一个压缩了的光盘iso镜像文件<br>mkisofs -J -allow-leading-dots -R -V “Label CD” -iso-level 4 -o ./cd.iso data_cd 创建一个目录的iso镜像文件<br>cdrecord -v dev=/dev/cdrom cd.iso 刻录一个ISO镜像文件<br>gzip -dc cd_iso.gz | cdrecord dev=/dev/cdrom - 刻录一个压缩了的ISO镜像文件<br>mount -o loop cd.iso /mnt/iso 挂载一个ISO镜像文件<br>cd-paranoia -B 从一个CD光盘转录音轨到 wav 文件中<br>cd-paranoia – “-3” 从一个CD光盘转录音轨到 wav 文件中（参数-3）<br>cdrecord –scanbus 扫描总线以识别scsi通道<br>dd if=/dev/hdc | md5sum 校验一个设备的md5sum编码，例如一张 CD </p>
<h3 id="网络-（以太网和WIFI无线）"><a href="#网络-（以太网和WIFI无线）" class="headerlink" title="网络 - （以太网和WIFI无线）"></a><strong>网络 - （以太网和WIFI无线</strong>）</h3><p>ifconfig eth0 显示一个以太网卡的配置<br>ifup eth0 启用一个 ‘eth0’ 网络设备<br>ifdown eth0 禁用一个 ‘eth0’ 网络设备<br>ifconfig eth0 192.168.1.1 netmask 255.255.255.0 控制IP地址<br>ifconfig eth0 promisc 设置 ‘eth0’ 成混杂模式以嗅探数据包 (sniffing)<br>dhclient eth0 以dhcp模式启用 ‘eth0’<br>route -n show routing table<br>route add -net 0/0 gw IP_Gateway configura default gateway<br>route add -net 192.168.0.0 netmask 255.255.0.0 gw 192.168.1.1 configure static route to reach network ‘192.168.0.0/16’<br>route del 0/0 gw IP_gateway remove static route<br>echo “1” &gt; /proc/sys/net/ipv4/ip_forward activate ip routing<br>hostname show hostname of system<br>host <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> lookup hostname to resolve name to ip address and viceversa<br>nslookup <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> lookup hostname to resolve name to ip address and viceversa<br>ip link show show link status of all interfaces<br>mii-tool eth0 show link status of ‘eth0’<br>ethtool eth0 show statistics of network card ‘eth0’<br>netstat -tup show all active network connections and their PID<br>netstat -tupl show all network services listening on the system and their PID<br>tcpdump tcp port 80 show all HTTP traffic<br>iwlist scan show wireless networks<br>iwconfig eth1 show configuration of a wireless network card<br>hostname show hostname<br>host <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> lookup hostname to resolve name to ip address and viceversa<br>nslookup <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> lookup hostname to resolve name to ip address and viceversa<br>whois <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> lookup on Whois database </p>
<h3 id="JPS工具"><a href="#JPS工具" class="headerlink" title="JPS工具"></a><strong>JPS工具</strong></h3><p>jps(Java Virtual Machine Process Status Tool)是JDK 1.5提供的一个显示当前所有java进程pid的命令，简单实用，非常适合在linux/unix平台上简单察看当前java进程的一些简单情况。</p>
<p>  我想很多人都是用过unix系统里的ps命令，这个命令主要是用来显示当前系统的进程情况，有哪些进程，及其 id。 jps 也是一样，它的作用是显示当前系统的java进程情况，及其id号。我们可以通过它来查看我们到底启动了几个java进程（因为每一个java程序都会独占一个java虚拟机实例），和他们的进程号（为下面几个程序做准备），并可通过opt来查看这些进程的详细启动参数。</p>
<p>   <strong>使用方法：在当前命令行下打 jps(需要JAVA_HOME，没有的话，到改程序的目录下打) 。</strong></p>
<p><strong>jps存放在JAVA_HOME/bin/jps，使用时为了方便请将JAVA_HOME/bin/加入到Path.</strong></p>
<p>$&gt; <strong>jps</strong><br>23991 Jps<br>23789 BossMain<br>23651 Resin</p>
<p>比较常用的参数：</p>
<p><strong>-q 只显示pid，不显示class名称,jar文件名和传递给main 方法的参数</strong><br>$&gt; <strong>jps -q</strong><br>28680<br>23789<br>23651</p>
<p><strong>-m 输出传递给main 方法的参数，在嵌入式jvm上可能是null</strong></p>
<p>$&gt; <strong>jps -m</strong><br>28715 Jps -m<br>23789 BossMain<br>23651 Resin -socketwait 32768 -stdout /data/aoxj/resin/log/stdout.log -stderr /data/aoxj/resin/log/stderr.log</p>
<p><strong>-l 输出应用程序main class的完整package名 或者 应用程序的jar文件完整路径名</strong></p>
<p>$&gt; <strong>jps -l</strong><br>28729 sun.tools.jps.Jps<br>23789 com.asiainfo.aimc.bossbi.BossMain<br>23651 com.caucho.server.resin.Resin</p>
<p><strong>-v 输出传递给JVM的参数</strong></p>
<p>$&gt; <strong>jps -v</strong><br>23789 BossMain<br>28802 Jps -Denv.class.path=/data/aoxj/bossbi/twsecurity/java/trustwork140.jar:/data/aoxj/bossbi/twsecurity/java/:/data/aoxj/bossbi/twsecurity/java/twcmcc.jar:/data/aoxj/jdk15/lib/rt.jar:/data/aoxj/jd</p>
<p>k15/lib/tools.jar -Dapplication.home=/data/aoxj/jdk15 -Xms8m<br>23651 Resin -Xss1m -Dresin.home=/data/aoxj/resin -Dserver.root=/data/aoxj/resin -Djava.util.logging.manager=com.caucho.log.LogManagerImpl -</p>
<p>Djavax.management.builder.initial=com.caucho.jmx.MBeanServerBuilderImpl</p>
<p><strong>sudo jps看到的进程数量最全</strong></p>
<p><strong>jps 192.168.0.77</strong></p>
<p><strong>列出远程服务器192.168.0.77机器所有的jvm实例，采用rmi协议，默认连接端口为1099</strong></p>
<p><strong>（前提是远程服务器提供jstatd服务）</strong></p>
<p><strong>注：jps命令有个地方很不好，似乎只能显示当前用户的java进程，要显示其他用户的还是只能用unix/linux的ps命令。</strong></p>
<p>详细情况请参考sun官方文档。<br><a href="http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jps.html" target="_blank" rel="noopener">http://java.sun.com/j2se/1.7.0/docs/tooldocs/share/jps.html</a></p>
<p>GO TOP INDEX ^<br>Microsoft Windows networks (SAMBA)<br>nbtscan ip_addr netbios name resolution<br>nmblookup -A ip_addr netbios name resolution<br>smbclient -L ip_addr/hostname show remote shares of a windows host<br>smbget -Rr smb://ip_addr/share like wget can download files from a host windows via smb<br>mount -t smbfs -o username=user,password=pass //WinClient/share /mnt/share mount a windows network share</p>
<p>A man must be on his own！</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>字符编码笔记：ASCII，Unicode 和 UTF-8</title>
    <url>/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/</url>
    <content><![CDATA[<p>这里引用阮一峰的两篇文章：</p>
<p><a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2014/12/unicode.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2014/12/unicode.html</a></p>
<h2 id="一、ASCII-码"><a href="#一、ASCII-码" class="headerlink" title="一、ASCII 码"></a><strong>一、ASCII 码</strong></h2><p>我们知道，计算机内部，所有信息最终都是一个二进制值。每一个二进制位（bit）有<code>0</code>和<code>1</code>两种状态，因此八个二进制位就可以组合出256种状态，这被称为一个字节（byte）。也就是说，一个字节一共可以用来表示256种不同的状态，每一个状态对应一个符号，就是256个符号，从<code>00000000</code>到<code>11111111</code>。</p>
<p>上个世纪60年代，美国制定了一套字符编码，对英语字符与二进制位之间的关系，做了统一规定。这被称为 ASCII 码，一直沿用至今。</p>
<p>ASCII 码一共规定了128个字符的编码，比如空格<code>SPACE</code>是32（二进制<code>00100000</code>），大写的字母<code>A</code>是65（二进制<code>01000001</code>）。这128个符号（包括32个不能打印出来的控制符号），只占用了一个字节的后面7位，最前面的一位统一规定为<code>0</code>。</p>
<h2 id="二、非-ASCII-编码"><a href="#二、非-ASCII-编码" class="headerlink" title="二、非 ASCII 编码"></a><strong>二、非 ASCII 编码</strong></h2><p>英语用128个符号编码就够了，但是用来表示其他语言，128个符号是不够的。比如，在法语中，字母上方有注音符号，它就无法用 ASCII 码表示。于是，一些欧洲国家就决定，利用字节中闲置的最高位编入新的符号。比如，法语中的<code>é</code>的编码为130（二进制<code>10000010</code>）。这样一来，这些欧洲国家使用的编码体系，可以表示最多256个符号。</p>
<p>但是，这里又出现了新的问题。不同的国家有不同的字母，因此，哪怕它们都使用256个符号的编码方式，代表的字母却不一样。比如，130在法语编码中代表了<code>é</code>，在希伯来语编码中却代表了字母<code>Gimel</code> (<code>ג</code>)，在俄语编码中又会代表另一个符号。但是不管怎样，所有这些编码方式中，0–127表示的符号是一样的，不一样的只是128–255的这一段。</p>
<p>至于亚洲国家的文字，使用的符号就更多了，汉字就多达10万左右。一个字节只能表示256种符号，肯定是不够的，就必须使用多个字节表达一个符号。比如，简体中文常见的编码方式是 GB2312，使用两个字节表示一个汉字，所以理论上最多可以表示 256 x 256 = 65536 个符号。</p>
<p>中文编码的问题需要专文讨论，这篇笔记不涉及。这里只指出，虽然都是用多个字节表示一个符号，但是GB类的汉字编码与后文的 Unicode 和 UTF-8 是毫无关系的。</p>
<h2 id="三-Unicode"><a href="#三-Unicode" class="headerlink" title="三. Unicode"></a><strong>三. Unicode</strong></h2><p>正如上一节所说，世界上存在着多种编码方式，同一个二进制数字可以被解释成不同的符号。因此，要想打开一个文本文件，就必须知道它的编码方式，否则用错误的编码方式解读，就会出现乱码。为什么电子邮件常常出现乱码？就是因为发信人和收信人使用的编码方式不一样。</p>
<p>可以想象，如果有一种编码，将世界上所有的符号都纳入其中。每一个符号都给予一个独一无二的编码，那么乱码问题就会消失。这就是 Unicode，就像它的名字都表示的，这是一种所有符号的编码。</p>
<p>Unicode 当然是一个很大的集合，现在的规模可以容纳100多万个符号。每个符号的编码都不一样，比如，<code>U+0639</code>表示阿拉伯字母<code>Ain</code>，<code>U+0041</code>表示英语的大写字母<code>A</code>，<code>U+4E25</code>表示汉字<code>严</code>。具体的符号对应表，可以查询<a href="http://www.unicode.org/" target="_blank" rel="noopener">unicode.org</a>，或者专门的<a href="http://www.chi2ko.com/tool/CJK.htm" target="_blank" rel="noopener">汉字对应表</a>。</p>
<h2 id="四、Unicode-的问题"><a href="#四、Unicode-的问题" class="headerlink" title="四、Unicode 的问题"></a><strong>四、Unicode 的问题</strong></h2><p>需要注意的是，Unicode 只是一个符号集，它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。</p>
<p>比如，汉字<code>严</code>的 Unicode 是十六进制数<code>4E25</code>，转换成二进制数足足有15位（<code>100111000100101</code>），也就是说，这个符号的表示至少需要2个字节。表示其他更大的符号，可能需要3个字节或者4个字节，甚至更多。</p>
<p>这里就有两个严重的问题，第一个问题是，如何才能区别 Unicode 和 ASCII ？计算机怎么知道三个字节表示一个符号，而不是分别表示三个符号呢？第二个问题是，我们已经知道，英文字母只用一个字节表示就够了，如果 Unicode 统一规定，每个符号用三个或四个字节表示，那么每个英文字母前都必然有二到三个字节是<code>0</code>，这对于存储来说是极大的浪费，文本文件的大小会因此大出二三倍，这是无法接受的。</p>
<p>它们造成的结果是：1）出现了 Unicode 的多种存储方式，也就是说有许多种不同的二进制格式，可以用来表示 Unicode。2）Unicode 在很长一段时间内无法推广，直到互联网的出现。</p>
<h2 id="五、UTF-8"><a href="#五、UTF-8" class="headerlink" title="五、UTF-8"></a><strong>五、UTF-8</strong></h2><p>互联网的普及，强烈要求出现一种统一的编码方式。UTF-8 就是在互联网上使用最广的一种 Unicode 的实现方式。其他实现方式还包括 UTF-16（字符用两个字节或四个字节表示）和 UTF-32（字符用四个字节表示），不过在互联网上基本不用。<strong>重复一遍，这里的关系是，UTF-8 是 Unicode 的实现方式之一。</strong></p>
<p>UTF-8 最大的一个特点，就是它是一种变长的编码方式。它可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。</p>
<p>UTF-8 的编码规则很简单，只有二条：</p>
<p>1）对于单字节的符号，字节的第一位设为<code>0</code>，后面7位为这个符号的 Unicode 码。因此对于英语字母，UTF-8 编码和 ASCII 码是相同的。</p>
<p>2）对于<code>n</code>字节的符号（<code>n &gt; 1</code>），第一个字节的前<code>n</code>位都设为<code>1</code>，第<code>n + 1</code>位设为<code>0</code>，后面字节的前两位一律设为<code>10</code>。剩下的没有提及的二进制位，全部为这个符号的 Unicode 码。</p>
<p>下表总结了编码规则，字母<code>x</code>表示可用编码的位。</p>
<blockquote>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Unicode符号范围     |        UTF<span class="number">-8</span>编码方式</span></pre></td></tr><tr><td class="code"><pre><span class="line">(十六进制)        |              （二进制）</span></pre></td></tr><tr><td class="code"><pre><span class="line">----------------------+---------------------------------------------</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="number">0000</span> <span class="number">0000</span><span class="number">-0000</span> <span class="number">007</span>F | <span class="number">0</span>xxxxxxx</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="number">0000</span> <span class="number">0080</span><span class="number">-0000</span> <span class="number">07</span>FF | <span class="number">110</span>xxxxx <span class="number">10</span>xxxxxx</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="number">0000</span> <span class="number">0800</span><span class="number">-0000</span> FFFF | <span class="number">1110</span>xxxx <span class="number">10</span>xxxxxx <span class="number">10</span>xxxxxx</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="number">0001</span> <span class="number">0000</span><span class="number">-0010</span> FFFF | <span class="number">11110</span>xxx <span class="number">10</span>xxxxxx <span class="number">10</span>xxxxxx <span class="number">10</span>xxxxxx</span></pre></td></tr></table></figure>
</blockquote>
<p>跟据上表，解读 UTF-8 编码非常简单。如果一个字节的第一位是<code>0</code>，则这个字节单独就是一个字符；如果第一位是<code>1</code>，则连续有多少个<code>1</code>，就表示当前字符占用多少个字节。</p>
<p>下面，还是以汉字<code>严</code>为例，演示如何实现 UTF-8 编码。</p>
<p><code>严</code>的 Unicode 是<code>4E25</code>（<code>100111000100101</code>），根据上表，可以发现<code>4E25</code>处在第三行的范围内（<code>0000 0800 - 0000 FFFF</code>），因此<code>严</code>的 UTF-8 编码需要三个字节，即格式是<code>1110xxxx 10xxxxxx 10xxxxxx</code>。然后，从<code>严</code>的最后一个二进制位开始，依次从后向前填入格式中的<code>x</code>，多出的位补<code>0</code>。这样就得到了，<code>严</code>的 UTF-8 编码是<code>11100100 10111000 10100101</code>，转换成十六进制就是<code>E4B8A5</code>。</p>
<h2 id="六、Unicode-与-UTF-8-之间的转换"><a href="#六、Unicode-与-UTF-8-之间的转换" class="headerlink" title="六、Unicode 与 UTF-8 之间的转换"></a><strong>六、Unicode 与 UTF-8 之间的转换</strong></h2><p>通过上一节的例子，可以看到<code>严</code>的 Unicode码 是<code>4E25</code>，UTF-8 编码是<code>E4B8A5</code>，两者是不一样的。它们之间的转换可以通过程序实现。</p>
<p>Windows平台，有一个最简单的转化方法，就是使用内置的记事本小程序<code>notepad.exe</code>。打开文件后，点击<code>文件</code>菜单中的<code>另存为</code>命令，会跳出一个对话框，在最底部有一个<code>编码</code>的下拉条。</p>
<p><a href="http://www.ruanyifeng.com/blog/2007/10/bg2007102801.jpg" target="_blank" rel="noopener"><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2007102801-thumb-1607839331264.jpg" alt="bg2007102801.jpg"></a></p>
<p>里面有四个选项：<code>ANSI</code>，<code>Unicode</code>，<code>Unicode big endian</code>和<code>UTF-8</code>。</p>
<p>1）<code>ANSI</code>是默认的编码方式。对于英文文件是<code>ASCII</code>编码，对于简体中文文件是<code>GB2312</code>编码（只针对 Windows 简体中文版，如果是繁体中文版会采用 Big5 码）。</p>
<p>2）<code>Unicode</code>编码这里指的是<code>notepad.exe</code>使用的 UCS-2 编码方式，即直接用两个字节存入字符的 Unicode 码，这个选项用的 little endian 格式。</p>
<p>3）<code>Unicode big endian</code>编码与上一个选项相对应。我在下一节会解释 little endian 和 big endian 的涵义。</p>
<p>4）<code>UTF-8</code>编码，也就是上一节谈到的编码方法。</p>
<p>选择完”编码方式”后，点击”保存”按钮，文件的编码方式就立刻转换好了。</p>
<h2 id="七、Little-endian-和-Big-endian"><a href="#七、Little-endian-和-Big-endian" class="headerlink" title="七、Little endian 和 Big endian"></a><strong>七、Little endian 和 Big endian</strong></h2><p>上一节已经提到，UCS-2 格式可以存储 Unicode 码（码点不超过<code>0xFFFF</code>）。以汉字<code>严</code>为例，Unicode 码是<code>4E25</code>，需要用两个字节存储，一个字节是<code>4E</code>，另一个字节是<code>25</code>。存储的时候，<code>4E</code>在前，<code>25</code>在后，这就是 Big endian 方式；<code>25</code>在前，<code>4E</code>在后，这是 Little endian 方式。</p>
<p>这两个古怪的名称来自英国作家斯威夫特的《格列佛游记》。在该书中，小人国里爆发了内战，战争起因是人们争论，吃鸡蛋时究竟是从大头(Big-endian)敲开还是从小头(Little-endian)敲开。为了这件事情，前后爆发了六次战争，一个皇帝送了命，另一个皇帝丢了王位。</p>
<p>第一个字节在前，就是”大头方式”（Big endian），第二个字节在前就是”小头方式”（Little endian）。</p>
<p>那么很自然的，就会出现一个问题：计算机怎么知道某一个文件到底采用哪一种方式编码？</p>
<p>Unicode 规范定义，每一个文件的最前面分别加入一个表示编码顺序的字符，这个字符的名字叫做”零宽度非换行空格”（zero width no-break space），用<code>FEFF</code>表示。这正好是两个字节，而且<code>FF</code>比<code>FE</code>大<code>1</code>。</p>
<p>如果一个文本文件的头两个字节是<code>FE FF</code>，就表示该文件采用大头方式；如果头两个字节是<code>FF FE</code>，就表示该文件采用小头方式。</p>
<h2 id="八、实例"><a href="#八、实例" class="headerlink" title="八、实例"></a><strong>八、实例</strong></h2><p>下面，举一个实例。</p>
<p>打开”记事本”程序<code>notepad.exe</code>，新建一个文本文件，内容就是一个<code>严</code>字，依次采用<code>ANSI</code>，<code>Unicode</code>，<code>Unicode big endian</code>和<code>UTF-8</code>编码方式保存。</p>
<p>然后，用文本编辑软件<a href="http://www.google.cn/search?aq=t&oq=UltraEdit&complete=1&hl=zh-CN&newwindow=1&rlz=1B3GGGL_zh-CNCN216CN216&q=ultraedit+下载&btnG=Google+搜索&meta=" target="_blank" rel="noopener">UltraEdit 中</a>的”十六进制功能”，观察该文件的内部编码方式。</p>
<p>1）ANSI：文件的编码就是两个字节<code>D1 CF</code>，这正是<code>严</code>的 GB2312 编码，这也暗示 GB2312 是采用大头方式存储的。</p>
<p>2）Unicode：编码是四个字节<code>FF FE 25 4E</code>，其中<code>FF FE</code>表明是小头方式存储，真正的编码是<code>4E25</code>。</p>
<p>3）Unicode big endian：编码是四个字节<code>FE FF 4E 25</code>，其中<code>FE FF</code>表明是大头方式存储。</p>
<p>4）UTF-8：编码是六个字节<code>EF BB BF E4 B8 A5</code>，前三个字节<code>EF BB BF</code>表示这是UTF-8编码，后三个<code>E4B8A5</code>就是<code>严</code>的具体编码，它的存储顺序与编码顺序是一致的。</p>
<h1 id="Unicode与JavaScript详解"><a href="#Unicode与JavaScript详解" class="headerlink" title="Unicode与JavaScript详解"></a>Unicode与JavaScript详解</h1><h2 id="一、Unicode是什么？"><a href="#一、Unicode是什么？" class="headerlink" title="一、Unicode是什么？"></a>一、Unicode是什么？</h2><p>Unicode源于一个很简单的想法：将全世界所有的字符包含在一个集合里，计算机只要支持这一个字符集，就能显示所有的字符，再也不会有乱码了。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121103-1607839343682.jpg" alt="img"></p>
<p><strong>它从0开始，为每个符号指定一个编号，这叫做”码点”（code point）。</strong>比如，码点0的符号就是null（表示所有二进制位都是0）。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">U+<span class="number">0000</span> = <span class="literal">null</span></span></pre></td></tr></table></figure>
</blockquote>
<p>上式中，U+表示紧跟在后面的十六进制数是Unicode的码点。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121115-1607839347082.png" alt="img"></p>
<p>目前，Unicode的最新版本是7.0版，一共收入了109449个符号，其中的中日韩文字为74500个。可以近似认为，全世界现有的符号当中，三分之二以上来自东亚文字。比如，中文”好”的码点是十六进制的597D。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">U+<span class="number">597</span>D = 好</span></pre></td></tr></table></figure>
</blockquote>
<p>这么多符号，Unicode不是一次性定义的，而是分区定义。每个区可以存放65536个（216）字符，称为一个平面（plane）。目前，一共有17个（25）平面，也就是说，整个Unicode字符集的大小现在是221。</p>
<p>最前面的65536个字符位，称为基本平面（缩写BMP），它的码点范围是从0一直到216-1，写成16进制就是从U+0000到U+FFFF。所有最常见的字符都放在这个平面，这是Unicode最先定义和公布的一个平面。</p>
<p>剩下的字符都放在辅助平面（缩写SMP），码点范围从U+010000一直到U+10FFFF。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121104-1607839349198.png" alt="img"></p>
<h2 id="二、UTF-32与UTF-8"><a href="#二、UTF-32与UTF-8" class="headerlink" title="二、UTF-32与UTF-8"></a>二、UTF-32与UTF-8</h2><p>Unicode只规定了每个字符的码点，到底用什么样的字节序表示这个码点，就涉及到编码方法。</p>
<p><strong>最直观的编码方法是，每个码点使用四个字节表示，字节内容一一对应码点。这种编码方法就叫做UTF-32。</strong>比如，码点0就用四个字节的0表示，码点597D就在前面加两个字节的0。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">U+<span class="number">0000</span> = <span class="number">0x0000</span> <span class="number">0000</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">U+<span class="number">597</span>D = <span class="number">0x0000</span> <span class="number">597</span>D</span></pre></td></tr></table></figure>
</blockquote>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121116-1607839351292.png" alt="img"></p>
<p>UTF-32的优点在于，转换规则简单直观，查找效率高。缺点在于浪费空间，同样内容的英语文本，它会比ASCII编码大四倍。这个缺点很致命，导致实际上没有人使用这种编码方法，HTML 5标准就明文规定，网页不得编码成UTF-32。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121105-1607839353048.png" alt="img"></p>
<p>人们真正需要的是一种节省空间的编码方法，这导致了UTF-8的诞生。<strong>UTF-8是一种变长的编码方法，字符长度从1个字节到4个字节不等。</strong>越是常用的字符，字节越短，最前面的128个字符，只使用1个字节表示，与ASCII码完全相同。</p>
<table>
<thead>
<tr>
<th>编号范围</th>
<th>字节</th>
</tr>
</thead>
<tbody><tr>
<td>0x0000 - 0x007F</td>
<td>1</td>
</tr>
<tr>
<td>0x0080 - 0x07FF</td>
<td>2</td>
</tr>
<tr>
<td>0x0800 - 0xFFFF</td>
<td>3</td>
</tr>
<tr>
<td>0x010000 - 0x10FFFF</td>
<td>4</td>
</tr>
</tbody></table>
<p>由于UTF-8这种节省空间的特性，导致它成为互联网上最常见的网页编码。不过，它跟今天的主题关系不大，我就不深入了，具体的转码方法，可以参考我多年前写的<a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">《字符编码笔记》</a>。</p>
<h2 id="三、UTF-16简介"><a href="#三、UTF-16简介" class="headerlink" title="三、UTF-16简介"></a>三、UTF-16简介</h2><p>UTF-16编码介于UTF-32与UTF-8之间，同时结合了定长和变长两种编码方法的特点。</p>
<p>它的编码规则很简单：基本平面的字符占用2个字节，辅助平面的字符占用4个字节。<strong>也就是说，UTF-16的编码长度要么是2个字节（U+0000到U+FFFF），要么是4个字节（U+010000到U+10FFFF）。</strong></p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121106-1607839355304.png" alt="img"></p>
<p>于是就有一个问题，当我们遇到两个字节，怎么看出它本身是一个字符，还是需要跟其他两个字节放在一起解读？</p>
<p>说来很巧妙，我也不知道是不是故意的设计，在基本平面内，从U+D800到U+DFFF是一个空段，即这些码点不对应任何字符。因此，这个空段可以用来映射辅助平面的字符。</p>
<p>具体来说，辅助平面的字符位共有220个，也就是说，对应这些字符至少需要20个二进制位。UTF-16将这20位拆成两半，前10位映射在U+D800到U+DBFF（空间大小210），称为高位（H），后10位映射在U+DC00到U+DFFF（空间大小210），称为低位（L）。这意味着，一个辅助平面的字符，被拆成两个基本平面的字符表示。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121117-1607839357568.png" alt="img"></p>
<p><strong>所以，当我们遇到两个字节，发现它的码点在U+D800到U+DBFF之间，就可以断定，紧跟在后面的两个字节的码点，应该在U+DC00到U+DFFF之间，这四个字节必须放在一起解读。</strong></p>
<h2 id="四、UTF-16的转码公式"><a href="#四、UTF-16的转码公式" class="headerlink" title="四、UTF-16的转码公式"></a>四、UTF-16的转码公式</h2><p>Unicode码点转成UTF-16的时候，首先区分这是基本平面字符，还是辅助平面字符。如果是前者，直接将码点转为对应的十六进制形式，长度为两字节。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">U+<span class="number">597</span>D = <span class="number">0x597D</span></span></pre></td></tr></table></figure>
</blockquote>
<p>如果是辅助平面字符，Unicode 3.0版给出了转码公式。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">H = <span class="built_in">Math</span>.floor((c<span class="number">-0x10000</span>) / <span class="number">0x400</span>)+<span class="number">0xD800</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">L = (c - <span class="number">0x10000</span>) % <span class="number">0x400</span> + <span class="number">0xDC00</span></span></pre></td></tr></table></figure>
</blockquote>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121107-1607839359685.png" alt="img"></p>
<p>以字符![img](C:\Users\WX03\Desktop\张博文记录\字符编码笔记：ASCII，Unicode 和 UTF-8\bg2014121121-1.png)为例，它是一个辅助平面字符，码点为U+1D306，将其转为UTF-16的计算过程如下。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">H = <span class="built_in">Math</span>.floor((<span class="number">0x1D306</span><span class="number">-0x10000</span>)/<span class="number">0x400</span>)+<span class="number">0xD800</span> = <span class="number">0xD834</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">L = (<span class="number">0x1D306</span><span class="number">-0x10000</span>) % <span class="number">0x400</span>+<span class="number">0xDC00</span> = <span class="number">0xDF06</span></span></pre></td></tr></table></figure>
</blockquote>
<p>所以，字符![img](C:\Users\WX03\Desktop\张博文记录\字符编码笔记：ASCII，Unicode 和 UTF-8\bg2014121121-1.png)的UTF-16编码就是0xD834 DF06，长度为四个字节。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121118-1607839361287.png" alt="img"></p>
<h2 id="五、JavaScript使用哪一种编码？"><a href="#五、JavaScript使用哪一种编码？" class="headerlink" title="五、JavaScript使用哪一种编码？"></a>五、JavaScript使用哪一种编码？</h2><p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121108-1607839362726.png" alt="img"></p>
<p>JavaScript语言采用Unicode字符集，但是只支持一种编码方法。</p>
<p>这种编码既不是UTF-16，也不是UTF-8，更不是UTF-32。上面那些编码方法，JavaScript都不用。</p>
<p><strong>JavaScript用的是UCS-2！</strong></p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121109-1607839364889.png" alt="img"></p>
<h2 id="六、UCS-2编码"><a href="#六、UCS-2编码" class="headerlink" title="六、UCS-2编码"></a>六、UCS-2编码</h2><p>怎么突然杀出一个UCS-2？这就需要讲一点历史。</p>
<p>互联网还没出现的年代，曾经有两个团队，不约而同想搞统一字符集。一个是1988年成立的Unicode团队，另一个是1989年成立的UCS团队。等到他们发现了对方的存在，很快就达成一致：世界上不需要两套统一字符集。</p>
<p>1991年10月，两个团队决定合并字符集。也就是说，从今以后只发布一套字符集，就是Unicode，并且修订此前发布的字符集，UCS的码点将与Unicode完全一致。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121119-1607839366617.jpg" alt="img"></p>
<p>UCS的开发进度快于Unicode，1990年就公布了第一套编码方法UCS-2，使用2个字节表示已经有码点的字符。（那个时候只有一个平面，就是基本平面，所以2个字节就够用了。）UTF-16编码迟至1996年7月才公布，明确宣布是UCS-2的超集，即基本平面字符沿用UCS-2编码，辅助平面字符定义了4个字节的表示方法。</p>
<p><strong>两者的关系简单说，就是UTF-16取代了UCS-2，或者说UCS-2整合进了UTF-16。</strong>所以，现在只有UTF-16，没有UCS-2。</p>
<h2 id="七、JavaScript的诞生背景"><a href="#七、JavaScript的诞生背景" class="headerlink" title="七、JavaScript的诞生背景"></a>七、JavaScript的诞生背景</h2><p>那么，为什么JavaScript不选择更高级的UTF-16，而用了已经被淘汰的UCS-2呢？</p>
<p>答案很简单：非不想也，是不能也。<strong>因为在JavaScript语言出现的时候，还没有UTF-16编码。</strong></p>
<p>1995年5月，Brendan Eich用了10天设计了JavaScript语言；10月，第一个解释引擎问世；次年11月，Netscape正式向ECMA提交语言标准（整个过程详见<a href="http://www.ruanyifeng.com/blog/2011/06/birth_of_javascript.html" target="_blank" rel="noopener">《JavaScript诞生记》</a>）。对比UTF-16的发布时间（1996年7月），就会明白Netscape公司那时没有其他选择，只有UCS-2一种编码方法可用！</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121120-1607839368619.png" alt="img"></p>
<h2 id="八、JavaScript字符函数的局限"><a href="#八、JavaScript字符函数的局限" class="headerlink" title="八、JavaScript字符函数的局限"></a>八、JavaScript字符函数的局限</h2><p><strong>由于JavaScript只能处理UCS-2编码，造成所有字符在这门语言中都是2个字节，如果是4个字节的字符，会当作两个双字节的字符处理。</strong>JavaScript的字符函数都受到这一点的影响，无法返回正确结果。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121110-1607839370495.png" alt="img"></p>
<p>还是以字符![img](C:\Users\WX03\Desktop\张博文记录\字符编码笔记：ASCII，Unicode 和 UTF-8\bg2014121121-1.png)为例，它的UTF-16编码是4个字节的0xD834 DF06。问题就来了，4个字节的编码不属于UCS-2，JavaScript不认识，只会把它看作单独的两个字符U+D834和U+DF06。前面说过，这两个码点是空的，所以JavaScript会认为<img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014121121-1.png" alt="img">是两个空字符组成的字符串！</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121122-1607839372478.png" alt="img"></p>
<p>上面代码表示，JavaScript认为字符<img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014121121-1.png" alt="img">的长度是2，取到的第一个字符是空字符，取到的第一个字符的码点是0xDB34。这些结果都不正确！</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121111-1607839471993.png" alt="img"></p>
<p>解决这个问题，必须对码点做一个判断，然后手动调整。下面是正确的遍历字符串的写法。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (++index &lt; length) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> (charCode &gt;= <span class="number">0xD800</span> &amp;&amp; charCode &lt;= <span class="number">0xDBFF</span>) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    output.push(character + string.charAt(++index));</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125; <span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    output.push(character);</span></pre></td></tr><tr><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>上面代码表示，遍历字符串的时候，必须对码点做一个判断，只要落在0xD800到0xDBFF的区间，就要连同后面2个字节一起读取。</p>
<p>类似的问题存在于所有的JavaScript字符操作函数。</p>
<blockquote>
<ul>
<li>String.prototype.replace()</li>
<li>String.prototype.substring()</li>
<li>String.prototype.slice()</li>
<li>…</li>
</ul>
</blockquote>
<p>上面的函数都只对2字节的码点有效。要正确处理4字节的码点，就必须逐一部署自己的版本，判断一下当前字符的码点范围。</p>
<h2 id="九、ECMAScript-6"><a href="#九、ECMAScript-6" class="headerlink" title="九、ECMAScript 6"></a>九、ECMAScript 6</h2><p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121112-1607839311267.png" alt="img"></p>
<p>JavaScript的下一个版本ECMAScript 6（简称ES6），大幅增强了Unicode支持，基本上解决了这个问题。</p>
<p><strong>（1）正确识别字符</strong></p>
<p>ES6可以自动识别4字节的码点。因此，遍历字符串就简单多了。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> s <span class="keyword">of</span> string ) &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</blockquote>
<p>但是，为了保持兼容，length属性还是原来的行为方式。为了得到字符串的正确长度，可以用下面的方式。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(string).length</span></pre></td></tr></table></figure>
</blockquote>
<p><strong>（2）码点表示法</strong></p>
<p>JavaScript允许直接用码点表示Unicode字符，写法是”反斜杠+u+码点”。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">'好'</span> === <span class="string">'\u597D'</span> <span class="comment">// true</span></span></pre></td></tr></table></figure>
</blockquote>
<p>但是，这种表示法对4字节的码点无效。ES6修正了这个问题，只要将码点放在大括号内，就能正确识别。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121123-1607839063327-1607839074632-1607839299600.png" alt="img"></p>
<p><strong>（3）字符串处理函数</strong></p>
<p>ES6新增了几个专门处理4字节码点的函数。</p>
<blockquote>
<ul>
<li><strong>String.fromCodePoint()</strong>：从Unicode码点返回对应字符</li>
<li><strong>String.prototype.codePointAt()</strong>：从字符返回对应的码点</li>
<li><strong>String.prototype.at()</strong>：返回字符串给定位置的字符</li>
</ul>
</blockquote>
<p><strong>（4）正则表达式</strong></p>
<p>ES6提供了u修饰符，对正则表达式添加4字节码点的支持。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121124-1607839303650.png" alt="img"></p>
<p><strong>（5）Unicode正规化</strong></p>
<p>有些字符除了字母以外，还有<a href="http://zh.wikipedia.org/wiki/附加符号" target="_blank" rel="noopener">附加符号</a>。比如，汉语拼音的Ǒ，字母上面的声调就是附加符号。对于许多欧洲语言来说，声调符号是非常重要的。</p>
<p><img src="/js/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E7%AC%94%E8%AE%B0%EF%BC%9AASCII%EF%BC%8CUnicode%20%E5%92%8C%20UTF-8/bg2014121113-1607839306035.png" alt="img"></p>
<p>Unicode提供了两种表示方法。一种是带附加符号的单个字符，即一个码点表示一个字符，比如Ǒ的码点是U+01D1；另一种是将附加符号单独作为一个码点，与主体字符复合显示，即两个码点表示一个字符，比如Ǒ可以写成O（U+004F） + ˇ（U+030C）。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">'\u01D1'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 'Ǒ'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 方法二</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">'\u004F\u030C'</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 'Ǒ'</span></span></pre></td></tr></table></figure>
</blockquote>
<p>这两种表示方法，视觉和语义都完全一样，理应作为等同情况处理。但是，JavaScript无法辨别。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">'\u01D1'</span>===<span class="string">'\u004F\u030C'</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//false</span></span></pre></td></tr></table></figure>
</blockquote>
<p>ES6提供了normalize方法，允许<a href="http://zh.wikipedia.org/wiki/Unicode正規化" target="_blank" rel="noopener">“Unicode正规化”</a>，即将两种方法转为同样的序列。</p>
<blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">'\u01D1'</span>.normalize() === <span class="string">'\u004F\u030C'</span>.normalize() </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// true</span></span></pre></td></tr></table></figure></blockquote>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript的执行上下文，理解JavaScript的作用域链，JavaScript中的this</title>
    <url>/js/%E8%BD%AC-JavaScript%E7%9A%84%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/</url>
    <content><![CDATA[<blockquote>
<p>学习了一篇 js 偏底层基础 的文章：JavaScript 的执行上下文 Execution context   </p>
<p>我将三篇文章放在一起 最后加了一些自己的总结 和 函数表达式的理解</p>
<p>原文地址：</p>
<p><a href="https://www.cnblogs.com/wilber2013/p/4909430.html#_nav_0" target="_blank" rel="noopener">JavaScript的执行上下文</a></p>
<p><a href="https://www.cnblogs.com/wilber2013/p/4909459.html" target="_blank" rel="noopener">理解JavaScript的作用域链</a></p>
<p><a href="https://www.cnblogs.com/wilber2013/p/4909505.html#_nav_3" target="_blank" rel="noopener">JavaScript中的this</a></p>
</blockquote>
<h1 id="JavaScript的执行上下文"><a href="#JavaScript的执行上下文" class="headerlink" title="JavaScript的执行上下文"></a>JavaScript的执行上下文</h1><p>在JavaScript的运行过程中，经常会遇到一些”奇怪”的行为，不理解为什么JavaScript会这么工作。</p>
<p>这时候可能就需要了解一下JavaScript执行过程中的相关内容了。</p>
<h2 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h2><p>在JavaScript中有三种代码运行环境：</p>
<ul>
<li>Global Code<ul>
<li>JavaScript代码开始运行的默认环境</li>
</ul>
</li>
<li>Function Code<ul>
<li>代码进入一个JavaScript函数</li>
</ul>
</li>
<li>Eval Code<ul>
<li>使用eval()执行代码</li>
</ul>
</li>
</ul>
<p>为了表示不同的运行环境，JavaScript中有一个<strong>执行上下文（Execution context，EC）</strong>的概念。也就是说，当JavaScript代码执行的时候，会进入不同的执行上下文，这些执行上下文就构成了一个<strong>执行上下文栈（Execution context stack，ECS）</strong>。</p>
<p>例如对如下面的JavaScript代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">"global var"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(a);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outerFunc</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> b = <span class="string">"var in outerFunc"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(b);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">innerFunc</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> c = <span class="string">"var in innerFunc"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(c);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        foo();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    innerFunc();</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">outerFunc()</span></pre></td></tr></table></figure>


<p>代码首先进入Global Execution Context，然后依次进入outerFunc，innerFunc和foo的执行上下文，执行上下文栈就可以表示为：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025201151427-127726802.png" alt="img"></p>
<p>当JavaScript代码执行的时候，第一个进入的总是默认的Global Execution Context，所以说它总是在ECS的最底部。</p>
<p>对于每个Execution Context都有三个重要的属性，变量对象（Variable object，VO），作用域链（Scope chain）和this。这三个属性跟代码运行的行为有很重要的关系，下面会一一介绍。</p>
<p>当然，除了这三个属性之外，根据实现的需要，Execution Context还可以有一些附加属性。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025201152849-1821016303.png" alt="img"></p>
<h2 id="VO和AO"><a href="#VO和AO" class="headerlink" title="VO和AO"></a>VO和AO</h2><p>从上面看到，在Execution Context中，会保存变量对象（Variable object，VO），下面就看看变量对象是什么。</p>
<h3 id="变量对象（Variable-object）"><a href="#变量对象（Variable-object）" class="headerlink" title="变量对象（Variable object）"></a>变量对象（Variable object）</h3><p>变量对象是与执行上下文相关的数据作用域。它是一个与上下文相关的特殊对象，其中存储了在上下文中定义的变量和函数声明。也就是说，一般VO中会包含以下信息：</p>
<ul>
<li>变量 (var, Variable Declaration);</li>
<li>函数声明 (Function Declaration, FD);</li>
<li>函数的形参</li>
</ul>
<p>当JavaScript代码运行中，如果试图寻找一个变量的时候，就会首先查找VO。对于前面例子中的代码，Global Execution Context中的VO就可以表示如下：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025201154239-918576092.png" alt="img"></p>
<p><strong>注意，</strong>假如上面的例子代码中有下面两个语句，Global VO仍将不变。</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span>&#123;&#125;) <span class="comment">// function expression, FE</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">baz = <span class="string">"property of global object"</span></span></pre></td></tr></table></figure>

<p>也就是说，对于VO，是有下面两种特殊情况的：</p>
<ul>
<li>函数表达式（与函数声明相对）不包含在VO之中</li>
<li>没有使用var声明的变量（这种变量是，”全局”的声明方式，只是给Global添加了一个属性，并不在VO中）</li>
</ul>
<h3 id="活动对象（Activation-object）"><a href="#活动对象（Activation-object）" class="headerlink" title="活动对象（Activation object）"></a>活动对象（Activation object）</h3><p>只有全局上下文的变量对象允许通过VO的属性名称间接访问；在函数执行上下文中，VO是不能直接访问的，此时由激活对象(Activation Object,缩写为AO)扮演VO的角色。激活对象 是在进入函数上下文时刻被创建的，它通过函数的arguments属性初始化。</p>
<p>Arguments Objects 是函数上下文里的激活对象AO中的内部对象，它包括下列属性：</p>
<ol>
<li>callee：指向当前函数的引用</li>
<li>length： 真正传递的参数的个数</li>
<li>properties-indexes：就是函数的参数值(按参数列表从左到右排列)</li>
</ol>
<p>对于VO和AO的关系可以理解为，VO在不同的Execution Context中会有不同的表现：当在Global Execution Context中，可以直接使用VO；但是，在函数Execution Context中，AO就会被创建。</p>
<p><img src="https://images2015.cnblogs.com/blog/593627/201510/593627-20151025201155177-724394618.png" alt="img"></p>
<p>当上面的例子开始执行outerFunc的时候，就会有一个outerFunc的AO被创建：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025201156317-195051519.png" alt="img"></p>
<p>通过上面的介绍，我们现在了解了VO和AO是什么，以及他们之间的关系了。下面就需要看看JavaScript解释器是怎么执行一段代码，以及设置VO和AO了。</p>
<h2 id="细看Execution-Context"><a href="#细看Execution-Context" class="headerlink" title="细看Execution Context"></a>细看Execution Context</h2><p>当一段JavaScript代码执行的时候，JavaScript解释器会创建Execution Context，其实这里会有两个阶段：</p>
<ul>
<li>创建阶段（当函数被调用，但是开始执行函数内部代码之前）<ul>
<li>创建Scope chain</li>
<li>创建VO/AO（variables, functions and arguments）</li>
<li>设置this的值</li>
</ul>
</li>
<li>激活/代码执行阶段<ul>
<li>设置变量的值、函数的引用，然后解释/执行代码</li>
</ul>
</li>
</ul>
<p>这里想要详细介绍一下”创建VO/AO”中的一些细节，因为这些内容将直接影响代码运行的行为。</p>
<p>对于”创建VO/AO”这一步，JavaScript解释器主要做了下面的事情：</p>
<ul>
<li>根据函数的参数，创建并初始化arguments object</li>
<li>扫描函数内部代码，查找函数声明（Function declaration）<ul>
<li>对于所有找到的函数声明，将函数名和函数引用存入VO/AO中</li>
<li><strong>如果VO/AO中已经有同名的函数，那么就进行覆盖</strong></li>
</ul>
</li>
<li>扫描函数内部代码，查找变量声明（Variable declaration）<ul>
<li>对于所有找到的变量声明，将变量名存入VO/AO中，并初始化为”undefined”</li>
<li>如果变量名称跟已经声明的形式参数或函数相同，则变量声明不会干扰已经存在的这类属性</li>
</ul>
</li>
</ul>
<p>看下面的例子：</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(i)</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> a = <span class="string">'hello'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span> <span class="title">privateB</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">foo(<span class="number">22</span>);</span></pre></td></tr></table></figure>


<p>对于上面的代码，在”创建阶段”，可以得到下面的Execution Context object：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">fooExecutionContext</span> <span class="string">=</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">scopeChain:</span> <span class="string">&#123;</span> <span class="string">...</span> <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">variableObject:</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">arguments:</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attr">0:</span> <span class="number">22</span><span class="string">,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attr">length:</span> <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">i:</span> <span class="number">22</span><span class="string">,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">c:</span> <span class="string">pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">c()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">a:</span> <span class="string">undefined,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">b:</span> <span class="string">undefined</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">this:</span> <span class="string">&#123;</span> <span class="string">...</span> <span class="string">&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr></table></figure>


<p>在”激活/代码执行阶段”，Execution Context object就被更新为：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">fooExecutionContext</span> <span class="string">=</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">scopeChain:</span> <span class="string">&#123;</span> <span class="string">...</span> <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">variableObject:</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">arguments:</span> <span class="string">&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attr">0:</span> <span class="number">22</span><span class="string">,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="attr">length:</span> <span class="number">1</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">i:</span> <span class="number">22</span><span class="string">,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">c:</span> <span class="string">pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">c()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">a:</span> <span class="string">'hello'</span><span class="string">,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="attr">b:</span> <span class="string">pointer</span> <span class="string">to</span> <span class="string">function</span> <span class="string">privateB()</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="string">&#125;,</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="attr">this:</span> <span class="string">&#123;</span> <span class="string">...</span> <span class="string">&#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr></table></figure>


<h2 id="例子分析"><a href="#例子分析" class="headerlink" title="例子分析"></a>例子分析</h2><p>前面介绍了Execution Context，VO/AO等这么多的理论知识，当然是为了方便我们去分析代码中的一些行为。这里，就通过几个简单的例子，结合上面的概念来分析结果。</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h3><p>首先看第一个例子：</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(<span class="name">function</span>()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">baz</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    var bar = <span class="number">20</span><span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    function baz()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        console.log(<span class="string">"baz"</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)()</span></pre></td></tr></table></figure>


<p>在Chrome中运行代码运行后将输出：</p>
<p><img src="https://images2015.cnblogs.com/blog/593627/201510/593627-20151025201157161-1227329780.png" alt="img"></p>
<p>代码解释：匿名函数会首先进入”创建结果”，JavaScript解释器会创建一个”Function Execution Context”，然后创建Scope chain，VO/AO和this。根据前面的介绍，解释器会扫描函数和变量声明，如下的AO会被创建：</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025201158208-1634029739.png" alt="img"></p>
<p>所以，对于bar，我们会得到”undefined”这个输出，表现的行为就是，我们在声明一个变量之前就访问了这个变量。这个就是JavaScript中”Hoisting”。</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h3><p>接着上面的例子，进行一些修改：</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(<span class="name">function</span>()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">baz</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    bar = <span class="number">20</span><span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">window.bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    function baz()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        console.log(<span class="string">"baz"</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)()</span></pre></td></tr></table></figure>


<p>运行这段代码会得到”bar is not defined(…)”错误。当代码执行到”console.log(bar);”的时候，会去AO中查找”bar”。但是，根据前面的解释，函数中的”bar”并没有通过var关键字声明，所有不会被存放在AO中，也就有了这个错误。</p>
<p>注释掉”console.log(bar);”，再次运行代码，可以得到下面结果。”bar”在”激活/代码执行阶段”被创建。</p>
<p><img src="https://images2015.cnblogs.com/blog/593627/201510/593627-20151025201158911-154792588.png" alt="img"></p>
<h3 id="Example-3"><a href="#Example-3" class="headerlink" title="Example 3"></a>Example 3</h3><p>现在来看最后一个例子：</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(<span class="name">function</span>()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">foo</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">baz</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    var foo = function()&#123;&#125;<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    function bar()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        console.log(<span class="string">"bar"</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    var bar = <span class="number">20</span><span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">bar</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    function baz()&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        console.log(<span class="string">"baz"</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;)()</span></pre></td></tr></table></figure>


<p>代码的运行结果为：</p>
<p><img src="/js/%E8%BD%AC-JavaScript%E7%9A%84%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/593627-20151025201159786-722939845.png" alt="img"></p>
<p>代码中，最”奇怪”的地方应该就是”bar”的输出了，第一次是一个函数，第二次是”20”。</p>
<p>其实也很好解释，回到前面对”创建VO/AO”的介绍，在创建VO/AO过程中，解释器会先扫描函数声明，然后”foo: <function>“就被保存在了AO中；但解释器扫描变量声明的时候，虽然发现”var bar = 20;”，但是因为”foo”在AO中已经存在，所以就没有任何操作了。</function></p>
<p>但是，当代码执行到第二句”console.log(bar);”的时候，”激活/代码执行阶段”已经把AO中的”bar”重新设置了。</p>
<blockquote>
<p>下面是自己理解的 函数内部上下文执行流程图</p>
</blockquote>
<p>![JavaScript的执行上下文（函数内部的执行流程Execution Context）](<a href="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/JavaScript的执行上下文（函数内部的执行流程Execution" target="_blank" rel="noopener">https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/JavaScript的执行上下文（函数内部的执行流程Execution</a> Context）.png)</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文介绍了JavaScript中的执行上下文（Execution Context），以及VO/AO等概念，最后通过几个例子展示了这几个概念对我们了解JavaScript代码运行的重要性。</p>
<p>通过对VO/AO在”创建阶段”的具体细节，如何扫描函数声明和变量声明，就可以对JavaScript中的”Hoisting”有清晰的认识。所以说，了解JavaScript解释器的行为，以及相关的概念，对理解JavaScript代码的行为是很有帮助的。</p>
<p>后面会对Execution Context中的Scope chain和this进行介绍。</p>
<h1 id="理解JavaScript的作用域链"><a href="#理解JavaScript的作用域链" class="headerlink" title="理解JavaScript的作用域链"></a>理解JavaScript的作用域链</h1><p>上一篇文章中介绍了Execution Context中的三个重要部分：VO/AO，scope chain和this，并详细的介绍了VO/AO在JavaScript代码执行中的表现。</p>
<p>本文就看看Execution Context中的scope chain。</p>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>开始介绍作用域链之前，先看看JavaScript中的作用域（scope）。在很多语言中（C++，C#，Java），作用域都是通过代码块（由{}包起来的代码）来决定的，<strong>但是，在JavaScript作用域是跟函数相关的，也可以说成是function-based。</strong></p>
<p>例如，当for循环这个代码块结束后，依然可以访问变量”i”。</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">for(<span class="name">var</span> i = <span class="number">0</span><span class="comment">; i &lt; 3; i++)&#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">    console.log(<span class="name">i</span>)<span class="comment">;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">console.log(<span class="name">i</span>)<span class="comment">; //3</span></span></pre></td></tr></table></figure>

<p>对于作用域，又可以分为全局作用域（Global scope）和局部作用域（Local scpoe）。</p>
<p><strong>全局作用域</strong>中的对象可以在代码的任何地方访问，一般来说，下面情况的对象会在全局作用域中：</p>
<ul>
<li>最外层函数和在最外层函数外面定义的变量</li>
<li>没有通过关键字”var”声明的变量</li>
<li>浏览器中，window对象的属性</li>
</ul>
<p><strong>局部作用域</strong>又被称为函数作用域（Function scope），所有的变量和函数只能在作用域内部使用。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">1</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.bar = <span class="number">2</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    a = <span class="number">3</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> b = <span class="number">4</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Global scope: foo, bar, baz, a </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Local scope: b</span></span></pre></td></tr></table></figure>


<h2 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h2><p>通过前面一篇文章了解到，每一个Execution Context中都有一个VO，用来存放变量，函数和参数等信息。</p>
<p>在JavaScript代码运行中，所有用到的变量都需要去当前AO/VO中查找，当找不到的时候，就会继续查找上层Execution Context中的AO/VO。这样一级级向上查找的过程，就是所有Execution Context中的AO/VO组成了一个作用域链。</p>
<p>所以说，<strong>作用域链</strong>与一个执行上下文相关，是内部上下文所有变量对象（包括父变量对象）的列表，用于变量查询。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Scope</span> = VO/AO + <span class="keyword">All</span> Parent VO/AOs</span></pre></td></tr></table></figure>

<p>看一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> y = <span class="number">20</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> z = <span class="number">30</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">       </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(x + y + z);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    bar()</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">foo();</span></pre></td></tr></table></figure>


<p>上面代码的输出结果为”60”，函数bar可以直接访问”z”，然后通过作用域链访问上层的”x”和”y”。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202341552-94941711.png" alt="img"></p>
<ul>
<li>绿色箭头指向VO/AO</li>
<li>蓝色箭头指向scope chain（VO/AO + All Parent VO/AOs）</li>
</ul>
<p>再看一个比较典型的例子：</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">var</span> <span class="class"><span class="keyword">data</span> = [];</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="title">for</span>(var i = <span class="number">0</span> ; i &lt; <span class="number">3</span>; i++)&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="class"><span class="keyword">data</span>[i]=function() &#123;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class">        <span class="title">console</span>.<span class="title">log</span>(<span class="title">i</span>);</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class">    &#125;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span>[0]();// 3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span>[1]();// 3</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">data</span>[2]();// 3</span></span></pre></td></tr></table></figure>


<p>第一感觉（错觉）这段代码会输出”0，1，2”。但是根据前面的介绍，变量”i”是存放在”Global VO”中的变量，循环结束后”i”的值就被设置为3，所以代码最后的三次函数调用访问的是相同的”Global VO”中已经被更新的”i”。</p>
<h2 id="结合作用域链看闭包"><a href="#结合作用域链看闭包" class="headerlink" title="结合作用域链看闭包"></a>结合作用域链看闭包</h2><p>在JavaScript中，闭包跟作用域链有紧密的关系。相信大家对下面的闭包例子一定非常熟悉，代码中通过闭包实现了一个简单的计数器。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">var</span> x = <span class="number">0</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        increase: <span class="function"><span class="keyword">function</span> <span class="title">increase</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> ++x; &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        decrease: <span class="function"><span class="keyword">function</span> <span class="title">decrease</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> --x; &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ctor = counter();</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(ctor.increase());</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(ctor.decrease());</span></pre></td></tr></table></figure>


<p>下面我们就通过Execution Context和scope chain来看看在上面闭包代码执行中到底做了哪些事情。</p>
<p>\1. 当代码进入Global Context后，会创建Global VO</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202343192-1736899039.png" alt="img"></p>
<ul>
<li>绿色箭头指向VO/AO</li>
<li>蓝色箭头指向scope chain（VO/AO + All Parent VO/AOs）</li>
</ul>
<p>\2. 当代码执行到”var cter = counter();”语句的时候，进入counter Execution Context；根据上一篇文章的介绍，这里会创建counter AO，并设置counter Execution Context的scope chain</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202345224-1059314508.png" alt="img"></p>
<p>\3. 当counter函数执行的最后，并退出的时候，Global VO中的ctor就会被设置；这里需要注意的是，虽然counter Execution Context退出了执行上下文栈，但是因为ctor中的成员仍然引用counter AO（因为counter AO是increase和decrease函数的parent scope），所以counter AO依然在Scope中。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202347208-254025968.png" alt="img"></p>
<p>\4. 当执行”ctor.increase()”代码的时候，代码将进入ctor.increase Execution Context，并为该执行上下文创建VO/AO，scope chain和设置this；这时，ctor.increase AO将指向counter AO。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202349224-1554337822.png" alt="img"></p>
<ul>
<li>绿色箭头指向VO/AO</li>
<li>蓝色箭头指向scope chain（VO/AO + All Parent VO/AOs）</li>
<li>红色箭头指向this</li>
<li>黑色箭头指向parent VO/AO</li>
</ul>
<p>相信看到这些，一定会对JavaScript闭包有了比较清晰的认识，也了解为什么counter Execution Context退出了执行上下文栈，但是counter AO没有销毁，可以继续访问。</p>
<h2 id="二维作用域链查找"><a href="#二维作用域链查找" class="headerlink" title="二维作用域链查找"></a>二维作用域链查找</h2><p>通过上面了解到，作用域链（scope chain）的主要作用就是用来进行变量查找。但是，在JavaScript中还有原型链（prototype chain）的概念。</p>
<p>由于作用域链和原型链的相互作用，这样就形成了一个二维的查找。</p>
<p>对于这个二维查找可以总结为：<strong>当代码需要查找一个属性（property）或者描述符（identifier）的时候，首先会通过作用域链（scope chain）来查找相关的对象；一旦对象被找到，就会根据对象的原型链（prototype chain）来查找属性（property）</strong>。</p>
<p>下面通过一个例子来看看这个二维查找：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = &#123;&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">Object</span>.prototype.a = <span class="string">'Set foo.a from prototype'</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(foo.a);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">baz()(); </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Set bar.a from prototype</span></span></pre></td></tr></table></figure>


<p>对于这个例子，可以通过下图进行解释，代码首先通过作用域链（scope chain）查找”foo”，最终在Global context中找到；然后因为”foo”中没有找到属性”a”，将继续沿着原型链（prototype chain）查找属性”a”。</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/593627-20151025202351395-1888858218.png" alt="img"></p>
<ul>
<li>蓝色箭头表示作用域链查找</li>
<li>橘色箭头表示原型链查找</li>
</ul>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>本文介绍了JavaScript中的作用域以及作用域链，通过作用域链分析了闭包的执行过程，进一步认识了JavaScript的闭包。</p>
<p>同时，结合原型链，演示了JavaScript中的描述符和属性的查找。</p>
<p>下一篇我们就看看Execution Context中的this属性。</p>
<h1 id="JavaScript中的this"><a href="#JavaScript中的this" class="headerlink" title="JavaScript中的this"></a>JavaScript中的this</h1><p>前面两篇文章介绍了JavaScript执行上下文中两个重要属性：VO/AO和scope chain。本文就来看看执行上下文中的this。</p>
<p>首先看看下面两个对this的概括：</p>
<ul>
<li><strong>this是执行上下文（Execution Context）的一个重要属性</strong>，是一个与执行上下文相关的特殊对象。因此，它可以叫作上下文对象（也就是用来指明执行上下文是在哪个上下文中被触发的对象）。</li>
<li><strong>this不是变量对象（Variable Object）的一个属性</strong>，所以跟变量不同，this从不会参与到标识符解析过程。也就是说，在代码中当访问this的时候，它的值是直接从执行上下文中获取的，并不需要任何作用域链查找。this的值只在进入上下文的时候进行一次确定。</li>
</ul>
<p>关于this最困惑的应该是，同一个函数，当在不同的上下文进行调用的时候，this的值就可能会不同。也就是说，this的值是通过函数调用表达式（也就是函数被调用的方式）的caller所提供的。</p>
<p>下面就看看在不同场景中，this的值。</p>
<h2 id="全局上下文"><a href="#全局上下文" class="headerlink" title="全局上下文"></a>全局上下文</h2><p>在全局上下文（Global Context）中，this总是global object，在浏览器中就是window对象。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span> === <span class="built_in">window</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.name = <span class="string">"Will"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.age = <span class="number">28</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.getInfo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">" is "</span> + <span class="keyword">this</span>.age + <span class="string">" years old"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.getInfo();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// true</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Will is 28 years old</span></span></pre></td></tr></table></figure>


<h2 id="函数上下文"><a href="#函数上下文" class="headerlink" title="函数上下文"></a>函数上下文</h2><p>在一个函数中，this的情况就比较多了，this的值直接受函数调用方式的影响。</p>
<h3 id="Invoke-function-as-Function"><a href="#Invoke-function-as-Function" class="headerlink" title="Invoke function as Function"></a>Invoke function as Function</h3><p>当通过正常的方式调用一个函数的时候，this的值就会被设置为global object（浏览器中的window对象）。</p>
<p>但是，当使用”strict mode”执行下面代码的时候，this就会被设置为”undefined”。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gFunc</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(gFunc());</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span> === <span class="built_in">window</span>.gFunc());</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// window</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// true</span></span></pre></td></tr></table></figure>


<h3 id="Invoke-function-as-Method"><a href="#Invoke-function-as-Method" class="headerlink" title="Invoke function as Method"></a>Invoke function as Method</h3><p>当函数作为一个对象方法来执行的时候，this的值就是该方法所属的对象。</p>
<p>在下面的例子中，创建了一个obj对象，并设置name属性的值为”obj”。所以但调用该对象的func方法的时候，方法中的this就表示obj这个对象。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"obj"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">func</span>: <span class="title">function</span> <span class="params">()</span></span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        console.log(this + <span class="string">":"</span> + this.name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">obj<span class="function">.<span class="keyword">func</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// [object Object]:obj</span></span></pre></td></tr></table></figure>


<p>为了验证”方法中的this代表方法所属的对象”这句话，再看下面一个例子。</p>
<p>在对象obj中，创建了一个内嵌对象nestedObj，当调用内嵌对象的方法的时候，方法中的this就代表nestedObj。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"obj"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    nestedObj: &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        name:<span class="string">"nestedObj"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="function"><span class="keyword">func</span>: <span class="title">function</span> <span class="params">()</span></span> &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            console.log(this + <span class="string">":"</span> + this.name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;            </span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">obj.nestedObj<span class="function">.<span class="keyword">func</span><span class="params">()</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// [object Object]:nestedObj</span></span></pre></td></tr></table></figure>


<p>对于上面例子中的方法，通常称为绑定方法，也就是说这些方法都是个特定的对象关联的。</p>
<p>但是，当我们进行下面操作的时候，temp将是一个全局作用里面的函数，并没有绑定到obj对象上。所以，temp中的this表示的是window对象。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"Will"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"obj"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    func: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">temp = obj.func;</span></pre></td></tr><tr><td class="code"><pre><span class="line">temp();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">//  [object Window]:Will</span></span></pre></td></tr></table></figure>


<h3 id="Invoke-function-as-Constructor"><a href="#Invoke-function-as-Constructor" class="headerlink" title="Invoke function as Constructor"></a>Invoke function as Constructor</h3><p>在JavaScript中，函数可以作为构造器来直接创建对象，在这种情况下，this就代表了新建的对象。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Staff</span>(<span class="params">name, age</span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.name = name;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.age = age;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="keyword">this</span>.getInfo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">" is "</span> + <span class="keyword">this</span>.age + <span class="string">" years old"</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> will = <span class="keyword">new</span> Staff(<span class="string">"Will"</span>, <span class="number">28</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">will.getInfo();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Will is 28 years old</span></span></pre></td></tr></table></figure>


<h3 id="Invoke-context-less-function"><a href="#Invoke-context-less-function" class="headerlink" title="Invoke context-less function"></a>Invoke context-less function</h3><p>对于有些没有上下文的函数，也就是说这些函数没有绑定到特定的对象上，那么这些上下文无关的函数将会被默认的绑定到global object上。</p>
<p>在这个例子中，函数f和匿名函数表达式在被调用的过程中并没有被关联到任何对象，所以他们的this都代表global object。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> context = <span class="string">"global"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">    context: <span class="string">"object"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    method: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);</span></pre></td></tr><tr><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context); </span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        f(); </span></pre></td></tr><tr><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="code"><pre><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context); </span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;)();</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">obj.method();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// [object Object]:object</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// [object Window]:global</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// [object Window]:global</span></span></pre></td></tr></table></figure>


<h2 id="call-apply-bind改变this"><a href="#call-apply-bind改变this" class="headerlink" title="call/apply/bind改变this"></a>call/apply/bind改变this</h2><p>this本身是不可变的，但是 JavaScript中提供了call/apply/bind三个函数来在函数调用时设置this的值。</p>
<p>这三个函数的原型如下：</p>
<ul>
<li>fun.apply(obj1 [, argsArray])<ul>
<li>Sets obj1 as the value of this inside fun() and calls fun() passing elements of argsArray as its arguments.</li>
</ul>
</li>
<li>fun.call(obj1 [, arg1 [, arg2 [,arg3 [, …]]]])<ul>
<li>Sets obj1 as the value of this inside fun() and calls fun() passing arg1, arg2, arg3, … as its arguments.</li>
</ul>
</li>
<li>fun.bind(obj1 [, arg1 [, arg2 [,arg3 [, …]]]])<ul>
<li>Returns the reference to the function fun with this inside fun() bound to obj1 and parameters of fun bound to the parameters specified arg1, arg2, arg3, ….</li>
</ul>
</li>
</ul>
<p>下面看一个简单的例子：</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(numA, numB)</span><span class="comment">&#123;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="comment">    console.log( this.original + numA + numB);</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="comment">&#125;</span></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"></span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">add</span><span class="params">(1, 2)</span>;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="comment">&#123;original: 10&#125;</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">add</span>.apply(obj, [<span class="number">1</span>, <span class="number">2</span>]);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">add</span>.call(obj, <span class="number">1</span>, <span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f1 = <span class="keyword">add</span>.bind(obj);</span></pre></td></tr><tr><td class="code"><pre><span class="line">f1(<span class="number">2</span>, <span class="number">3</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> f2 = <span class="keyword">add</span>.bind(obj, <span class="number">2</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">f2(<span class="number">3</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// NaN</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 13</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 13</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 15</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// 15</span></span></pre></td></tr></table></figure>


<p>当直接调用add函数的时候，this将代表window，当执行”this.original”的时候，由于window对象并没有”original”属性，所以会得到”undefined”。</p>
<p>通过call/apply/bind，达到的效果就是把add函数绑定到了obj对象上，当调用add的时候，this就代表了obj这个对象。</p>
<h2 id="DOM-event-handler"><a href="#DOM-event-handler" class="headerlink" title="DOM event handler"></a>DOM event handler</h2><p>当一个函数被当作event handler的时候，this会被设置为触发事件的页面元素（element）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> body = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>];</span></pre></td></tr><tr><td class="code"><pre><span class="line">body.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;body&gt;…&lt;/body&gt;</span></span></pre></td></tr></table></figure>

<h3 id="In-line-event-handler"><a href="#In-line-event-handler" class="headerlink" title="In-line event handler"></a>In-line event handler</h3><p>当代码通过in-line handler执行的时候，this同样指向拥有该handler的页面元素。</p>
<p>看下面的代码：</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line">document.write(<span class="string">'&lt;button onclick="</span>console.<span class="built_in">log</span>(this)<span class="string">"&gt;Show this&lt;/button&gt;'</span>);</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;button onclick="console.log(this)"&gt;Show this&lt;/button&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">document.write(<span class="string">'&lt;button onclick="</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// window</span></span></pre></td></tr></table></figure>

<p>在第一行代码中，正如上面in-line handler所描述的，this将指向”button”这个element。但是，对于第二行代码中的匿名函数，是一个上下文无关（context-less）的函数，所以this会被默认的设置为window。</p>
<p>前面我们已经介绍过了bind函数，所以，通过下面的修改就能改变上面例子中第二行代码的行为：</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line">document.write(<span class="string">'&lt;button onclick="</span>((<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;).<span class="title">bind</span><span class="params">(this)</span>)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// &lt;button onclick="((function()&#123;console.log(this);&#125;).bind(this))()"&gt;Show this&lt;/button&gt;</span></span></pre></td></tr></table></figure>

<h2 id="保存this"><a href="#保存this" class="headerlink" title="保存this"></a>保存this</h2><p>在JavaScript代码中，同一个上下文中可能会出现多个this，为了使用外层的this，就需要对this进行暂存了。</p>
<p>看下面的例子，根据前面的介绍，在body元素的click handler中，this肯定是指向body这个元素，所以为了使用”greeting”这个方法，就是要对指向bar对象的this进行暂存，这里用了一个self变量。</p>
<p>有了self，我们就可以在click handler中使用bar对象的”greeting”方法了。</p>
<p>当阅读一些JavaScript库代码的时候，如果遇到类似self，me，that的时候，他们可能就是对this的暂存。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"bar"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            self.greeting();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="code"><pre><span class="line">bar.anotherMethod();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Hi there, I'm [object Object]:bar</span></span></pre></td></tr></table></figure>


<p>同样，对于上面的例子，也可以使用bind来设置this达到相同的效果。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">    name: <span class="string">"bar"</span>,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;,</span></pre></td></tr><tr><td class="code"><pre><span class="line">    </span></pre></td></tr><tr><td class="code"><pre><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></pre></td></tr><tr><td class="code"><pre><span class="line">            <span class="keyword">this</span>.greeting();</span></pre></td></tr><tr><td class="code"><pre><span class="line">        &#125;).bind(<span class="keyword">this</span>));</span></pre></td></tr><tr><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&#125;;</span></pre></td></tr><tr><td class="code"><pre><span class="line">  </span></pre></td></tr><tr><td class="code"><pre><span class="line">bar.anotherMethod();</span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment">// Hi there, I'm [object Object]:bar</span></span></pre></td></tr></table></figure>


<h2 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h2><p>本文介绍了执行上下文中的this属性，this的值直接影响着代码的运行结果。</p>
<p>在函数调用中，this是由激活上下文代码的调用者（caller）来提供的，即调用函数的父上下文(parent context )，也就是说this取决于调用函数的方式，指向调用时所在函数所绑定的对象。</p>
<p>通过上面的介绍，相信对this有了一定的认识。</p>
<h2 id="自己的话总体总结"><a href="#自己的话总体总结" class="headerlink" title="自己的话总体总结"></a>自己的话总体总结</h2><ul>
<li><p>执行上下文 Execution context   自己的理解就是作用域对象 ：全局作用域 和 局部作用域</p>
<ul>
<li>包含的重要属性：<ul>
<li>变量对象（Variable object，VO）</li>
<li>作用域链（Scope chain）</li>
<li>this</li>
</ul>
</li>
<li>创建阶段（当函数被调用，但是开始执行函数内部代码之前）<ul>
<li>创建Scope chain</li>
<li>创建VO/AO（variables, functions and arguments）<ul>
<li>扫描函数内部代码，查找函数声明（Function declaration）</li>
<li>扫描函数内部代码，查找变量声明（Variable declaration）包含 函数的形参</li>
</ul>
</li>
<li>设置this的值</li>
</ul>
</li>
<li>激活/代码执行阶段<ul>
<li>设置变量的值、函数的引用，然后解释/执行代码</li>
</ul>
</li>
</ul>
</li>
<li><p>作用域链 scope chain  就是当前作用域的VO/AO没有的变量，就向上查找VO/AO一直到全局作用域Global scope的VO</p>
</li>
<li><p>闭包 是作用域链的应用 ：当有下级作用域使用当前作用域内的变量 ，当前作用域执行结束后变量不会被销毁</p>
</li>
<li><p>this 是 当前执行上下文被哪个执行上下文调用  谁调用就指向谁</p>
<ul>
<li>函数直接调用  fn() 指向 全局对象 global 浏览器中是window</li>
<li>对象调用 obj.fn() 哪个对象调用指向就指向谁</li>
<li>dom事件 onclick = fn 指向对应的dom</li>
<li>构造函数  new Fn() 指向实例对象</li>
<li>call,bind,apply, fn.call(obj) 第一个参数是谁就指向谁</li>
</ul>
</li>
</ul>
<h1 id="JavaScript中的函数表达式"><a href="#JavaScript中的函数表达式" class="headerlink" title="JavaScript中的函数表达式"></a>JavaScript中的函数表达式</h1>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>-js</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux命令入门</title>
    <url>/Linux/Linux%E5%91%BD%E4%BB%A4%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<blockquote>
<p>本文汇总了 本人学习  <code>Linux入门</code> 的所有教程</p>
</blockquote>
<h1 id="常用-Linux-命令的基本使用"><a href="#常用-Linux-命令的基本使用" class="headerlink" title="常用 Linux 命令的基本使用"></a>常用 Linux 命令的基本使用</h1><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ul>
<li>理解学习 Linux 终端命令的原因</li>
<li>常用 Linux 命令体验</li>
</ul>
<h2 id="01-学习-Linux-终端命令的原因"><a href="#01-学习-Linux-终端命令的原因" class="headerlink" title="01. 学习 Linux 终端命令的原因"></a>01. 学习 Linux 终端命令的原因</h2><ul>
<li>Linux 刚面世时并没有图形界面，所有的操作全靠命令完成，如 <strong>磁盘操作</strong>、<strong>文件存取</strong>、<strong>目录操作</strong>、<strong>进程管理</strong>、<strong>文件权限</strong> 设定等</li>
<li>在职场中，大量的 <strong>服务器维护工作</strong> 都是在 <strong>远程</strong> 通过 <strong>SSH 客户端</strong> 来完成的，并没有图形界面，所有的维护工作都需要通过命令来完成</li>
<li>在职场中，作为后端程序员，必须要或多或少的掌握一些 Linux 常用的终端命令</li>
<li>Linux 发行版本的命令大概有 200 多个，但是常用的命令只有 10 多个而已</li>
</ul>
<blockquote>
<p>学习终端命令的技巧：</p>
<ul>
<li>不需要死记硬背，对于常用命令，用的多了，自然就记住了</li>
<li>不要尝试一次学会所有的命令，有些命令是非常不常用的，临时遇到，临时百度就可以</li>
</ul>
</blockquote>
<h2 id="02-常用-Linux-命令的基本使用"><a href="#02-常用-Linux-命令的基本使用" class="headerlink" title="02. 常用 Linux 命令的基本使用"></a>02. 常用 Linux 命令的基本使用</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>ls</td>
<td>list</td>
<td>查看当前文件夹下的内容</td>
</tr>
<tr>
<td>02</td>
<td>pwd</td>
<td>print work directory</td>
<td>查看当前所在文件夹</td>
</tr>
<tr>
<td>03</td>
<td>cd [目录名]</td>
<td>change directory</td>
<td>切换文件夹</td>
</tr>
<tr>
<td>04</td>
<td>touch [文件名]</td>
<td>touch</td>
<td>如果文件不存在，新建文件</td>
</tr>
<tr>
<td>05</td>
<td>mkdir [目录名]</td>
<td>make directory</td>
<td>创建目录</td>
</tr>
<tr>
<td>06</td>
<td>rm [文件名]</td>
<td>remove</td>
<td>删除指定的文件名</td>
</tr>
<tr>
<td>07</td>
<td>clear</td>
<td>clear</td>
<td>清屏</td>
</tr>
</tbody></table>
<blockquote>
<p>小技巧</p>
<ul>
<li><code>ctrl + shift + =</code> <strong>放大</strong>终端窗口的字体显示</li>
<li><code>ctrl + -</code> <strong>缩小</strong>终端窗口的字体显示</li>
</ul>
</blockquote>
<h3 id="03-自动补全"><a href="#03-自动补全" class="headerlink" title="03. 自动补全"></a>03. 自动补全</h3><ul>
<li>在敲出 <code>文件</code>／<code>目录</code>／<code>命令</code> 的前几个字母之后，按下 <code>tab</code> 键<ul>
<li>如果输入的没有歧义，系统会自动补全</li>
<li>如果还存在其他 <code>文件</code>／<code>目录</code>／<code>命令</code>，再按一下 <code>tab</code> 键，系统会提示可能存在的命令</li>
</ul>
</li>
</ul>
<blockquote>
<p>小技巧</p>
<ul>
<li>按 <code>上</code>／<code>下</code> 光标键可以在曾经使用过的命令之间来回切换</li>
<li>如果想要退出选择，并且不想执行当前选中的命令，可以按 <code>ctrl + c</code></li>
</ul>
</blockquote>
<h1 id="Linux-终端命令格式"><a href="#Linux-终端命令格式" class="headerlink" title="Linux 终端命令格式"></a>Linux 终端命令格式</h1><h2 id="目标-1"><a href="#目标-1" class="headerlink" title="目标"></a>目标</h2><ul>
<li>了解终端命令格式</li>
<li>知道如何查阅终端命令帮助信息</li>
</ul>
<h2 id="01-终端命令格式"><a href="#01-终端命令格式" class="headerlink" title="01. 终端命令格式"></a>01. 终端命令格式</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">command</span> [-options] [parameter]</span></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li><code>command</code>：命令名，相应功能的英文单词或单词的缩写</li>
<li><code>[-options]</code>：选项，可用来对命令进行控制，也可以省略</li>
<li><code>parameter</code>：传给命令的参数，可以是 <strong>零个</strong>、<strong>一个</strong> 或者 <strong>多个</strong></li>
</ul>
<blockquote>
<p><code>[]</code> 代表可选 </p>
</blockquote>
<h2 id="02-查阅命令帮助信息（知道）"><a href="#02-查阅命令帮助信息（知道）" class="headerlink" title="02. 查阅命令帮助信息（知道）"></a>02. 查阅命令帮助信息（知道）</h2><blockquote>
<p>提示</p>
<ul>
<li>现阶段只需要 <strong>知道</strong> 通过以下两种方式可以查询命令的帮助信息</li>
<li>先学习<strong>常用命令</strong>及<strong>常用选项</strong>的使用即可，工作中如果遇到问题可以借助 <strong>网络搜索</strong></li>
</ul>
</blockquote>
<h3 id="2-1-help"><a href="#2-1-help" class="headerlink" title="2.1 --help"></a>2.1 <code>--help</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">command</span> --<span class="built_in">help</span></span></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li>显示 <code>command</code> 命令的帮助信息</li>
</ul>
<h3 id="2-2-man"><a href="#2-2-man" class="headerlink" title="2.2 man"></a>2.2 man</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">man <span class="built_in">command</span></span></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li>查阅 <code>command</code> 命令的使用手册</li>
</ul>
<blockquote>
<p><code>man</code> 是 <strong>manual</strong> 的缩写，是 Linux 提供的一个 <strong>手册</strong>，包含了绝大部分的命令、函数的详细使用说明</p>
</blockquote>
<p>使用 <code>man</code> 时的操作键：</p>
<table>
<thead>
<tr>
<th>操作键</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>空格键</td>
<td>显示手册页的下一屏</td>
</tr>
<tr>
<td>Enter 键</td>
<td>一次滚动手册页的一行</td>
</tr>
<tr>
<td>b</td>
<td>回滚一屏</td>
</tr>
<tr>
<td>f</td>
<td>前滚一屏</td>
</tr>
<tr>
<td>q</td>
<td>退出</td>
</tr>
<tr>
<td>/word</td>
<td>搜索 <strong>word</strong> 字符串</td>
</tr>
</tbody></table>
<h1 id="文件和目录常用命令"><a href="#文件和目录常用命令" class="headerlink" title="文件和目录常用命令"></a>文件和目录常用命令</h1><h2 id="目标-2"><a href="#目标-2" class="headerlink" title="目标"></a>目标</h2><ul>
<li>查看目录内容<ul>
<li><code>ls</code></li>
</ul>
</li>
<li>切换目录<ul>
<li><code>cd</code></li>
</ul>
</li>
<li>创建和删除操作<ul>
<li><code>touch</code></li>
<li><code>rm</code></li>
<li><code>mkdir</code></li>
</ul>
</li>
<li>拷贝和移动文件<ul>
<li><code>cp</code></li>
<li><code>mv</code></li>
</ul>
</li>
<li>查看文件内容<ul>
<li><code>cat</code></li>
<li><code>more</code></li>
<li><code>grep</code></li>
</ul>
</li>
<li>其他<ul>
<li><code>echo</code></li>
<li>重定向 <code>&gt;</code> 和 <code>&gt;&gt;</code></li>
<li>管道 <code>|</code></li>
</ul>
</li>
</ul>
<h2 id="01-查看目录内容"><a href="#01-查看目录内容" class="headerlink" title="01. 查看目录内容"></a>01. 查看目录内容</h2><h3 id="1-1-终端实用技巧"><a href="#1-1-终端实用技巧" class="headerlink" title="1.1 终端实用技巧"></a>1.1 终端实用技巧</h3><h4 id="1-gt-自动补全"><a href="#1-gt-自动补全" class="headerlink" title="1&gt; 自动补全"></a>1&gt; 自动补全</h4><ul>
<li>在敲出 <code>文件</code>／<code>目录</code>／<code>命令</code> 的前几个字母之后，按下 <code>tab</code> 键<ul>
<li>如果输入的没有歧义，系统会自动补全</li>
<li>如果还存在其他 <code>文件</code>／<code>目录</code>／<code>命令</code>，再按一下 <code>tab</code> 键，系统会提示可能存在的命令</li>
</ul>
</li>
</ul>
<h4 id="2-gt-曾经使用过的命令"><a href="#2-gt-曾经使用过的命令" class="headerlink" title="2&gt; 曾经使用过的命令"></a>2&gt; 曾经使用过的命令</h4><ul>
<li>按 <code>上</code>／<code>下</code> 光标键可以在曾经使用过的命令之间来回切换</li>
<li>如果想要退出选择，并且不想执行当前选中的命令，可以按 <code>ctrl + c</code></li>
</ul>
<h3 id="1-2-ls-命令说明"><a href="#1-2-ls-命令说明" class="headerlink" title="1.2 ls 命令说明"></a>1.2 <code>ls</code> 命令说明</h3><ul>
<li><code>ls</code> 是英文单词 <strong>list</strong> 的简写，其功能为列出目录的内容，是用户最常用的命令之一，类似于 <strong>DOS</strong> 下的 <code>dir</code> 命令</li>
</ul>
<h4 id="Linux-下文件和目录的特点"><a href="#Linux-下文件和目录的特点" class="headerlink" title="Linux 下文件和目录的特点"></a>Linux 下文件和目录的特点</h4><ul>
<li>Linux <strong>文件</strong> 或者 <strong>目录</strong> 名称最长可以有 <code>256</code> 个字符</li>
<li>以 <code>.</code> 开头的文件为隐藏文件，需要用 -a 参数才能显示</li>
<li><strong>.</strong> 代表当前目录</li>
<li><strong>..</strong> 代表上一级目录</li>
</ul>
<h3 id="1-3-ls-常用选项"><a href="#1-3-ls-常用选项" class="headerlink" title="1.3 ls 常用选项"></a>1.3 ls 常用选项</h3><table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示指定目录下所有子目录与文件，包括隐藏文件</td>
</tr>
<tr>
<td>-l</td>
<td>以列表方式显示文件的详细信息</td>
</tr>
<tr>
<td>-h</td>
<td>配合 -l 以人性化的方式显示文件大小</td>
</tr>
</tbody></table>
<h4 id="计算机中文件大小的表示方式（科普）"><a href="#计算机中文件大小的表示方式（科普）" class="headerlink" title="计算机中文件大小的表示方式（科普）"></a>计算机中文件大小的表示方式（科普）</h4><table>
<thead>
<tr>
<th>单位</th>
<th>英文</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>字节</td>
<td>B（Byte）</td>
<td>在计算机中作为一个数字单元，一般为 8 位二进制数</td>
</tr>
<tr>
<td>千</td>
<td>K（Kibibyte）</td>
<td>1 KB = 1024 B，千字节 （1024 = 2 ** 10）</td>
</tr>
<tr>
<td>兆</td>
<td>M（Mebibyte）</td>
<td>1 MB = 1024 KB，百万字节</td>
</tr>
<tr>
<td>千兆</td>
<td>G（Gigabyte）</td>
<td>1 GB = 1024 MB，十亿字节，千兆字节</td>
</tr>
<tr>
<td>太</td>
<td>T（Terabyte）</td>
<td>1 TB = 1024 GB，万亿字节，太字节</td>
</tr>
<tr>
<td>拍</td>
<td>P（Petabyte）</td>
<td>1 PB = 1024 TB，千万亿字节，拍字节</td>
</tr>
<tr>
<td>艾</td>
<td>E（Exabyte）</td>
<td>1 EB = 1024 PB，百亿亿字节，艾字节</td>
</tr>
<tr>
<td>泽</td>
<td>Z（Zettabyte）</td>
<td>1 ZB = 1024 EB，十万亿亿字节，泽字节</td>
</tr>
<tr>
<td>尧</td>
<td>Y（Yottabyte）</td>
<td>1 YB = 1024 ZB，一亿亿亿字节，尧字节</td>
</tr>
</tbody></table>
<h3 id="1-4-ls-通配符的使用"><a href="#1-4-ls-通配符的使用" class="headerlink" title="1.4 ls 通配符的使用"></a>1.4 ls 通配符的使用</h3><table>
<thead>
<tr>
<th>通配符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>代表任意个数个字符</td>
</tr>
<tr>
<td>?</td>
<td>代表任意一个字符，至少 1 个</td>
</tr>
<tr>
<td>[]</td>
<td>表示可以匹配字符组中的任一一个</td>
</tr>
<tr>
<td>[abc]</td>
<td>匹配 a、b、c 中的任意一个</td>
</tr>
<tr>
<td>[a-f]</td>
<td>匹配从 a 到 f 范围内的的任意一个字符</td>
</tr>
</tbody></table>
<h2 id="02-切换目录"><a href="#02-切换目录" class="headerlink" title="02. 切换目录"></a>02. 切换目录</h2><h3 id="2-1-cd"><a href="#2-1-cd" class="headerlink" title="2.1 cd"></a>2.1 <code>cd</code></h3><ul>
<li><code>cd</code> 是英文单词 <strong>change directory</strong> 的简写，其功能为更改当前的工作目录，也是用户最常用的命令之一</li>
</ul>
<blockquote>
<p>注意：Linux 所有的 <strong>目录</strong> 和 <strong>文件名</strong> 都是大小写敏感的</p>
</blockquote>
<table>
<thead>
<tr>
<th>命令</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>cd</td>
<td>切换到当前用户的主目录(/home/用户目录)</td>
</tr>
<tr>
<td>cd ~</td>
<td>切换到当前用户的主目录(/home/用户目录)</td>
</tr>
<tr>
<td>cd .</td>
<td>保持在当前目录不变</td>
</tr>
<tr>
<td>cd ..</td>
<td>切换到上级目录</td>
</tr>
<tr>
<td>cd -</td>
<td>可以在最近两次工作目录之间来回切换</td>
</tr>
</tbody></table>
<h3 id="2-2-相对路径和绝对路径"><a href="#2-2-相对路径和绝对路径" class="headerlink" title="2.2 相对路径和绝对路径"></a>2.2 相对路径和绝对路径</h3><ul>
<li><strong>相对路径</strong> 在输入路径时，最前面不是 <strong>/</strong> 或者 <strong>~</strong>，表示相对 <strong>当前目录</strong> 所在的目录位置</li>
<li><strong>绝对路径</strong> 在输入路径时，最前面是 <strong>/</strong> 或者 <strong>~</strong>，表示从 <strong>根目录/家目录</strong> 开始的具体目录位置</li>
</ul>
<h2 id="03-创建和删除操作"><a href="#03-创建和删除操作" class="headerlink" title="03. 创建和删除操作"></a>03. 创建和删除操作</h2><h3 id="3-1-touch"><a href="#3-1-touch" class="headerlink" title="3.1 touch"></a>3.1 <code>touch</code></h3><ul>
<li>创建文件或修改文件时间<ul>
<li>如果文件 <strong>不存在</strong>，可以创建一个空白文件</li>
<li>如果文件 <strong>已经存在</strong>，可以修改文件的末次修改日期</li>
</ul>
</li>
</ul>
<h3 id="3-2-mkdir"><a href="#3-2-mkdir" class="headerlink" title="3.2 mkdir"></a>3.2 <code>mkdir</code></h3><ul>
<li>创建一个新的目录</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-p</td>
<td>可以递归创建目录</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>新建目录的名称</strong> 不能与当前目录中 <strong>已有的目录或文件</strong> 同名</p>
</blockquote>
<h3 id="3-3-rm"><a href="#3-3-rm" class="headerlink" title="3.3 rm"></a>3.3 <code>rm</code></h3><ul>
<li>删除文件或目录</li>
</ul>
<blockquote>
<p>使用 <code>rm</code> 命令要小心，因为文件删除后不能恢复</p>
</blockquote>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-f</td>
<td>强制删除，忽略不存在的文件，无需提示</td>
</tr>
<tr>
<td>-r</td>
<td>递归地删除目录下的内容，<strong>删除文件夹</strong> 时必须加此参数</td>
</tr>
</tbody></table>
<h2 id="04-拷贝和移动文件"><a href="#04-拷贝和移动文件" class="headerlink" title="04. 拷贝和移动文件"></a>04. 拷贝和移动文件</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>tree [目录名]</td>
<td>tree</td>
<td>以树状图列出文件目录结构</td>
</tr>
<tr>
<td>02</td>
<td>cp 源文件 目标文件</td>
<td>copy</td>
<td>复制文件或者目录</td>
</tr>
<tr>
<td>03</td>
<td>mv 源文件 目标文件</td>
<td>move</td>
<td>移动文件或者目录／文件或者目录重命名</td>
</tr>
</tbody></table>
<h3 id="4-1-tree"><a href="#4-1-tree" class="headerlink" title="4.1 tree"></a>4.1 <code>tree</code></h3><ul>
<li><code>tree</code> 命令可以以树状图列出文件目录结构</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>只显示目录</td>
</tr>
</tbody></table>
<h3 id="4-2-cp"><a href="#4-2-cp" class="headerlink" title="4.2 cp"></a>4.2 <code>cp</code></h3><ul>
<li><code>cp</code> 命令的功能是将给出的 <strong>文件</strong> 或 <strong>目录</strong> 复制到另一个 <strong>文件</strong> 或 <strong>目录</strong> 中，相当于 <strong>DOS</strong> 下的 <code>copy</code> 命令</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>覆盖文件前提示</td>
</tr>
<tr>
<td>-r</td>
<td>若给出的源文件是目录文件，则 cp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名</td>
</tr>
</tbody></table>
<h3 id="4-3-mv"><a href="#4-3-mv" class="headerlink" title="4.3 mv"></a>4.3 <code>mv</code></h3><ul>
<li><code>mv</code> 命令可以用来 <strong>移动</strong> <strong>文件</strong> 或 <strong>目录</strong>，也可以给 <strong>文件或目录重命名</strong></li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>覆盖文件前提示</td>
</tr>
</tbody></table>
<h2 id="05-查看文件内容"><a href="#05-查看文件内容" class="headerlink" title="05. 查看文件内容"></a>05. 查看文件内容</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>cat 文件名</td>
<td>concatenate</td>
<td>查看文件内容、创建文件、文件合并、追加文件内容等功能</td>
</tr>
<tr>
<td>02</td>
<td>more 文件名</td>
<td>more</td>
<td>分屏显示文件内容</td>
</tr>
<tr>
<td>03</td>
<td>grep 搜索文本 文件名</td>
<td>grep</td>
<td>搜索文本文件内容</td>
</tr>
</tbody></table>
<h3 id="5-1-cat"><a href="#5-1-cat" class="headerlink" title="5.1 cat"></a>5.1 <code>cat</code></h3><ul>
<li><code>cat</code> 命令可以用来 <strong>查看文件内容</strong>、<strong>创建文件</strong>、<strong>文件合并</strong>、<strong>追加文件内容</strong> 等功能</li>
<li><code>cat</code> 会一次显示所有的内容，适合 <strong>查看内容较少</strong> 的文本文件</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-b</td>
<td>对非空输出行编号</td>
</tr>
<tr>
<td>-n</td>
<td>对输出的所有行编号</td>
</tr>
</tbody></table>
<blockquote>
<p>Linux 中还有一个 <code>nl</code> 的命令和 <code>cat -b</code> 的效果等价</p>
</blockquote>
<h3 id="5-2-more"><a href="#5-2-more" class="headerlink" title="5.2 more"></a>5.2 <code>more</code></h3><ul>
<li><code>more</code> 命令可以用于分屏显示文件内容，每次只显示一页内容</li>
<li>适合于 <strong>查看内容较多</strong>的文本文件</li>
</ul>
<p>使用 <code>more</code> 的操作键：</p>
<table>
<thead>
<tr>
<th>操作键</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>空格键</td>
<td>显示手册页的下一屏</td>
</tr>
<tr>
<td>Enter 键</td>
<td>一次滚动手册页的一行</td>
</tr>
<tr>
<td>b</td>
<td>回滚一屏</td>
</tr>
<tr>
<td>f</td>
<td>前滚一屏</td>
</tr>
<tr>
<td>q</td>
<td>退出</td>
</tr>
<tr>
<td>/word</td>
<td>搜索 <strong>word</strong> 字符串</td>
</tr>
</tbody></table>
<h3 id="5-3-grep"><a href="#5-3-grep" class="headerlink" title="5.3 grep"></a>5.3 <code>grep</code></h3><ul>
<li>Linux 系统中 <code>grep</code> 命令是一种强大的文本搜索工具</li>
<li><code>grep</code>允许对文本文件进行 <strong>模式</strong>查找，所谓模式查找，又被称为正则表达式，在就业班会详细讲解</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>显示匹配行及行号</td>
</tr>
<tr>
<td>-v</td>
<td>显示不包含匹配文本的所有行（相当于求反）</td>
</tr>
<tr>
<td>-i</td>
<td>忽略大小写</td>
</tr>
</tbody></table>
<ul>
<li>常用的两种模式查找</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>^a</td>
<td>行首，搜寻以 <strong>a</strong> 开头的行</td>
</tr>
<tr>
<td>ke$</td>
<td>行尾，搜寻以 <strong>ke</strong> 结束的行</td>
</tr>
</tbody></table>
<h2 id="06-其他"><a href="#06-其他" class="headerlink" title="06. 其他"></a>06. 其他</h2><h3 id="6-1-echo-文字内容"><a href="#6-1-echo-文字内容" class="headerlink" title="6.1 echo 文字内容"></a>6.1 <code>echo 文字内容</code></h3><ul>
<li><code>echo</code> 会在终端中显示参数指定的文字，通常会和 <strong>重定向</strong> 联合使用</li>
</ul>
<h3 id="6-2-重定向-gt-和-gt-gt"><a href="#6-2-重定向-gt-和-gt-gt" class="headerlink" title="6.2 重定向 &gt; 和 &gt;&gt;"></a>6.2 重定向 <code>&gt;</code> 和 <code>&gt;&gt;</code></h3><ul>
<li>Linux 允许将命令执行结果 <strong>重定向</strong>到一个 <strong>文件</strong></li>
<li>将本应显示在<strong>终端上的内容</strong> <strong>输出／追加</strong> 到<strong>指定文件中</strong></li>
</ul>
<p>其中</p>
<ul>
<li><code>&gt;</code> 表示输出，会覆盖文件原有的内容</li>
<li><code>&gt;&gt;</code> 表示追加，会将内容追加到已有文件的末尾</li>
</ul>
<h3 id="6-3-管道"><a href="#6-3-管道" class="headerlink" title="6.3 管道 |"></a>6.3 管道 <code>|</code></h3><ul>
<li>Linux 允许将 <strong>一个命令的输出</strong> 可以<strong>通过管道</strong> 做为 <strong>另一个命令的输入</strong></li>
<li>可以理解现实生活中的管子，管子的一头塞东西进去，另一头取出来，这里 <code>|</code> 的左右分为两端，左端塞东西（写），右端取东西（读）</li>
</ul>
<p>常用的管道命令有：</p>
<ul>
<li><code>more</code>：分屏显示内容</li>
<li><code>grep</code>：在命令执行结果的基础上查询指定的文本</li>
</ul>
<h1 id="文件和目录常用命令-1"><a href="#文件和目录常用命令-1" class="headerlink" title="文件和目录常用命令"></a>文件和目录常用命令</h1><h2 id="目标-3"><a href="#目标-3" class="headerlink" title="目标"></a>目标</h2><ul>
<li>查看目录内容<ul>
<li><code>ls</code></li>
</ul>
</li>
<li>切换目录<ul>
<li><code>cd</code></li>
</ul>
</li>
<li>创建和删除操作<ul>
<li><code>touch</code></li>
<li><code>rm</code></li>
<li><code>mkdir</code></li>
</ul>
</li>
<li>拷贝和移动文件<ul>
<li><code>cp</code></li>
<li><code>mv</code></li>
</ul>
</li>
<li>查看文件内容<ul>
<li><code>cat</code></li>
<li><code>more</code></li>
<li><code>grep</code></li>
</ul>
</li>
<li>其他<ul>
<li><code>echo</code></li>
<li>重定向 <code>&gt;</code> 和 <code>&gt;&gt;</code></li>
<li>管道 <code>|</code></li>
</ul>
</li>
</ul>
<h2 id="01-查看目录内容-1"><a href="#01-查看目录内容-1" class="headerlink" title="01. 查看目录内容"></a>01. 查看目录内容</h2><h3 id="1-1-终端实用技巧-1"><a href="#1-1-终端实用技巧-1" class="headerlink" title="1.1 终端实用技巧"></a>1.1 终端实用技巧</h3><h4 id="1-gt-自动补全-1"><a href="#1-gt-自动补全-1" class="headerlink" title="1&gt; 自动补全"></a>1&gt; 自动补全</h4><ul>
<li>在敲出 <code>文件</code>／<code>目录</code>／<code>命令</code> 的前几个字母之后，按下 <code>tab</code> 键<ul>
<li>如果输入的没有歧义，系统会自动补全</li>
<li>如果还存在其他 <code>文件</code>／<code>目录</code>／<code>命令</code>，再按一下 <code>tab</code> 键，系统会提示可能存在的命令</li>
</ul>
</li>
</ul>
<h4 id="2-gt-曾经使用过的命令-1"><a href="#2-gt-曾经使用过的命令-1" class="headerlink" title="2&gt; 曾经使用过的命令"></a>2&gt; 曾经使用过的命令</h4><ul>
<li>按 <code>上</code>／<code>下</code> 光标键可以在曾经使用过的命令之间来回切换</li>
<li>如果想要退出选择，并且不想执行当前选中的命令，可以按 <code>ctrl + c</code></li>
</ul>
<h3 id="1-2-ls-命令说明-1"><a href="#1-2-ls-命令说明-1" class="headerlink" title="1.2 ls 命令说明"></a>1.2 <code>ls</code> 命令说明</h3><ul>
<li><code>ls</code> 是英文单词 <strong>list</strong> 的简写，其功能为列出目录的内容，是用户最常用的命令之一，类似于 <strong>DOS</strong> 下的 <code>dir</code> 命令</li>
</ul>
<h4 id="Linux-下文件和目录的特点-1"><a href="#Linux-下文件和目录的特点-1" class="headerlink" title="Linux 下文件和目录的特点"></a>Linux 下文件和目录的特点</h4><ul>
<li>Linux <strong>文件</strong> 或者 <strong>目录</strong> 名称最长可以有 <code>256</code> 个字符</li>
<li>以 <code>.</code> 开头的文件为隐藏文件，需要用 -a 参数才能显示</li>
<li><strong>.</strong> 代表当前目录</li>
<li><strong>..</strong> 代表上一级目录</li>
</ul>
<h3 id="1-3-ls-常用选项-1"><a href="#1-3-ls-常用选项-1" class="headerlink" title="1.3 ls 常用选项"></a>1.3 ls 常用选项</h3><table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>显示指定目录下所有子目录与文件，包括隐藏文件</td>
</tr>
<tr>
<td>-l</td>
<td>以列表方式显示文件的详细信息</td>
</tr>
<tr>
<td>-h</td>
<td>配合 -l 以人性化的方式显示文件大小</td>
</tr>
</tbody></table>
<h4 id="计算机中文件大小的表示方式（科普）-1"><a href="#计算机中文件大小的表示方式（科普）-1" class="headerlink" title="计算机中文件大小的表示方式（科普）"></a>计算机中文件大小的表示方式（科普）</h4><table>
<thead>
<tr>
<th>单位</th>
<th>英文</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>字节</td>
<td>B（Byte）</td>
<td>在计算机中作为一个数字单元，一般为 8 位二进制数</td>
</tr>
<tr>
<td>千</td>
<td>K（Kibibyte）</td>
<td>1 KB = 1024 B，千字节 （1024 = 2 ** 10）</td>
</tr>
<tr>
<td>兆</td>
<td>M（Mebibyte）</td>
<td>1 MB = 1024 KB，百万字节</td>
</tr>
<tr>
<td>千兆</td>
<td>G（Gigabyte）</td>
<td>1 GB = 1024 MB，十亿字节，千兆字节</td>
</tr>
<tr>
<td>太</td>
<td>T（Terabyte）</td>
<td>1 TB = 1024 GB，万亿字节，太字节</td>
</tr>
<tr>
<td>拍</td>
<td>P（Petabyte）</td>
<td>1 PB = 1024 TB，千万亿字节，拍字节</td>
</tr>
<tr>
<td>艾</td>
<td>E（Exabyte）</td>
<td>1 EB = 1024 PB，百亿亿字节，艾字节</td>
</tr>
<tr>
<td>泽</td>
<td>Z（Zettabyte）</td>
<td>1 ZB = 1024 EB，十万亿亿字节，泽字节</td>
</tr>
<tr>
<td>尧</td>
<td>Y（Yottabyte）</td>
<td>1 YB = 1024 ZB，一亿亿亿字节，尧字节</td>
</tr>
</tbody></table>
<h3 id="1-4-ls-通配符的使用-1"><a href="#1-4-ls-通配符的使用-1" class="headerlink" title="1.4 ls 通配符的使用"></a>1.4 ls 通配符的使用</h3><table>
<thead>
<tr>
<th>通配符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>代表任意个数个字符</td>
</tr>
<tr>
<td>?</td>
<td>代表任意一个字符，至少 1 个</td>
</tr>
<tr>
<td>[]</td>
<td>表示可以匹配字符组中的任一一个</td>
</tr>
<tr>
<td>[abc]</td>
<td>匹配 a、b、c 中的任意一个</td>
</tr>
<tr>
<td>[a-f]</td>
<td>匹配从 a 到 f 范围内的的任意一个字符</td>
</tr>
</tbody></table>
<h2 id="02-切换目录-1"><a href="#02-切换目录-1" class="headerlink" title="02. 切换目录"></a>02. 切换目录</h2><h3 id="2-1-cd-1"><a href="#2-1-cd-1" class="headerlink" title="2.1 cd"></a>2.1 <code>cd</code></h3><ul>
<li><code>cd</code> 是英文单词 <strong>change directory</strong> 的简写，其功能为更改当前的工作目录，也是用户最常用的命令之一</li>
</ul>
<blockquote>
<p>注意：Linux 所有的 <strong>目录</strong> 和 <strong>文件名</strong> 都是大小写敏感的</p>
</blockquote>
<table>
<thead>
<tr>
<th>命令</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>cd</td>
<td>切换到当前用户的主目录(/home/用户目录)</td>
</tr>
<tr>
<td>cd ~</td>
<td>切换到当前用户的主目录(/home/用户目录)</td>
</tr>
<tr>
<td>cd .</td>
<td>保持在当前目录不变</td>
</tr>
<tr>
<td>cd ..</td>
<td>切换到上级目录</td>
</tr>
<tr>
<td>cd -</td>
<td>可以在最近两次工作目录之间来回切换</td>
</tr>
</tbody></table>
<h3 id="2-2-相对路径和绝对路径-1"><a href="#2-2-相对路径和绝对路径-1" class="headerlink" title="2.2 相对路径和绝对路径"></a>2.2 相对路径和绝对路径</h3><ul>
<li><strong>相对路径</strong> 在输入路径时，最前面不是 <strong>/</strong> 或者 <strong>~</strong>，表示相对 <strong>当前目录</strong> 所在的目录位置</li>
<li><strong>绝对路径</strong> 在输入路径时，最前面是 <strong>/</strong> 或者 <strong>~</strong>，表示从 <strong>根目录/家目录</strong> 开始的具体目录位置</li>
</ul>
<h2 id="03-创建和删除操作-1"><a href="#03-创建和删除操作-1" class="headerlink" title="03. 创建和删除操作"></a>03. 创建和删除操作</h2><h3 id="3-1-touch-1"><a href="#3-1-touch-1" class="headerlink" title="3.1 touch"></a>3.1 <code>touch</code></h3><ul>
<li>创建文件或修改文件时间<ul>
<li>如果文件 <strong>不存在</strong>，可以创建一个空白文件</li>
<li>如果文件 <strong>已经存在</strong>，可以修改文件的末次修改日期</li>
</ul>
</li>
</ul>
<h3 id="3-2-mkdir-1"><a href="#3-2-mkdir-1" class="headerlink" title="3.2 mkdir"></a>3.2 <code>mkdir</code></h3><ul>
<li>创建一个新的目录</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-p</td>
<td>可以递归创建目录</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>新建目录的名称</strong> 不能与当前目录中 <strong>已有的目录或文件</strong> 同名</p>
</blockquote>
<h3 id="3-3-rm-1"><a href="#3-3-rm-1" class="headerlink" title="3.3 rm"></a>3.3 <code>rm</code></h3><ul>
<li>删除文件或目录</li>
</ul>
<blockquote>
<p>使用 <code>rm</code> 命令要小心，因为文件删除后不能恢复</p>
</blockquote>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-f</td>
<td>强制删除，忽略不存在的文件，无需提示</td>
</tr>
<tr>
<td>-r</td>
<td>递归地删除目录下的内容，<strong>删除文件夹</strong> 时必须加此参数</td>
</tr>
</tbody></table>
<h2 id="04-拷贝和移动文件-1"><a href="#04-拷贝和移动文件-1" class="headerlink" title="04. 拷贝和移动文件"></a>04. 拷贝和移动文件</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>tree [目录名]</td>
<td>tree</td>
<td>以树状图列出文件目录结构</td>
</tr>
<tr>
<td>02</td>
<td>cp 源文件 目标文件</td>
<td>copy</td>
<td>复制文件或者目录</td>
</tr>
<tr>
<td>03</td>
<td>mv 源文件 目标文件</td>
<td>move</td>
<td>移动文件或者目录／文件或者目录重命名</td>
</tr>
</tbody></table>
<h3 id="4-1-tree-1"><a href="#4-1-tree-1" class="headerlink" title="4.1 tree"></a>4.1 <code>tree</code></h3><ul>
<li><code>tree</code> 命令可以以树状图列出文件目录结构</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>只显示目录</td>
</tr>
</tbody></table>
<h3 id="4-2-cp-1"><a href="#4-2-cp-1" class="headerlink" title="4.2 cp"></a>4.2 <code>cp</code></h3><ul>
<li><code>cp</code> 命令的功能是将给出的 <strong>文件</strong> 或 <strong>目录</strong> 复制到另一个 <strong>文件</strong> 或 <strong>目录</strong> 中，相当于 <strong>DOS</strong> 下的 <code>copy</code> 命令</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>覆盖文件前提示</td>
</tr>
<tr>
<td>-r</td>
<td>若给出的源文件是目录文件，则 cp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名</td>
</tr>
</tbody></table>
<h3 id="4-3-mv-1"><a href="#4-3-mv-1" class="headerlink" title="4.3 mv"></a>4.3 <code>mv</code></h3><ul>
<li><code>mv</code> 命令可以用来 <strong>移动</strong> <strong>文件</strong> 或 <strong>目录</strong>，也可以给 <strong>文件或目录重命名</strong></li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>覆盖文件前提示</td>
</tr>
</tbody></table>
<h2 id="05-查看文件内容-1"><a href="#05-查看文件内容-1" class="headerlink" title="05. 查看文件内容"></a>05. 查看文件内容</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>cat 文件名</td>
<td>concatenate</td>
<td>查看文件内容、创建文件、文件合并、追加文件内容等功能</td>
</tr>
<tr>
<td>02</td>
<td>more 文件名</td>
<td>more</td>
<td>分屏显示文件内容</td>
</tr>
<tr>
<td>03</td>
<td>grep 搜索文本 文件名</td>
<td>grep</td>
<td>搜索文本文件内容</td>
</tr>
</tbody></table>
<h3 id="5-1-cat-1"><a href="#5-1-cat-1" class="headerlink" title="5.1 cat"></a>5.1 <code>cat</code></h3><ul>
<li><code>cat</code> 命令可以用来 <strong>查看文件内容</strong>、<strong>创建文件</strong>、<strong>文件合并</strong>、<strong>追加文件内容</strong> 等功能</li>
<li><code>cat</code> 会一次显示所有的内容，适合 <strong>查看内容较少</strong> 的文本文件</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-b</td>
<td>对非空输出行编号</td>
</tr>
<tr>
<td>-n</td>
<td>对输出的所有行编号</td>
</tr>
</tbody></table>
<blockquote>
<p>Linux 中还有一个 <code>nl</code> 的命令和 <code>cat -b</code> 的效果等价</p>
</blockquote>
<h3 id="5-2-more-1"><a href="#5-2-more-1" class="headerlink" title="5.2 more"></a>5.2 <code>more</code></h3><ul>
<li><code>more</code> 命令可以用于分屏显示文件内容，每次只显示一页内容</li>
<li>适合于 <strong>查看内容较多</strong>的文本文件</li>
</ul>
<p>使用 <code>more</code> 的操作键：</p>
<table>
<thead>
<tr>
<th>操作键</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>空格键</td>
<td>显示手册页的下一屏</td>
</tr>
<tr>
<td>Enter 键</td>
<td>一次滚动手册页的一行</td>
</tr>
<tr>
<td>b</td>
<td>回滚一屏</td>
</tr>
<tr>
<td>f</td>
<td>前滚一屏</td>
</tr>
<tr>
<td>q</td>
<td>退出</td>
</tr>
<tr>
<td>/word</td>
<td>搜索 <strong>word</strong> 字符串</td>
</tr>
</tbody></table>
<h3 id="5-3-grep-1"><a href="#5-3-grep-1" class="headerlink" title="5.3 grep"></a>5.3 <code>grep</code></h3><ul>
<li>Linux 系统中 <code>grep</code> 命令是一种强大的文本搜索工具</li>
<li><code>grep</code>允许对文本文件进行 <strong>模式</strong>查找，所谓模式查找，又被称为正则表达式，在就业班会详细讲解</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>显示匹配行及行号</td>
</tr>
<tr>
<td>-v</td>
<td>显示不包含匹配文本的所有行（相当于求反）</td>
</tr>
<tr>
<td>-i</td>
<td>忽略大小写</td>
</tr>
</tbody></table>
<ul>
<li>常用的两种模式查找</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>^a</td>
<td>行首，搜寻以 <strong>a</strong> 开头的行</td>
</tr>
<tr>
<td>ke$</td>
<td>行尾，搜寻以 <strong>ke</strong> 结束的行</td>
</tr>
</tbody></table>
<h2 id="06-其他-1"><a href="#06-其他-1" class="headerlink" title="06. 其他"></a>06. 其他</h2><h3 id="6-1-echo-文字内容-1"><a href="#6-1-echo-文字内容-1" class="headerlink" title="6.1 echo 文字内容"></a>6.1 <code>echo 文字内容</code></h3><ul>
<li><code>echo</code> 会在终端中显示参数指定的文字，通常会和 <strong>重定向</strong> 联合使用</li>
</ul>
<h3 id="6-2-重定向-gt-和-gt-gt-1"><a href="#6-2-重定向-gt-和-gt-gt-1" class="headerlink" title="6.2 重定向 &gt; 和 &gt;&gt;"></a>6.2 重定向 <code>&gt;</code> 和 <code>&gt;&gt;</code></h3><ul>
<li>Linux 允许将命令执行结果 <strong>重定向</strong>到一个 <strong>文件</strong></li>
<li>将本应显示在<strong>终端上的内容</strong> <strong>输出／追加</strong> 到<strong>指定文件中</strong></li>
</ul>
<p>其中</p>
<ul>
<li><code>&gt;</code> 表示输出，会覆盖文件原有的内容</li>
<li><code>&gt;&gt;</code> 表示追加，会将内容追加到已有文件的末尾</li>
</ul>
<h3 id="6-3-管道-1"><a href="#6-3-管道-1" class="headerlink" title="6.3 管道 |"></a>6.3 管道 <code>|</code></h3><ul>
<li>Linux 允许将 <strong>一个命令的输出</strong> 可以<strong>通过管道</strong> 做为 <strong>另一个命令的输入</strong></li>
<li>可以理解现实生活中的管子，管子的一头塞东西进去，另一头取出来，这里 <code>|</code> 的左右分为两端，左端塞东西（写），右端取东西（读）</li>
</ul>
<p>常用的管道命令有：</p>
<ul>
<li><code>more</code>：分屏显示内容</li>
<li><code>grep</code>：在命令执行结果的基础上查询指定的文本</li>
</ul>
<h1 id="远程管理常用命令"><a href="#远程管理常用命令" class="headerlink" title="远程管理常用命令"></a>远程管理常用命令</h1><h2 id="目标-4"><a href="#目标-4" class="headerlink" title="目标"></a>目标</h2><ul>
<li>关机/重启<ul>
<li><code>shutdown</code></li>
</ul>
</li>
<li>查看或配置网卡信息<ul>
<li><code>ifconfig</code></li>
<li><code>ping</code></li>
</ul>
</li>
<li>远程登录和复制文件<ul>
<li><code>ssh</code></li>
<li><code>scp</code></li>
</ul>
</li>
</ul>
<h2 id="01-关机-重启"><a href="#01-关机-重启" class="headerlink" title="01. 关机/重启"></a>01. 关机/重启</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>shutdown 选项 时间</td>
<td>shutdown</td>
<td>关机／重新启动</td>
</tr>
</tbody></table>
<h3 id="1-1-shutdown"><a href="#1-1-shutdown" class="headerlink" title="1.1 shutdown"></a>1.1 <code>shutdown</code></h3><ul>
<li><code>shutdown</code> 命令可以 <strong>安全</strong> <strong>关闭</strong> 或者 <strong>重新启动系统</strong></li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-r</td>
<td>重新启动</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：</p>
<ul>
<li><strong>不指定选项和参数</strong>，默认表示 <strong>1 分钟</strong>之后 <strong>关闭电脑</strong></li>
<li>远程维护服务器时，最好不要关闭系统，而应该重新启动系统</li>
</ul>
</blockquote>
<ul>
<li>常用命令示例</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 重新启动操作系统，其中 now 表示现在</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ shutdown -r now</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 立刻关机，其中 now 表示现在</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ shutdown now</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 系统在今天的 20:25 会关机</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ shutdown 20:25</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 系统再过十分钟后自动关机</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ shutdown +10</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 取消之前指定的关机计划</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ shutdown -c</span></pre></td></tr></table></figure>

<h2 id="02-查看或配置网卡信息"><a href="#02-查看或配置网卡信息" class="headerlink" title="02. 查看或配置网卡信息"></a>02. 查看或配置网卡信息</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>ifconfig</td>
<td>configure a network interface</td>
<td>查看/配置计算机当前的网卡配置信息</td>
</tr>
<tr>
<td>02</td>
<td>ping ip地址</td>
<td>ping</td>
<td>检测到目标 ip地址 的连接是否正常</td>
</tr>
</tbody></table>
<h3 id="2-1-网卡-和-IP-地址"><a href="#2-1-网卡-和-IP-地址" class="headerlink" title="2.1 网卡 和 IP 地址"></a>2.1 网卡 和 IP 地址</h3><h4 id="网卡"><a href="#网卡" class="headerlink" title="网卡"></a>网卡</h4><ul>
<li>网卡是一个专门负责网络通讯的硬件设备</li>
<li><strong>IP 地址</strong>是设置在网卡上的地址信息</li>
</ul>
<blockquote>
<p>我们可以把 <strong>电脑</strong> 比作 <strong>电话</strong>，<strong>网卡</strong> 相当于 <strong>SIM 卡</strong>，<strong>IP 地址</strong> 相当于 <strong>电话号码</strong></p>
</blockquote>
<h4 id="IP-地址"><a href="#IP-地址" class="headerlink" title="IP 地址"></a>IP 地址</h4><ul>
<li><strong>每台联网的电脑上</strong>都有 <strong>IP 地址</strong>，<strong>是保证电脑之间正常通讯的重要设置</strong></li>
</ul>
<blockquote>
<p>注意：每台电脑的 IP 地址不能相同，否则会出现 IP 地址冲突，并且没有办法正常通讯</p>
<p>提示：有关 <strong>IP 地址</strong>的详细内容，在就业班会详细讲解！</p>
</blockquote>
<h3 id="2-2-ifconfig"><a href="#2-2-ifconfig" class="headerlink" title="2.2 ifconfig"></a>2.2 <code>ifconfig</code></h3><ul>
<li><code>ifconfig</code> 可以查看／配置计算机当前的网卡配置信息</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看网卡配置信息</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ ifconfig</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 查看网卡对应的 IP 地址</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ ifconfig | grep inet</span></pre></td></tr></table></figure>

<blockquote>
<p>提示：一台计算机中有可能会有一个 <strong>物理网卡</strong> 和 <strong>多个虚拟网卡</strong>，在 Linux 中物理网卡的名字通常以 <code>ensXX</code> 表示</p>
</blockquote>
<ul>
<li><code>127.0.0.1</code> 被称为 <strong>本地回环/环回地址</strong>，一般用来测试本机网卡是否正常</li>
</ul>
<h3 id="2-3-ping"><a href="#2-3-ping" class="headerlink" title="2.3 ping"></a>2.3 <code>ping</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 检测到目标主机是否连接正常</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ ping IP地址</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 检测本地网卡工作正常</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ ping 127.0.0.1</span></pre></td></tr></table></figure>

<ul>
<li><code>ping</code> 一般用于检测当前计算机到目标计算机之间的网络 <strong>是否通畅</strong>，<strong>数值越大，速度越慢</strong></li>
</ul>
<blockquote>
<ul>
<li><code>ping</code> 的工作原理与潜水艇的声纳相似，<code>ping</code> 这个命令就是取自 <strong>声纳的声音</strong> </li>
<li>网络管理员之间也常将 <code>ping</code> 用作动词 —— <strong>ping 一下计算机X，看他是否开着</strong></li>
</ul>
</blockquote>
<p>原理：网络上的机器都有 <strong>唯一确定的 IP 地址</strong>，我们给<strong>目标 IP 地址</strong>发送一个数据包，对方就要返回一个数据包，根据返回的数据包以及时间，我们可以确定目标主机的存在</p>
<blockquote>
<p>提示：在 Linux 中，想要终止一个终端程序的执行，绝大多数都可以使用 <code>CTRL + C</code></p>
</blockquote>
<h2 id="03-远程登录和复制文件"><a href="#03-远程登录和复制文件" class="headerlink" title="03. 远程登录和复制文件"></a>03. 远程登录和复制文件</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>对应英文</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>ssh 用户名@ip</td>
<td>secure shell</td>
<td>关机／重新启动</td>
</tr>
<tr>
<td>02</td>
<td>scp 用户名@ip:文件名或路径 用户名@ip:文件名或路径</td>
<td>secure copy</td>
<td>远程复制文件</td>
</tr>
</tbody></table>
<h3 id="3-1-ssh-基础（重点）"><a href="#3-1-ssh-基础（重点）" class="headerlink" title="3.1 ssh 基础（重点）"></a>3.1 <code>ssh</code> 基础（重点）</h3><p>在 Linux 中 SSH 是 <strong>非常常用</strong> 的工具，通过 <strong>SSH 客户端</strong> 我们可以连接到运行了 <strong>SSH 服务器</strong> 的远程机器上</p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/001_SSH%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="001_SSH示意图"></p>
<ul>
<li><strong>SSH 客户端</strong>是一种使用 <code>Secure Shell（SSH）</code> 协议连接到远程计算机的软件程序</li>
<li><code>SSH</code> 是目前较可靠，<strong>专为远程登录会话和其他网络服务</strong> 提供安全性的协议<ul>
<li>利用 <code>SSH 协议</code> 可以有效<strong>防止远程管理过程中的信息泄露</strong></li>
<li>通过 <code>SSH 协议</code> 可以对所有传输的数据进行加密，也能够防止 DNS 欺骗和 IP 欺骗</li>
</ul>
</li>
<li><code>SSH</code> 的另一项优点是传输的数据可以是经过压缩的，所以可以加快传输的速度</li>
</ul>
<h4 id="1-域名-和-端口号"><a href="#1-域名-和-端口号" class="headerlink" title="1) 域名 和 端口号"></a>1) 域名 和 端口号</h4><h5 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h5><ul>
<li>由一串 <strong>用点分隔</strong> 的名字组成，例如：<code>www.itcast.cn</code></li>
<li>是 <strong>IP 地址</strong> 的别名，方便用户记忆</li>
</ul>
<h5 id="端口号"><a href="#端口号" class="headerlink" title="端口号"></a>端口号</h5><ul>
<li><p><strong>IP 地址</strong>：通过 <strong>IP 地址</strong> 找到网络上的 <strong>计算机</strong></p>
</li>
<li><p><strong>端口号</strong>：通过 <strong>端口号</strong> 可以找到 <strong>计算机上运行的应用程序</strong></p>
<ul>
<li><strong>SSH 服务器</strong> 的默认端口号是 <code>22</code>，如果是默认端口号，在连接的时候，可以省略</li>
</ul>
</li>
<li><p>常见服务端口号列表：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>序号</th>
<th>服务</th>
<th>端口号</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>SSH 服务器</td>
<td>22</td>
</tr>
<tr>
<td>02</td>
<td>Web 服务器</td>
<td>80</td>
</tr>
<tr>
<td>03</td>
<td>HTTPS</td>
<td>443</td>
</tr>
<tr>
<td>04</td>
<td>FTP 服务器</td>
<td>21</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：有关 <strong>端口号</strong>的详细内容，在就业班会详细讲解！</p>
</blockquote>
<h4 id="2-SSH-客户端的简单使用"><a href="#2-SSH-客户端的简单使用" class="headerlink" title="2) SSH 客户端的简单使用"></a>2) SSH 客户端的简单使用</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh [-p port] user@remote</span></pre></td></tr></table></figure>

<ul>
<li><code>user</code> 是在远程机器上的用户名，如果不指定的话默认为当前用户</li>
<li><code>remote</code> 是远程机器的地址，可以是 <strong>IP</strong>／<strong>域名</strong>，或者是 <strong>后面会提到的别名</strong></li>
<li><code>port</code> 是 <strong>SSH Server 监听的端口</strong>，如果不指定，就为默认值 <code>22</code></li>
</ul>
<blockquote>
<p>提示：</p>
<ul>
<li>使用 <code>exit</code> 退出当前用户的登录</li>
</ul>
<p>注意：</p>
<ul>
<li><code>ssh</code> 这个终端命令只能在 <code>Linux</code> 或者 <code>UNIX</code> 系统下使用</li>
<li>如果在 <code>Windows</code> 系统中，可以安装 <code>PuTTY</code> 或者 <code>XShell</code> 客户端软件即可</li>
</ul>
<p>提示：</p>
<ul>
<li>在工作中，SSH 服务器的端口号很有可能<strong>不是 22</strong>，如果遇到这种情况就需要使用 <code>-p</code> 选项，指定正确的端口号，否则无法正常连接到服务器</li>
</ul>
</blockquote>
<h4 id="3-Windows-下-SSH-客户端的安装"><a href="#3-Windows-下-SSH-客户端的安装" class="headerlink" title="3) Windows 下 SSH 客户端的安装"></a>3) Windows 下 SSH 客户端的安装</h4><ul>
<li><code>Putty</code> <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener">http://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html</a></li>
<li><code>XShell</code> <a href="http://xshellcn.com" target="_blank" rel="noopener">http://xshellcn.com</a></li>
</ul>
<blockquote>
<p>建议从官方网站下载正式的安装程序</p>
</blockquote>
<h3 id="3-2-scp（掌握）"><a href="#3-2-scp（掌握）" class="headerlink" title="3.2 scp（掌握）"></a>3.2 <code>scp</code>（掌握）</h3><ul>
<li>scp 就是 <code>secure copy</code>，是一个在 Linux 下用来进行 <strong>远程拷贝文件</strong> 的命令</li>
<li>它的<strong>地址格式与 ssh 基本相同</strong>，<strong>需要注意的是</strong>，在指定端口时用的是大写的 <code>-P</code> 而不是小写的</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/002_SCP%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="002_SCP示意图"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 把本地当前目录下的 01.py 文件 复制到 远程 家目录下的 Desktop/01.py</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 注意：`:` 后面的路径如果不是绝对路径，则以用户的家目录作为参照路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">scp -P port 01.py user@remote:Desktop/01.py</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 把远程 家目录下的 Desktop/01.py 文件 复制到 本地当前目录下的 01.py</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">scp -P port user@remote:Desktop/01.py 01.py</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 加上 -r 选项可以传送文件夹</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 把当前目录下的 demo 文件夹 复制到 远程 家目录下的 Desktop</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">scp -r demo user@remote:Desktop</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 把远程 家目录下的 Desktop 复制到 当前目录下的 demo 文件夹</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">scp -r user@remote:Desktop demo</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-r</td>
<td>若给出的源文件是目录文件，则 scp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名</td>
</tr>
<tr>
<td>-P</td>
<td>若远程 SSH 服务器的端口不是 22，需要使用大写字母 -P 选项指定端口</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：</p>
<ul>
<li><code>scp</code> 这个终端命令只能在 <code>Linux</code> 或者 <code>UNIX</code> 系统下使用</li>
<li>如果在 <code>Windows</code> 系统中，可以安装 <code>PuTTY</code>，使用 <code>pscp</code> 命令行工具或者安装 <code>FileZilla</code> 使用 <code>FTP</code> 进行文件传输</li>
</ul>
</blockquote>
<h4 id="FileZilla"><a href="#FileZilla" class="headerlink" title="FileZilla"></a><code>FileZilla</code></h4><ul>
<li>官方网站：<a href="https://www.filezilla.cn/download/client" target="_blank" rel="noopener">https://www.filezilla.cn/download/client</a></li>
<li><code>FileZilla</code> 在传输文件时，使用的是 <code>FTP 服务</code> 而不是 <code>SSH 服务</code>，因此端口号应该设置为 <code>21</code></li>
</ul>
<h3 id="3-3-SSH-高级（知道）"><a href="#3-3-SSH-高级（知道）" class="headerlink" title="3.3 SSH 高级（知道）"></a>3.3 SSH 高级（知道）</h3><ul>
<li>免密码登录</li>
<li>配置别名</li>
</ul>
<blockquote>
<p>提示：有关 SSH 配置信息都保存在用户家目录下的 <code>.ssh</code> 目录下</p>
</blockquote>
<h4 id="1）免密码登录"><a href="#1）免密码登录" class="headerlink" title="1）免密码登录"></a>1）免密码登录</h4><h5 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h5><ul>
<li>配置公钥<ul>
<li>执行 <code>ssh-keygen</code> 即可生成 SSH 钥匙，一路回车即可</li>
</ul>
</li>
<li>上传公钥到服务器<ul>
<li>执行 <code>ssh-copy-id -p port user@remote</code>，可以让远程服务器记住我们的公钥</li>
</ul>
</li>
</ul>
<h5 id="示意图"><a href="#示意图" class="headerlink" title="示意图"></a>示意图</h5><p>![001_组示意图](<a href="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/003_SSH" target="_blank" rel="noopener">https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/003_SSH</a> 免密码示意图.png))</p>
<blockquote>
<p>非对称加密算法</p>
<ul>
<li>使用 <strong>公钥</strong> 加密的数据，需要使用 <strong>私钥</strong> 解密</li>
<li>使用 <strong>私钥</strong> 加密的数据，需要使用 <strong>公钥</strong> 解密</li>
</ul>
</blockquote>
<h4 id="2-配置别名"><a href="#2-配置别名" class="headerlink" title="2) 配置别名"></a>2) 配置别名</h4><p>每次都输入 <code>ssh -p port user@remote</code>，时间久了会觉得很麻烦，特别是当 <code>user</code>, <code>remote</code> 和 <code>port</code> 都得输入，而且还不好记忆</p>
<p>而 <strong>配置别名</strong> 可以让我们进一步偷懒，譬如用：<code>ssh mac</code> 来替代上面这么一长串，那么就在 <code>~/.ssh/config</code> 里面追加以下内容：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Host mac</span></pre></td></tr><tr><td class="code"><pre><span class="line">    HostName ip地址</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="built_in"> User </span>itheima</span></pre></td></tr><tr><td class="code"><pre><span class="line">   <span class="built_in"> Port </span>22</span></pre></td></tr></table></figure>

<p><strong>保存之后，即可用 <code>ssh mac</code> 实现远程登录了，<code>scp</code> 同样可以使用</strong></p>
<h1 id="用户权限相关命令"><a href="#用户权限相关命令" class="headerlink" title="用户权限相关命令"></a>用户权限相关命令</h1><h2 id="目标-5"><a href="#目标-5" class="headerlink" title="目标"></a>目标</h2><ul>
<li><strong>用户</strong> 和 <strong>权限</strong> 的基本概念</li>
<li><strong>用户管理</strong> 终端命令</li>
<li><strong>组管理</strong> 终端命令</li>
<li><strong>修改权限</strong> 终端命令</li>
</ul>
<h2 id="01-用户-和-权限-的基本概念"><a href="#01-用户-和-权限-的基本概念" class="headerlink" title="01. 用户 和 权限 的基本概念"></a>01. <strong>用户</strong> 和 <strong>权限</strong> 的基本概念</h2><h3 id="1-1-基本概念"><a href="#1-1-基本概念" class="headerlink" title="1.1 基本概念"></a>1.1 基本概念</h3><ul>
<li><strong>用户</strong> 是 Linux 系统工作中重要的一环，用户管理包括 <strong>用户</strong> 与 <strong>组</strong> 管理</li>
<li>在 Linux 系统中，不论是由本机或是远程登录系统，每个系统都<strong>必须拥有一个账号</strong>，并且<strong>对于不同的系统资源拥有不同的使用权限</strong></li>
<li>在 Linux 中，可以指定 <strong>每一个用户</strong> 针对 <strong>不同的文件或者目录</strong> 的 <strong>不同权限</strong></li>
<li>对 <strong>文件／目录</strong> 的权限包括：</li>
</ul>
<table>
<thead>
<tr>
<th align="center">序号</th>
<th align="center">权限</th>
<th align="center">英文</th>
<th align="center">缩写</th>
<th align="center">数字代号</th>
</tr>
</thead>
<tbody><tr>
<td align="center">01</td>
<td align="center">读</td>
<td align="center">read</td>
<td align="center">r</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">02</td>
<td align="center">写</td>
<td align="center">write</td>
<td align="center">w</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">03</td>
<td align="center">执行</td>
<td align="center">excute</td>
<td align="center">x</td>
<td align="center">1</td>
</tr>
</tbody></table>
<h3 id="1-2-组"><a href="#1-2-组" class="headerlink" title="1.2 组"></a>1.2 组</h3><ul>
<li>为了方便用户管理，提出了 <strong>组</strong> 的概念，如下图所示</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/001_%E7%BB%84%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="001_组示意图"></p>
<ul>
<li>在实际应用中，可以预先针对 <strong>组</strong> 设置好权限，然后 <strong>将不同的用户添加到对应的组中</strong>，从而<strong>不用依次为每一个用户设置权限</strong></li>
</ul>
<h3 id="1-3-ls-l-扩展"><a href="#1-3-ls-l-扩展" class="headerlink" title="1.3 ls -l 扩展"></a>1.3 ls -l 扩展</h3><ul>
<li><p><code>ls -l</code> 可以查看文件夹下文件的详细信息，从左到右依次是：</p>
<ul>
<li><strong>权限</strong>，第 1 个字符如果是 <code>d</code> 表示目录</li>
<li><strong>硬链接数</strong>，通俗地讲，就是有多少种方式，可以访问到当前目录／文件</li>
<li><strong>拥有者</strong>，家目录下 文件／目录 的拥有者通常都是当前用户</li>
<li><strong>组</strong>，在 Linux 中，很多时候，会出现组名和用户名相同的情况，后续会讲</li>
<li><strong>大小</strong></li>
<li><strong>时间</strong></li>
<li><strong>名称</strong></li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/002_%E6%9D%83%E9%99%90%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="002_权限示意图"></p>
<h3 id="1-4-chmod-简单使用（重要）"><a href="#1-4-chmod-简单使用（重要）" class="headerlink" title="1.4 chmod 简单使用（重要）"></a>1.4 <code>chmod</code> 简单使用（重要）</h3><ul>
<li><code>chmod</code> 可以修改 <strong>用户／组</strong> 对 <strong>文件／目录</strong> 的权限</li>
<li>命令格式如下：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +/-rwx 文件名|目录名</span></pre></td></tr></table></figure>

<blockquote>
<p>提示：以上方式会一次性修改 <code>拥有者</code> / <code>组</code> 权限，有关 <code>chmod</code> 的高级用法，后续会讲</p>
</blockquote>
<h3 id="1-5-超级用户"><a href="#1-5-超级用户" class="headerlink" title="1.5 超级用户"></a>1.5 超级用户</h3><ul>
<li>Linux 系统中的 <code>root</code> 账号通常 <strong>用于系统的维护和管理</strong>，对操作系统的所有资源 <strong>具有所有访问权限</strong></li>
<li>在大多数版本的 Linux 中，都不推荐 <strong>直接使用 root 账号登录系统</strong></li>
<li>在 Linux 安装的过程中，系统会自动创建一个用户账号，而这个默认的用户就称为“标准用户”</li>
</ul>
<h4 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h4><ul>
<li><code>su</code> 是 <code>substitute user</code> 的缩写，表示 <strong>使用另一个用户的身份</strong></li>
<li><code>sudo</code> 命令用来以其他身份来执行命令，预设的身份为 <code>root</code></li>
<li>用户使用 <code>sudo</code> 时，必须先输入密码，之后有 <strong>5 分钟的有效期限</strong>，超过期限则必须重新输入密码</li>
</ul>
<blockquote>
<p>若其未经授权的用户企图使用 <code>sudo</code>，则会发出警告邮件给管理员</p>
</blockquote>
<h2 id="02-组管理-终端命令"><a href="#02-组管理-终端命令" class="headerlink" title="02. 组管理 终端命令"></a>02. <strong>组管理</strong> 终端命令</h2><blockquote>
<p>提示：<strong>创建组</strong> / <strong>删除组</strong> 的终端命令都需要通过 <code>sudo</code> 执行</p>
</blockquote>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>groupadd 组名</td>
<td>添加组</td>
</tr>
<tr>
<td>02</td>
<td>groupdel 组名</td>
<td>删除组</td>
</tr>
<tr>
<td>03</td>
<td>cat /etc/group</td>
<td>确认组信息</td>
</tr>
<tr>
<td>04</td>
<td>chgrp -R 组名 文件/目录名</td>
<td>递归修改文件/目录的所属组</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：</p>
<ul>
<li>组信息保存在 <code>/etc/group</code> 文件中</li>
<li><code>/etc</code> 目录是专门用来保存 <strong>系统配置信息</strong> 的目录</li>
</ul>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/001_%E7%BB%84%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="001_组示意图"></p>
<ul>
<li>在实际应用中，可以预先针对 <strong>组</strong> 设置好权限，然后 <strong>将不同的用户添加到对应的组中</strong>，从而<strong>不用依次为每一个用户设置权限</strong></li>
</ul>
<h4 id="演练目标"><a href="#演练目标" class="headerlink" title="演练目标"></a>演练目标</h4><ol>
<li>在 <code>python</code> 用户的桌面文件夹下创建 <code>Python学习</code> 目录</li>
<li>新建 <code>dev</code> 组</li>
<li>将 <code>Python学习</code> 目录的组修改为 <code>dev</code></li>
</ol>
<h2 id="03-用户管理-终端命令"><a href="#03-用户管理-终端命令" class="headerlink" title="03. 用户管理 终端命令"></a>03. <strong>用户管理</strong> 终端命令</h2><blockquote>
<p>提示：<strong>创建用户</strong> / <strong>删除用户</strong> / <strong>修改其他用户密码</strong> 的终端命令都需要通过 <code>sudo</code> 执行</p>
</blockquote>
<h3 id="3-1-创建用户／设置密码／删除用户"><a href="#3-1-创建用户／设置密码／删除用户" class="headerlink" title="3.1 创建用户／设置密码／删除用户"></a>3.1 创建用户／设置密码／删除用户</h3><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>useradd -m -g 组 新建用户名</td>
<td>添加新用户</td>
<td><ul><li>-m 自动建立用户家目录</li><li>-g 指定用户所在的组，否则会建立一个和同名的组</li></ul></td>
</tr>
<tr>
<td>02</td>
<td>passwd 用户名</td>
<td>设置用户密码</td>
<td>如果是普通用户，直接用 passwd 可以修改自己的账户密码</td>
</tr>
<tr>
<td>03</td>
<td>userdel -r 用户名</td>
<td>删除用户</td>
<td>-r 选项会自动删除用户家目录</td>
</tr>
<tr>
<td>04</td>
<td>cat /etc/passwd | grep 用户名</td>
<td>确认用户信息</td>
<td>新建用户后，用户信息会保存在 /etc/passwd 文件中</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：</p>
<ul>
<li>创建用户时，如果忘记添加 <code>-m</code> 选项指定新用户的家目录 —— 最简单的方法就是<strong>删除用户，重新创建</strong></li>
<li>创建用户时，默认会创建一个和<strong>用户名</strong>同名的<strong>组名</strong></li>
<li>用户信息保存在 <code>/etc/passwd</code> 文件中</li>
</ul>
</blockquote>
<h3 id="3-2-查看用户信息"><a href="#3-2-查看用户信息" class="headerlink" title="3.2 查看用户信息"></a>3.2 查看用户信息</h3><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>id [用户名]</td>
<td>查看用户 UID 和 GID 信息</td>
</tr>
<tr>
<td>02</td>
<td>who</td>
<td>查看当前所有登录的用户列表</td>
</tr>
<tr>
<td>03</td>
<td>whoami</td>
<td>查看当前登录用户的账户名</td>
</tr>
</tbody></table>
<h4 id="passwd-文件"><a href="#passwd-文件" class="headerlink" title="passwd 文件"></a>passwd 文件</h4><p><code>/etc/passwd</code> 文件存放的是用户的信息，由 6 个分号组成的 7 个信息，分别是</p>
<ol>
<li>用户名</li>
<li>密码（x，表示加密的密码）</li>
<li>UID（用户标识）</li>
<li>GID（组标识）</li>
<li>用户全名或本地帐号</li>
<li>家目录</li>
<li>登录使用的 Shell，就是登录之后，使用的终端命令，<code>ubuntu</code> 默认是 <code>dash</code></li>
</ol>
<h4 id="usermod"><a href="#usermod" class="headerlink" title="usermod"></a>usermod</h4><ul>
<li><code>usermod</code> 可以用来设置 <strong>用户</strong> 的 <strong>主组</strong> ／ <strong>附加组</strong> 和 <strong>登录 Shell</strong>，命令格式如下：</li>
<li><strong>主组</strong>：通常在新建用户时指定，在 <code>etc/passwd</code> 的第 4 列 <strong>GID 对应的组</strong></li>
<li><strong>附加组</strong>：在 <code>etc/group</code> 中最后一列表示该组的用户列表，用于指定 <strong>用户的附加权限</strong></li>
</ul>
<blockquote>
<p>提示：设置了用户的附加组之后，需要重新登录才能生效！</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改用户的主组（passwd 中的 GID）</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">usermod -g 组 用户名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 修改用户的附加组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">usermod -G 组 用户名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 修改用户登录 Shell</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">usermod -s /bin/bash 用户名</span></pre></td></tr></table></figure>

<blockquote>
<p>注意：默认使用 <code>useradd</code> 添加的用户是没有权限使用 <code>sudo</code> 以 <code>root</code> 身份执行命令的，可以使用以下命令，将用户添加到 <code>sudo</code> 附加组中</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">usermod -G sudo 用户名</span></pre></td></tr></table></figure>

<h4 id="which（重要）"><a href="#which（重要）" class="headerlink" title="which（重要）"></a>which（重要）</h4><blockquote>
<p>提示</p>
<ul>
<li><code>/etc/passwd</code> 是用于保存用户信息的文件</li>
<li><code>/usr/bin/passwd</code> 是用于修改用户密码的程序</li>
</ul>
</blockquote>
<ul>
<li><code>which</code> 命令可以查看执行命令所在位置，例如：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> ls</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 输出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># /bin/ls</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> useradd</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 输出</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># /usr/sbin/useradd</span></span></pre></td></tr></table></figure>

<h5 id="bin-和-sbin"><a href="#bin-和-sbin" class="headerlink" title="bin 和 sbin"></a><code>bin</code> 和 <code>sbin</code></h5><ul>
<li>在 <code>Linux</code> 中，绝大多数可执行文件都是保存在 <code>/bin</code>、<code>/sbin</code>、<code>/usr/bin</code>、<code>/usr/sbin</code></li>
<li><code>/bin</code>（<code>binary</code>）是二进制执行文件目录，主要用于具体应用</li>
<li><code>/sbin</code>（<code>system binary</code>）是系统管理员专用的二进制代码存放目录，主要用于系统管理</li>
<li><code>/usr/bin</code>（<code>user commands for applications</code>）后期安装的一些软件</li>
<li><code>/usr/sbin</code>（<code>super user commands for applications</code>）超级用户的一些管理程序</li>
</ul>
<blockquote>
<p>提示：</p>
<ul>
<li><code>cd</code> 这个终端命令是内置在系统内核中的，没有独立的文件，因此用 <code>which</code> 无法找到 <code>cd</code> 命令的位置</li>
</ul>
</blockquote>
<h3 id="3-3-切换用户"><a href="#3-3-切换用户" class="headerlink" title="3.3 切换用户"></a>3.3 切换用户</h3><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>su - 用户名</td>
<td>切换用户，并且切换目录</td>
<td>- 可以切换到用户家目录，否则保持位置不变</td>
</tr>
<tr>
<td>02</td>
<td>exit</td>
<td>退出当前登录账户</td>
<td></td>
</tr>
</tbody></table>
<ul>
<li><code>su</code> 不接用户名，可以切换到 <code>root</code>，但是不推荐使用，因为不安全</li>
<li><code>exit</code> 示意图如下：</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/003_su%E5%92%8Cexit%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="003_su和exit示意图"></p>
<h2 id="04-修改文件权限"><a href="#04-修改文件权限" class="headerlink" title="04. 修改文件权限"></a>04. 修改文件权限</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>chown</td>
<td>修改拥有者</td>
</tr>
<tr>
<td>02</td>
<td>chgrp</td>
<td>修改组</td>
</tr>
<tr>
<td>03</td>
<td>chmod</td>
<td>修改权限</td>
</tr>
</tbody></table>
<ul>
<li>命令格式如下：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改文件|目录的拥有者</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">chown 用户名 文件名|目录名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 递归修改文件|目录的组</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">chgrp -R 组名 文件名|目录名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 递归修改文件权限</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">chmod -R 755 文件名|目录名</span></pre></td></tr></table></figure>

<ul>
<li><code>chmod</code> 在设置权限时，可以简单地使用三个数字分别对应 <strong>拥有者</strong> ／ <strong>组</strong> 和 <strong>其他</strong> 用户的权限</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 直接修改文件|目录的 读|写|执行 权限，但是不能精确到 拥有者|组|其他</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">chmod +/-rwx 文件名|目录名</span></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/004_%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="004_文件权限示意图"></p>
<ul>
<li>常见数字组合有（<code>u</code>表示用户／<code>g</code>表示组／<code>o</code>表示其他）：<ul>
<li><code>777</code> ===&gt; <code>u=rwx,g=rwx,o=rwx</code> </li>
<li><code>755</code> ===&gt; <code>u=rwx,g=rx,o=rx</code></li>
<li><code>644</code> ===&gt; <code>u=rw,g=r,o=r</code></li>
</ul>
</li>
</ul>
<h4 id="chmod-演练目标"><a href="#chmod-演练目标" class="headerlink" title="chmod 演练目标"></a><code>chmod</code> 演练目标</h4><ol>
<li>将 <code>01.py</code> 的权限修改为 <code>u=rwx,g=rx,o=r</code> </li>
<li>将 <code>123.txt</code> 的权限修改为 <code>u=rw,g=r,o=-</code> </li>
<li>将 <code>test</code> 目录以及目录下的 <strong>所有</strong> 文件权限修改为 <code>u=rwx,g=rwx,o=rx</code> </li>
</ol>
<h1 id="系统信息相关命令"><a href="#系统信息相关命令" class="headerlink" title="系统信息相关命令"></a>系统信息相关命令</h1><ul>
<li>本节内容主要是为了方便通过远程终端维护服务器时，查看服务器上当前 <strong>系统日期和时间</strong> ／ <strong>磁盘空间占用情况</strong> ／ <strong>程序执行情况</strong></li>
<li>本小结学习的终端命令基本都是查询命令，通过这些命令对系统资源的使用情况有个了解</li>
</ul>
<h2 id="目标-6"><a href="#目标-6" class="headerlink" title="目标"></a>目标</h2><ul>
<li>时间和日期<ul>
<li><code>date</code></li>
<li><code>cal</code></li>
</ul>
</li>
<li>磁盘和目录空间<ul>
<li><code>df</code></li>
<li><code>du</code></li>
</ul>
</li>
<li>进程信息<ul>
<li><code>ps</code></li>
<li><code>top</code></li>
<li><code>kill</code></li>
</ul>
</li>
</ul>
<h2 id="01-时间和日期"><a href="#01-时间和日期" class="headerlink" title="01. 时间和日期"></a>01. 时间和日期</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>date</td>
<td>查看系统时间</td>
</tr>
<tr>
<td>02</td>
<td>cal</td>
<td><code>calendar</code> 查看日历，<code>-y</code> 选项可以查看一年的日历</td>
</tr>
</tbody></table>
<h2 id="02-磁盘信息"><a href="#02-磁盘信息" class="headerlink" title="02. 磁盘信息"></a>02. 磁盘信息</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>df -h</td>
<td><code>disk free</code> 显示磁盘剩余空间</td>
</tr>
<tr>
<td>02</td>
<td>du -h [目录名]</td>
<td><code>disk usage</code> 显示目录下的文件大小</td>
</tr>
</tbody></table>
<ul>
<li>选项说明</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-h</td>
<td>以人性化的方式显示文件大小</td>
</tr>
</tbody></table>
<h2 id="03-进程信息"><a href="#03-进程信息" class="headerlink" title="03. 进程信息"></a>03. 进程信息</h2><ul>
<li>所谓 <strong>进程</strong>，通俗地说就是 <strong>当前正在执行的一个程序</strong></li>
</ul>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>ps aux</td>
<td><code>process status</code> 查看进程的详细状况</td>
</tr>
<tr>
<td>02</td>
<td>top</td>
<td>动态显示运行中的进程并且排序</td>
</tr>
<tr>
<td>03</td>
<td>kill [-9] 进程代号</td>
<td>终止指定代号的进程，<code>-9</code> 表示强行终止</td>
</tr>
</tbody></table>
<blockquote>
<p><code>ps</code> 默认只会显示当前用户通过终端启动的应用程序</p>
</blockquote>
<ul>
<li><code>ps</code> 选项说明</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>显示终端上的所有进程，包括其他用户的进程</td>
</tr>
<tr>
<td>u</td>
<td>显示进程的详细状态</td>
</tr>
<tr>
<td>x</td>
<td>显示没有控制终端的进程</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：使用 <code>kill</code> 命令时，最好只终止由当前用户开启的进程，而不要终止 <code>root</code> 身份开启的进程，否则可能导致系统崩溃</p>
</blockquote>
<blockquote>
<ul>
<li>要退出 <code>top</code> 可以直接输入 <code>q</code></li>
</ul>
</blockquote>
<h1 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h1><h2 id="目标-7"><a href="#目标-7" class="headerlink" title="目标"></a>目标</h2><ul>
<li>查找文件<ul>
<li><code>find</code></li>
</ul>
</li>
<li>软链接<ul>
<li><code>ln</code></li>
</ul>
</li>
<li>打包和压缩<ul>
<li><code>tar</code></li>
</ul>
</li>
<li>软件安装<ul>
<li><code>apt-get</code></li>
</ul>
</li>
</ul>
<h2 id="01-查找文件"><a href="#01-查找文件" class="headerlink" title="01. 查找文件"></a>01. 查找文件</h2><ul>
<li><code>find</code> 命令功能非常强大，通常用来在 <strong>特定的目录下</strong> <strong>搜索</strong> 符合条件的文件</li>
</ul>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>find [路径] -name “*.py”</td>
<td>查找指定路径下扩展名是 <code>.py</code> 的文件，包括子目录</td>
</tr>
</tbody></table>
<ul>
<li>如果省略路径，表示在当前文件夹下查找</li>
<li>之前学习的通配符，在使用 <code>find</code> 命令时同时可用</li>
<li>有关 <code>find</code> 的高级使用，在就业班会讲</li>
</ul>
<h3 id="演练目标-1"><a href="#演练目标-1" class="headerlink" title="演练目标"></a>演练目标</h3><ul>
<li><ol>
<li>搜索桌面目录下，文件名包含 <code>1</code> 的文件</li>
</ol>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find -name <span class="string">"*1*"</span></span></pre></td></tr></table></figure>

<ul>
<li><ol start="2">
<li>搜索桌面目录下，所有以 <code>.txt</code> 为扩展名的文件</li>
</ol>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find -name <span class="string">"*.txt"</span></span></pre></td></tr></table></figure>

<ul>
<li><ol start="3">
<li>搜索桌面目录下，以数字 <code>1</code> 开头的文件</li>
</ol>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find -name <span class="string">"1*"</span></span></pre></td></tr></table></figure>

<h2 id="02-软链接"><a href="#02-软链接" class="headerlink" title="02. 软链接"></a>02. 软链接</h2><table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>ln -s 被链接的源文件 链接文件</td>
<td>建立文件的软链接，用通俗的方式讲<strong>类似于</strong> Windows 下的<strong>快捷方式</strong></td>
</tr>
</tbody></table>
<ul>
<li><p>注意：</p>
</li>
<li><ol>
<li><p>没有 <code>-s</code> 选项建立的是一个 <strong>硬链接文件</strong> </p>
<ul>
<li>两个文件占用相同大小的硬盘空间，<strong>工作中几乎不会建立文件的硬链接</strong></li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li><strong>源文件要使用绝对路径</strong>，不能使用相对路径，这样可以方便移动链接文件后，仍然能够正常使用</li>
</ol>
</li>
</ul>
<h3 id="演练目标-2"><a href="#演练目标-2" class="headerlink" title="演练目标"></a>演练目标</h3><ul>
<li><ol>
<li>将桌面目录下的 <code>01.py</code> <strong>移动</strong>到 <code>demo/b/c</code> 目录下</li>
</ol>
</li>
<li><ol start="2">
<li><p>在桌面目录下新建 <code>01.py</code> 的 <strong>软链接</strong> <code>FirstPython</code></p>
<ul>
<li>分别使用 <strong>相对路径</strong> 和 <strong>绝对路径</strong> 建立 <code>FirstPython</code> 的软链接</li>
</ul>
</li>
</ol>
</li>
<li><ol start="3">
<li>将 <code>FirstPython</code> <strong>移动</strong>到 <code>demo</code> 目录下，对比使用 <strong>相对路径</strong> 和 <strong>绝对路径</strong> 的区别</li>
</ol>
</li>
</ul>
<h3 id="硬链接简介（知道）"><a href="#硬链接简介（知道）" class="headerlink" title="硬链接简介（知道）"></a>硬链接简介（知道）</h3><ul>
<li>在使用 <code>ln</code> 创建链接时，如果没有 <code>-s</code> 选项，会创建一个 <strong>硬链接</strong>，而不是软链接</li>
</ul>
<h4 id="硬链接演练"><a href="#硬链接演练" class="headerlink" title="硬链接演练"></a>硬链接演练</h4><ul>
<li><ol>
<li>在 <code>~/Desktop/demo</code> 目录下建立 <code>~/Desktop/demo/b/c/01.py</code> 的硬链接 <code>01_hard</code></li>
</ol>
</li>
<li><ol start="2">
<li>使用 <code>ls -l</code> 查看文件的<strong>硬链接数</strong>（硬链接——有多少种方式可以访问文件或者目录）</li>
</ol>
</li>
<li><ol start="3">
<li>删除 <code>~/Desktop/demo/b/c/01.py</code>，并且使用 <code>tree</code> 来确认 <code>demo</code> 目录下的三个链接文件</li>
</ol>
</li>
</ul>
<h4 id="文件软硬链接的示意图"><a href="#文件软硬链接的示意图" class="headerlink" title="文件软硬链接的示意图"></a>文件软硬链接的示意图</h4><p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/001_%E6%96%87%E4%BB%B6%E8%BD%AF%E7%A1%AC%E9%93%BE%E6%8E%A5%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="001_文件软硬链接示意图"></p>
<blockquote>
<p>在 Linux 中，<strong>文件名</strong> 和 <strong>文件的数据</strong> 是分开存储的</p>
</blockquote>
<ul>
<li>提示：<ul>
<li>在 Linux 中，只有文件的 <code>硬链接数 == 0</code> 才会被删除</li>
<li>使用 <code>ls -l</code> 可以查看一个文件的硬链接的数量</li>
<li>在日常工作中，几乎不会建立文件的硬链接，知道即可</li>
</ul>
</li>
</ul>
<h2 id="03-打包压缩"><a href="#03-打包压缩" class="headerlink" title="03. 打包压缩"></a>03. 打包压缩</h2><ul>
<li><strong>打包压缩</strong> 是日常工作中备份文件的一种方式</li>
<li>在不同操作系统中，常用的打包压缩方式是不同的<ul>
<li><code>Windows</code> 常用 <code>rar</code></li>
<li><code>Mac</code> 常用 <code>zip</code></li>
<li><code>Linux</code> 常用 <code>tar.gz</code></li>
</ul>
</li>
</ul>
<h3 id="3-1-打包-／-解包"><a href="#3-1-打包-／-解包" class="headerlink" title="3.1 打包 ／ 解包"></a>3.1 打包 ／ 解包</h3><ul>
<li><code>tar</code> 是 Linux 中最常用的 <strong>备份</strong>工具，此命令可以 <strong>把一系列文件</strong> 打包到 <strong>一个大文件中</strong>，也可以把一个 <strong>打包的大文件恢复成一系列文件</strong></li>
<li><code>tar</code> 的命令格式如下：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 打包文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -cvf 打包文件.tar 被打包的文件／路径...</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 解包文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -xvf 打包文件.tar</span></pre></td></tr></table></figure>

<ul>
<li><code>tar</code> 选项说明</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>c</td>
<td>生成档案文件，创建打包文件</td>
</tr>
<tr>
<td>x</td>
<td>解开档案文件</td>
</tr>
<tr>
<td>v</td>
<td>列出归档解档的详细过程，显示进度</td>
</tr>
<tr>
<td>f</td>
<td>指定档案文件名称，f 后面一定是 .tar 文件，所以必须放选项最后</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：<code>f</code> 选项必须放在最后，其他选项顺序可以随意</p>
</blockquote>
<h4 id="打包解包演练"><a href="#打包解包演练" class="headerlink" title="打包解包演练"></a>打包解包演练</h4><ol>
<li>删除桌面下的所有内容</li>
<li>在桌面下新建三个空白文件 <code>01.py</code>、<code>02.py</code>、<code>03.py</code></li>
<li>将这三个文件打一个 <code>py.tar</code> 的包</li>
<li>新建 <code>tar</code> 目录，并且将 <code>py.tar</code> 移动到 <code>tar</code> 目录下</li>
<li>解包 <code>py.tar</code></li>
</ol>
<h3 id="3-2-压缩／解压缩"><a href="#3-2-压缩／解压缩" class="headerlink" title="3.2 压缩／解压缩"></a>3.2 压缩／解压缩</h3><h4 id="1-gzip"><a href="#1-gzip" class="headerlink" title="1) gzip"></a>1) <code>gzip</code></h4><ul>
<li><code>tar</code> 与 <code>gzip</code> 命令结合可以使用实现文件 <strong>打包和压缩</strong><ul>
<li><code>tar</code> 只负责打包文件，但不压缩</li>
<li>用 <code>gzip</code> 压缩 <code>tar</code> 打包后的文件，其扩展名一般用 <code>xxx.tar.gz</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>在 <code>Linux</code> 中，最常见的压缩文件格式就是 <code>xxx.tar.gz</code></p>
</blockquote>
<ul>
<li><p>在 <code>tar</code> 命令中有一个选项 <strong>-z</strong> 可以调用 <code>gzip</code>，从而可以方便的实现压缩和解压缩的功能</p>
</li>
<li><p>命令格式如下：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 压缩文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -zcvf 打包文件.tar.gz 被压缩的文件／路径...</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 解压缩文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -zxvf 打包文件.tar.gz</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 解压缩到指定路径</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -zxvf 打包文件.tar.gz -C 目标路径</span></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-C</td>
<td>解压缩到指定目录，注意：要解压缩的目录必须存在</td>
</tr>
</tbody></table>
<h4 id="2-bzip2-two"><a href="#2-bzip2-two" class="headerlink" title="2) bzip2(two)"></a>2) <code>bzip2(two)</code></h4><ul>
<li><p><code>tar</code> 与 <code>bzip2</code> 命令结合可以使用实现文件 <strong>打包和压缩</strong>（用法和 <code>gzip</code> 一样）</p>
<ul>
<li><code>tar</code> 只负责打包文件，但不压缩，</li>
<li>用 <code>bzip2</code> 压缩 <code>tar</code> 打包后的文件，其扩展名一般用 <code>xxx.tar.bz2</code></li>
</ul>
</li>
<li><p>在 <code>tar</code> 命令中有一个选项 <strong>-j</strong> 可以调用 <code>bzip2</code>，从而可以方便的实现压缩和解压缩的功能</p>
</li>
<li><p>命令格式如下：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 压缩文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -jcvf 打包文件.tar.bz2 被压缩的文件／路径...</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 解压缩文件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">tar -jxvf 打包文件.tar.bz2</span></pre></td></tr></table></figure>

<h2 id="04-软件安装"><a href="#04-软件安装" class="headerlink" title="04. 软件安装"></a>04. 软件安装</h2><h2 id="4-1-通过-apt-安装／卸载软件"><a href="#4-1-通过-apt-安装／卸载软件" class="headerlink" title="4.1 通过 apt 安装／卸载软件"></a>4.1 通过 apt 安装／卸载软件</h2><ul>
<li>apt 是 <code>Advanced Packaging Tool</code>，是 Linux 下的一款安装包管理工具</li>
<li>可以在终端中方便的 <strong>安装</strong>／<strong>卸载</strong>／<strong>更新软件包</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. 安装软件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ sudo apt install 软件包</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 2. 卸载软件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ sudo apt remove 软件名</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 3. 更新已安装的包</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ sudo apt upgrade</span></pre></td></tr></table></figure>

<h3 id="安装演练"><a href="#安装演练" class="headerlink" title="安装演练"></a>安装演练</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 一个小火车提示</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ sudo apt install sl</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="comment"># 一个比较漂亮的查看当前进程排名的软件</span></span></pre></td></tr><tr><td class="code"><pre><span class="line">$ sudo apt install htop</span></pre></td></tr></table></figure>

<h2 id="4-2-配置软件源"><a href="#4-2-配置软件源" class="headerlink" title="4.2 配置软件源"></a>4.2 配置软件源</h2><ul>
<li>如果希望在 <code>ubuntu</code> 中安装软件，<strong>更加快速</strong>，可以通过设置<strong>镜像源</strong>，选择一个访问网速更快的服务器，来提供软件下载／安装服务</li>
<li>提示：更换服务器之后，需要一个相对比较长时间的更新过程，需要耐心等待。更新完成后，再安装软件都会从新设置的服务器下载软件了</li>
</ul>
<blockquote>
<p>所谓镜像源，就是<strong>所有服务器的内容是相同的（镜像）</strong>，但是根据所在位置不同，国内服务器通常速度会更快一些！</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/003_%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="003_镜像服务器示意图"></p>
<p><img src="https://raw.githubusercontent.com/zhangbowen-github/my-gallery/main/img/001_ubuntu%E8%AE%BE%E7%BD%AE%E8%BD%AF%E4%BB%B6%E6%BA%90.png" alt="001_ubuntu设置软件源"></p>
<h1 id="Linux-主要目录速查表"><a href="#Linux-主要目录速查表" class="headerlink" title="Linux 主要目录速查表"></a><code>Linux</code> 主要目录速查表</h1><ul>
<li>/：根目录，<strong>一般根目录下只存放目录</strong>，在 linux 下有且只有一个根目录，所有的东西都是从这里开始<ul>
<li>当在终端里输入 <code>/home</code>，其实是在告诉电脑，先从 <code>/</code>（根目录）开始，再进入到 <code>home</code> 目录</li>
</ul>
</li>
<li>/bin、/usr/bin：可执行二进制文件的目录，如常用的命令 ls、tar、mv、cat 等</li>
<li>/boot：放置 linux 系统启动时用到的一些文件，如 linux 的内核文件：<code>/boot/vmlinuz</code>，系统引导管理器：<code>/boot/grub</code></li>
<li>/dev：存放linux系统下的设备文件，访问该目录下某个文件，相当于访问某个设备，常用的是挂载光驱<code>mount /dev/cdrom /mnt</code></li>
<li>/etc：系统配置文件存放的目录，不建议在此目录下存放可执行文件，重要的配置文件有 <ul>
<li>/etc/inittab</li>
<li>/etc/fstab</li>
<li>/etc/init.d</li>
<li>/etc/X11</li>
<li>/etc/sysconfig</li>
<li>/etc/xinetd.d</li>
</ul>
</li>
<li>/home：系统默认的用户家目录，新增用户账号时，用户的家目录都存放在此目录下<ul>
<li><code>~</code> 表示当前用户的家目录</li>
<li><code>~edu</code> 表示用户 <code>edu</code> 的家目录</li>
</ul>
</li>
<li>/lib、/usr/lib、/usr/local/lib：系统使用的函数库的目录，程序在执行过程中，需要调用一些额外的参数时需要函数库的协助</li>
<li>/lost+fount：系统异常产生错误时，会将一些遗失的片段放置于此目录下</li>
<li>/mnt: /media：光盘默认挂载点，通常光盘挂载于 /mnt/cdrom 下，也不一定，可以选择任意位置进行挂载</li>
<li>/opt：给主机额外安装软件所摆放的目录</li>
<li>/proc：此目录的数据都在内存中，如系统核心，外部设备，网络状态，由于数据都存放于内存中，所以不占用磁盘空间，比较重要的文件有：/proc/cpuinfo、/proc/interrupts、/proc/dma、/proc/ioports、/proc/net/* 等</li>
<li>/root：系统管理员root的家目录</li>
<li>/sbin、/usr/sbin、/usr/local/sbin：放置系统管理员使用的可执行命令，如 fdisk、shutdown、mount 等。与 /bin 不同的是，这几个目录是给系统管理员 root 使用的命令，一般用户只能”查看”而不能设置和使用</li>
<li>/tmp：一般用户或正在执行的程序临时存放文件的目录，任何人都可以访问，重要数据不可放置在此目录下</li>
<li>/srv：服务启动之后需要访问的数据目录，如 www 服务需要访问的网页数据存放在 /srv/www 内</li>
<li>/usr：应用程序存放目录<ul>
<li>/usr/bin：存放应用程序</li>
<li>/usr/share：存放共享数据</li>
<li>/usr/lib：存放不能直接运行的，却是许多程序运行所必需的一些函数库文件</li>
<li>/usr/local：存放软件升级包</li>
<li>/usr/share/doc：系统说明文件存放目录</li>
<li>/usr/share/man：程序说明文件存放目录</li>
</ul>
</li>
<li>/var：放置系统执行过程中经常变化的文件<ul>
<li>/var/log：随时更改的日志文件 </li>
<li>/var/spool/mail：邮件存放的目录</li>
<li>/var/run：程序或服务启动后，其 PID 存放在该目录下</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>ubuntu</tag>
      </tags>
  </entry>
</search>
